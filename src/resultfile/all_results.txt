 
 
 
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX___________________CROSSFORMER_____________________XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
$ bash ./scripts/DiscoveryPassage_and_others_Script/crossformer.sh
MODEL IMPLEMENTED= Crossformer
PREDICTION LENGTH= 720
SEQUENCE LENGTH= 720
LEARNING RATE ADJUSTMENT= type1
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=8, checkpoints='./checkpoints/', d_ff=512, d_layers=1, d_model=256, data='custom', data_path='DiscoveryPassage_and_others_merged.csv', dec_in=8, des='Exp', devices='0,1,2,3', distil=True, dropout=0.1, e_layers=2, embed='timeF', enc_in=8, factor=3, features='M', freq='h', gpu=0, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='Crossformer', model_id='DiscoveryPassage_and_others_720_360_96cf', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=720, root_path='./dataset/', seasonal_patterns='Monthly', seq_len=720, target='Chlorophyll (ug/l)', task_name='long_term_forecast', top_k=5, train_epochs=20, use_amp=False, use_gpu=False, use_multi_gpu=False, w_lin=0.01)
Use CPU
>>>>>>>start training : long_term_forecast_DiscoveryPassage_and_others_720_360_96cf_Crossformer_custom_ftM_sl720_ll48_pl720_dm256_nh8_el2_dl1_df512_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
Chlorophyll (ug/l) Chlorophyll (ug/l)
train 32291
Chlorophyll (ug/l) Chlorophyll (ug/l)
val 4101
Chlorophyll (ug/l) Chlorophyll (ug/l)
test 8918
Parameters: 8.372516
	iters: 100, epoch: 1 | loss: 0.6787583
	speed: 9.3097s/iter; left time: 186947.4937s
	iters: 200, epoch: 1 | loss: 0.4585779
	speed: 9.6393s/iter; left time: 192603.2362s
	iters: 300, epoch: 1 | loss: 0.5786691
	speed: 9.5286s/iter; left time: 189438.0433s
	iters: 400, epoch: 1 | loss: 0.3076525
	speed: 9.5355s/iter; left time: 188621.4670s
	iters: 500, epoch: 1 | loss: 0.4626164
	speed: 9.5435s/iter; left time: 187824.9634s
	iters: 600, epoch: 1 | loss: 0.4889602
	speed: 9.5814s/iter; left time: 187612.7889s
	iters: 700, epoch: 1 | loss: 0.3002132
	speed: 9.6539s/iter; left time: 188067.6136s
	iters: 800, epoch: 1 | loss: 0.3081801
	speed: 9.5477s/iter; left time: 185043.6350s
	iters: 900, epoch: 1 | loss: 0.3283130
	speed: 9.5759s/iter; left time: 184633.4205s
	iters: 1000, epoch: 1 | loss: 0.2806930
	speed: 9.6905s/iter; left time: 185873.5025s
Epoch: 1 cost time: 9655.679272413254
Epoch: 1, Steps: 1009 | Train Loss: 0.4516606 Vali Loss: 0.5660583 Test Loss: 3.5268559
Validation loss decreased (inf --> 0.566058).  Saving model ...
Updating learning rate to 0.0001
Parameters: 8.372516
	iters: 100, epoch: 2 | loss: 0.4847551
	speed: 24.3363s/iter; left time: 464142.1253s
	iters: 200, epoch: 2 | loss: 0.2511065
	speed: 9.6813s/iter; left time: 183673.9094s
	iters: 300, epoch: 2 | loss: 0.4288868
	speed: 9.5953s/iter; left time: 181082.4894s
	iters: 400, epoch: 2 | loss: 0.2735941
	speed: 9.5251s/iter; left time: 178806.0845s
	iters: 500, epoch: 2 | loss: 0.3874736
	speed: 9.5546s/iter; left time: 178402.9152s
	iters: 600, epoch: 2 | loss: 0.3171220
	speed: 9.5555s/iter; left time: 177464.9638s
	iters: 700, epoch: 2 | loss: 0.3370351
	speed: 9.5179s/iter; left time: 175814.4010s
	iters: 800, epoch: 2 | loss: 0.3388401
	speed: 9.5840s/iter; left time: 176076.8454s
	iters: 900, epoch: 2 | loss: 0.3953746
	speed: 13.4801s/iter; left time: 246307.5103s
	iters: 1000, epoch: 2 | loss: 0.2303867
	speed: 14.6211s/iter; left time: 265694.9316s
Epoch: 2 cost time: 10656.000662565231
Epoch: 2, Steps: 1009 | Train Loss: 0.3220555 Vali Loss: 0.6287928 Test Loss: 3.8494949
EarlyStopping counter: 1 out of 5
Updating learning rate to 5e-05
Parameters: 8.372516
	iters: 100, epoch: 3 | loss: 0.2163164
	speed: 38.3589s/iter; left time: 692876.8894s
	iters: 200, epoch: 3 | loss: 0.2786400
	speed: 14.6416s/iter; left time: 263007.1806s
	iters: 300, epoch: 3 | loss: 0.2569913
	speed: 14.6481s/iter; left time: 261658.3297s
	iters: 400, epoch: 3 | loss: 0.3175874
	speed: 14.6099s/iter; left time: 259515.2206s
	iters: 500, epoch: 3 | loss: 0.2394519
	speed: 13.0454s/iter; left time: 230421.5691s
	iters: 600, epoch: 3 | loss: 0.2468699
	speed: 12.9525s/iter; left time: 227484.4352s
	iters: 700, epoch: 3 | loss: 0.2342420
	speed: 12.9041s/iter; left time: 225344.1842s
	iters: 800, epoch: 3 | loss: 0.3095576
	speed: 14.2096s/iter; left time: 246721.9048s
	iters: 900, epoch: 3 | loss: 0.3932275
	speed: 14.6376s/iter; left time: 252688.9716s
	iters: 1000, epoch: 3 | loss: 0.3215643
	speed: 14.6132s/iter; left time: 250806.7597s
Epoch: 3 cost time: 14227.251467704773
Epoch: 3, Steps: 1009 | Train Loss: 0.2898558 Vali Loss: 0.6332874 Test Loss: 3.7230723
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.5e-05
Parameters: 8.372516
	iters: 100, epoch: 4 | loss: 0.2634176
	speed: 38.1679s/iter; left time: 650915.9995s
	iters: 200, epoch: 4 | loss: 0.1979804
	speed: 14.6424s/iter; left time: 248247.9676s
	iters: 300, epoch: 4 | loss: 0.1831021
	speed: 14.5971s/iter; left time: 246019.1685s
	iters: 400, epoch: 4 | loss: 0.3499920
	speed: 13.0667s/iter; left time: 218920.0433s
	iters: 500, epoch: 4 | loss: 0.2637316
	speed: 12.9645s/iter; left time: 215910.2720s
	iters: 600, epoch: 4 | loss: 0.3309807
	speed: 12.9334s/iter; left time: 214100.0815s
	iters: 700, epoch: 4 | loss: 0.3773361
	speed: 14.2262s/iter; left time: 234077.4081s
	iters: 800, epoch: 4 | loss: 0.3407942
	speed: 14.6277s/iter; left time: 239221.7177s
	iters: 900, epoch: 4 | loss: 0.3776765
	speed: 14.6335s/iter; left time: 237852.8680s
	iters: 1000, epoch: 4 | loss: 0.4395520
	speed: 14.6522s/iter; left time: 236691.8494s
Epoch: 4 cost time: 14234.938554286957
Epoch: 4, Steps: 1009 | Train Loss: 0.2768112 Vali Loss: 0.6148734 Test Loss: 3.7876031
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.25e-05
Parameters: 8.372516
	iters: 100, epoch: 5 | loss: 0.1828838
	speed: 38.2567s/iter; left time: 613828.0358s
	iters: 200, epoch: 5 | loss: 0.1788273
	speed: 14.6280s/iter; left time: 233242.8129s
	iters: 300, epoch: 5 | loss: 0.2577756
	speed: 13.1056s/iter; left time: 207658.8344s
	iters: 400, epoch: 5 | loss: 0.2906211
	speed: 12.9500s/iter; left time: 203898.4839s
	iters: 500, epoch: 5 | loss: 0.3466410
	speed: 12.9471s/iter; left time: 202557.7198s
	iters: 600, epoch: 5 | loss: 0.2337566
	speed: 14.2373s/iter; left time: 221318.5396s
	iters: 700, epoch: 5 | loss: 0.3001833
	speed: 14.6351s/iter; left time: 226039.5074s
	iters: 800, epoch: 5 | loss: 0.3150254
	speed: 14.6299s/iter; left time: 224495.3057s
	iters: 900, epoch: 5 | loss: 0.2226424
	speed: 14.6015s/iter; left time: 222600.0740s
	iters: 1000, epoch: 5 | loss: 0.3669318
	speed: 14.6527s/iter; left time: 221915.0707s
Epoch: 5 cost time: 14240.33478808403
Epoch: 5, Steps: 1009 | Train Loss: 0.2704823 Vali Loss: 0.6156834 Test Loss: 3.7345345
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.25e-06
Parameters: 8.372516
	iters: 100, epoch: 6 | loss: 0.1713565
	speed: 38.2408s/iter; left time: 574988.2028s
	iters: 200, epoch: 6 | loss: 0.2776701
	speed: 13.1174s/iter; left time: 195922.0468s
	iters: 300, epoch: 6 | loss: 0.2386521
	speed: 12.9982s/iter; left time: 192841.7528s
	iters: 400, epoch: 6 | loss: 0.2084867
	speed: 12.9663s/iter; left time: 191071.4021s
	iters: 500, epoch: 6 | loss: 0.3048370
	speed: 14.1703s/iter; left time: 207397.1997s
	iters: 600, epoch: 6 | loss: 0.4213820
	speed: 14.6717s/iter; left time: 213268.0491s
	iters: 700, epoch: 6 | loss: 0.2372216
	speed: 14.6740s/iter; left time: 211834.2756s
	iters: 800, epoch: 6 | loss: 0.2712980
	speed: 14.6395s/iter; left time: 209872.2729s
	iters: 900, epoch: 6 | loss: 0.2293347
	speed: 14.7039s/iter; left time: 209324.3626s
	iters: 1000, epoch: 6 | loss: 0.3029344
	speed: 14.9975s/iter; left time: 212005.2325s
Epoch: 6 cost time: 14304.9781396389
Epoch: 6, Steps: 1009 | Train Loss: 0.2669585 Vali Loss: 0.6129010 Test Loss: 3.7525275
EarlyStopping counter: 5 out of 5
Updating learning rate to 3.125e-06
Early stopping
>>>>>>>testing : long_term_forecast_DiscoveryPassage_and_others_720_360_96cf_Crossformer_custom_ftM_sl720_ll48_pl720_dm256_nh8_el2_dl1_df512_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Chlorophyll (ug/l) Chlorophyll (ug/l)
test 8918
test shape: (8918, 1, 720, 8) (8918, 1, 720, 8)
test shape: (8918, 720, 8) (8918, 720, 8)
mse:3.5268545150756836, mae:0.972080647945404




bash ./scripts/DiscoveryPassage_and_others_Script/crossformer.sh
/usr/local/bin/python3
MODEL IMPLEMENTED= Crossformer
PREDICTION LENGTH= 360
SEQUENCE LENGTH= 360
LEARNING RATE ADJUSTMENT= type1
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=8, checkpoints='./checkpoints/', d_ff=512, d_layers=1, d_model=256, data='custom', data_path='DiscoveryPassage_and_others_merged.csv', dec_in=8, des='Exp', devices='0,1,2,3', distil=True, dropout=0.1, e_layers=2, embed='timeF', enc_in=8, factor=3, features='M', freq='h', gpu=0, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='Crossformer', model_id='DiscoveryPassage_and_others_720_360_96cf', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=360, root_path='./dataset/', seasonal_patterns='Monthly', seq_len=360, target='Chlorophyll (ug/l)', task_name='long_term_forecast', top_k=5, train_epochs=20, use_amp=False, use_gpu=False, use_multi_gpu=False, w_lin=0.01)
Use CPU
>>>>>>>start training : long_term_forecast_DiscoveryPassage_and_others_720_360_96cf_Crossformer_custom_ftM_sl360_ll48_pl360_dm256_nh8_el2_dl1_df512_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
Chlorophyll (ug/l) Chlorophyll (ug/l)
train 33011
Chlorophyll (ug/l) Chlorophyll (ug/l)
val 4461
Chlorophyll (ug/l) Chlorophyll (ug/l)
test 9278
Parameters: 8.145956
	iters: 100, epoch: 1 | loss: 0.3965438
	speed: 5.1964s/iter; left time: 106636.2060s
	iters: 200, epoch: 1 | loss: 0.6689873
	speed: 5.3132s/iter; left time: 108501.0706s
	iters: 300, epoch: 1 | loss: 0.3904938
	speed: 8.9625s/iter; left time: 182127.2393s
	iters: 400, epoch: 1 | loss: 0.2745747
	speed: 9.4011s/iter; left time: 190100.0551s
	iters: 500, epoch: 1 | loss: 0.2415658
	speed: 9.2507s/iter; left time: 186132.6637s
	iters: 600, epoch: 1 | loss: 0.3935137
	speed: 9.2823s/iter; left time: 185840.3420s
	iters: 700, epoch: 1 | loss: 0.4402549
	speed: 9.2948s/iter; left time: 185161.3020s
	iters: 800, epoch: 1 | loss: 0.2489202
	speed: 9.3748s/iter; left time: 185818.4755s
	iters: 900, epoch: 1 | loss: 0.3252200
	speed: 9.2049s/iter; left time: 181529.9606s
	iters: 1000, epoch: 1 | loss: 0.1738205
	speed: 9.3644s/iter; left time: 183739.4548s
Epoch: 1 cost time: 8761.20283818245
Epoch: 1, Steps: 1031 | Train Loss: 0.4155519 Vali Loss: 0.4778422 Test Loss: 3.3135962
Validation loss decreased (inf --> 0.477842).  Saving model ...
Updating learning rate to 0.0001
Parameters: 8.145956
	iters: 100, epoch: 2 | loss: 0.3294293
	speed: 39.2430s/iter; left time: 764846.7998s
	iters: 200, epoch: 2 | loss: 0.3630275
	speed: 9.2235s/iter; left time: 178842.9617s
	iters: 300, epoch: 2 | loss: 0.3441349
	speed: 9.3179s/iter; left time: 179742.7324s
	iters: 400, epoch: 2 | loss: 0.4469661
	speed: 9.3147s/iter; left time: 178748.1898s
	iters: 500, epoch: 2 | loss: 0.1990674
	speed: 9.3548s/iter; left time: 178583.3284s
	iters: 600, epoch: 2 | loss: 0.4461392
	speed: 9.3415s/iter; left time: 177394.8636s
	iters: 700, epoch: 2 | loss: 0.3097821
	speed: 9.3880s/iter; left time: 177339.1151s
	iters: 800, epoch: 2 | loss: 0.2563835
	speed: 9.3280s/iter; left time: 175272.4360s
	iters: 900, epoch: 2 | loss: 0.4184901
	speed: 9.4054s/iter; left time: 175786.3953s
	iters: 1000, epoch: 2 | loss: 0.2957335
	speed: 11.5748s/iter; left time: 215176.0343s
Epoch: 2 cost time: 9997.58352136612
Epoch: 2, Steps: 1031 | Train Loss: 0.3188637 Vali Loss: 0.4654274 Test Loss: 3.5130138
Validation loss decreased (0.477842 --> 0.465427).  Saving model ...
Updating learning rate to 5e-05
Parameters: 8.145956
	iters: 100, epoch: 3 | loss: 0.3279556
	speed: 64.3081s/iter; left time: 1187063.6837s
	iters: 200, epoch: 3 | loss: 0.2821029
	speed: 9.3828s/iter; left time: 172259.6748s
	iters: 300, epoch: 3 | loss: 0.3776222
	speed: 9.3793s/iter; left time: 171257.3015s
	iters: 400, epoch: 3 | loss: 0.4127847
	speed: 9.2613s/iter; left time: 168175.1341s
	iters: 500, epoch: 3 | loss: 0.2416882
	speed: 9.3381s/iter; left time: 168637.3784s
	iters: 600, epoch: 3 | loss: 0.2214428
	speed: 9.3700s/iter; left time: 168275.0561s
	iters: 700, epoch: 3 | loss: 0.2068648
	speed: 9.3074s/iter; left time: 166221.3895s
	iters: 800, epoch: 3 | loss: 0.2289422
	speed: 9.2499s/iter; left time: 164268.8356s
	iters: 900, epoch: 3 | loss: 0.2624871
	speed: 9.4833s/iter; left time: 167466.3480s
	iters: 1000, epoch: 3 | loss: 0.2645006
	speed: 9.3452s/iter; left time: 164091.9677s
Epoch: 3 cost time: 9637.743840456009
Epoch: 3, Steps: 1031 | Train Loss: 0.2860540 Vali Loss: 0.5031593 Test Loss: 3.5688853
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.5e-05
Parameters: 8.145956
	iters: 100, epoch: 4 | loss: 0.3047970
	speed: 39.2475s/iter; left time: 684004.9110s
	iters: 200, epoch: 4 | loss: 0.2558537
	speed: 9.4797s/iter; left time: 164263.4911s
	iters: 300, epoch: 4 | loss: 0.3094019
	speed: 9.3600s/iter; left time: 161254.3656s
	iters: 400, epoch: 4 | loss: 0.1968468
	speed: 9.3514s/iter; left time: 160170.8543s
	iters: 500, epoch: 4 | loss: 0.3779094
	speed: 11.3017s/iter; left time: 192445.4908s
	iters: 600, epoch: 4 | loss: 0.2011524
	speed: 13.1780s/iter; left time: 223077.8191s
	iters: 700, epoch: 4 | loss: 0.2592466
	speed: 13.3213s/iter; left time: 224171.0435s
	iters: 800, epoch: 4 | loss: 0.1688027
	speed: 13.1894s/iter; left time: 220631.5214s
	iters: 900, epoch: 4 | loss: 0.4083020
	speed: 10.2522s/iter; left time: 170473.7308s
	iters: 1000, epoch: 4 | loss: 0.2527687
	speed: 9.4265s/iter; left time: 155802.0167s
Epoch: 4 cost time: 11113.064485788345
Epoch: 4, Steps: 1031 | Train Loss: 0.2710832 Vali Loss: 0.5073572 Test Loss: 3.5688322
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.25e-05
Parameters: 8.145956
	iters: 100, epoch: 5 | loss: 0.2575074
	speed: 39.5196s/iter; left time: 648002.4098s
	iters: 200, epoch: 5 | loss: 0.3033286
	speed: 9.3503s/iter; left time: 152381.9590s
	iters: 300, epoch: 5 | loss: 0.2655683
	speed: 9.3516s/iter; left time: 151467.1870s
	iters: 400, epoch: 5 | loss: 0.2056912
	speed: 9.3699s/iter; left time: 150826.7318s
	iters: 500, epoch: 5 | loss: 0.2970014
	speed: 9.2423s/iter; left time: 147849.7894s
	iters: 600, epoch: 5 | loss: 0.2964903
	speed: 9.5533s/iter; left time: 151869.5039s
	iters: 700, epoch: 5 | loss: 0.3088817
	speed: 9.3117s/iter; left time: 147096.5185s
	iters: 800, epoch: 5 | loss: 0.3589167
	speed: 9.3457s/iter; left time: 146699.0808s
	iters: 900, epoch: 5 | loss: 0.2008053
	speed: 9.3308s/iter; left time: 145532.7379s
	iters: 1000, epoch: 5 | loss: 0.3388558
	speed: 9.3763s/iter; left time: 145303.9503s
Epoch: 5 cost time: 9655.45100235939
Epoch: 5, Steps: 1031 | Train Loss: 0.2640878 Vali Loss: 0.4987377 Test Loss: 3.5359159
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.25e-06
Parameters: 8.145956
	iters: 100, epoch: 6 | loss: 0.3711088
	speed: 39.1627s/iter; left time: 601773.5619s
	iters: 200, epoch: 6 | loss: 0.2201908
	speed: 10.3558s/iter; left time: 158091.2131s
	iters: 300, epoch: 6 | loss: 0.3180593
	speed: 13.7598s/iter; left time: 208681.6908s
	iters: 400, epoch: 6 | loss: 0.2198796
	speed: 13.6161s/iter; left time: 205140.4033s
	iters: 500, epoch: 6 | loss: 0.3223378
	speed: 13.5499s/iter; left time: 202787.0644s
	iters: 600, epoch: 6 | loss: 0.2571424
	speed: 10.6580s/iter; left time: 158442.2925s
	iters: 700, epoch: 6 | loss: 0.2912998
	speed: 9.2909s/iter; left time: 137188.9940s
	iters: 800, epoch: 6 | loss: 0.3917666
	speed: 9.3411s/iter; left time: 136996.2239s
	iters: 900, epoch: 6 | loss: 0.2377773
	speed: 9.3635s/iter; left time: 136389.2429s
	iters: 1000, epoch: 6 | loss: 0.2805907
	speed: 9.4798s/iter; left time: 137134.3595s
Epoch: 6 cost time: 11169.49123620987
Epoch: 6, Steps: 1031 | Train Loss: 0.2604742 Vali Loss: 0.5038934 Test Loss: 3.5774834
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.125e-06
Parameters: 8.145956
	iters: 100, epoch: 7 | loss: 0.3214711
	speed: 39.5584s/iter; left time: 567070.0592s
	iters: 200, epoch: 7 | loss: 0.3331183
	speed: 9.3830s/iter; left time: 133566.3514s
	iters: 300, epoch: 7 | loss: 0.2734713
	speed: 9.3530s/iter; left time: 132204.4716s
	iters: 400, epoch: 7 | loss: 0.1669761
	speed: 9.4701s/iter; left time: 132913.4513s
	iters: 500, epoch: 7 | loss: 0.4857582
	speed: 9.4079s/iter; left time: 131099.1994s
	iters: 600, epoch: 7 | loss: 0.2272661
	speed: 9.2940s/iter; left time: 128582.4918s
	iters: 700, epoch: 7 | loss: 0.2794442
	speed: 9.4347s/iter; left time: 129585.6474s
	iters: 800, epoch: 7 | loss: 0.3188689
	speed: 9.3126s/iter; left time: 126977.9408s
	iters: 900, epoch: 7 | loss: 0.3720517
	speed: 9.3317s/iter; left time: 126304.6791s
	iters: 1000, epoch: 7 | loss: 0.4001488
	speed: 9.4771s/iter; left time: 127324.5202s
Epoch: 7 cost time: 9676.673071622849
Epoch: 7, Steps: 1031 | Train Loss: 0.2586144 Vali Loss: 0.5047126 Test Loss: 3.5637429
EarlyStopping counter: 5 out of 5
Updating learning rate to 1.5625e-06
Early stopping
>>>>>>>testing : long_term_forecast_DiscoveryPassage_and_others_720_360_96cf_Crossformer_custom_ftM_sl360_ll48_pl360_dm256_nh8_el2_dl1_df512_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Chlorophyll (ug/l) Chlorophyll (ug/l)
test 9278
test shape: (9278, 1, 360, 8) (9278, 1, 360, 8)
test shape: (9278, 360, 8) (9278, 360, 8)
mse:3.513012647628784, mae:0.9436008930206299





bash ./scripts/DiscoveryPassage_and_others_Script/crossformer.sh
MODEL IMPLEMENTED= Crossformer
PREDICTION LENGTH= 336
SEQUENCE LENGTH= 336
LEARNING RATE ADJUSTMENT= type1
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=8, checkpoints='./checkpoints/', d_ff=512, d_layers=1, d_model=256, data='custom', data_path='DiscoveryPassage_and_others_merged.csv', dec_in=8, des='Exp', devices='0,1,2,3', distil=True, dropout=0.1, e_layers=2, embed='timeF', enc_in=8, factor=3, features='M', freq='h', gpu=0, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='Crossformer', model_id='DiscoveryPassage_and_others_720_360_96cf', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=336, root_path='./dataset/', seasonal_patterns='Monthly', seq_len=336, target='Chlorophyll (ug/l)', task_name='long_term_forecast', top_k=5, train_epochs=20, use_amp=False, use_gpu=False, use_multi_gpu=False, w_lin=0.01)
Use CPU
>>>>>>>start training : long_term_forecast_DiscoveryPassage_and_others_720_360_96cf_Crossformer_custom_ftM_sl336_ll48_pl336_dm256_nh8_el2_dl1_df512_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
Chlorophyll (ug/l) Chlorophyll (ug/l)
train 33059
Chlorophyll (ug/l) Chlorophyll (ug/l)
val 4485
Chlorophyll (ug/l) Chlorophyll (ug/l)
test 9302
Parameters: 8.130852
	iters: 100, epoch: 1 | loss: 0.7013089
	speed: 4.1263s/iter; left time: 84841.4740s
	iters: 200, epoch: 1 | loss: 0.6079055
	speed: 4.4000s/iter; left time: 90028.2377s
	iters: 300, epoch: 1 | loss: 0.3752493
	speed: 4.3628s/iter; left time: 88830.7726s
	iters: 400, epoch: 1 | loss: 0.3207355
	speed: 4.3581s/iter; left time: 88299.3793s
	iters: 500, epoch: 1 | loss: 0.3832917
	speed: 4.3188s/iter; left time: 87072.2523s
	iters: 600, epoch: 1 | loss: 0.3567068
	speed: 4.3445s/iter; left time: 87154.9433s
	iters: 700, epoch: 1 | loss: 0.3226768
	speed: 4.3414s/iter; left time: 86659.2646s
	iters: 800, epoch: 1 | loss: 0.3519392
	speed: 4.3587s/iter; left time: 86568.4028s
	iters: 900, epoch: 1 | loss: 0.3704091
	speed: 4.5010s/iter; left time: 88943.7252s
	iters: 1000, epoch: 1 | loss: 0.4374592
	speed: 4.3871s/iter; left time: 86254.5524s
Epoch: 1 cost time: 4498.136207342148
Epoch: 1, Steps: 1033 | Train Loss: 0.4132740 Vali Loss: 0.4027598 Test Loss: 3.1153986
Validation loss decreased (inf --> 0.402760).  Saving model ...
Updating learning rate to 0.0001
Parameters: 8.130852
	iters: 100, epoch: 2 | loss: 0.2333607
	speed: 12.9877s/iter; left time: 253624.2083s
	iters: 200, epoch: 2 | loss: 0.2274133
	speed: 4.3845s/iter; left time: 85181.2771s
	iters: 300, epoch: 2 | loss: 0.2928500
	speed: 4.3760s/iter; left time: 84579.3110s
	iters: 400, epoch: 2 | loss: 0.3950315
	speed: 4.3532s/iter; left time: 83704.1913s
	iters: 500, epoch: 2 | loss: 0.4282324
	speed: 4.3964s/iter; left time: 84094.8875s
	iters: 600, epoch: 2 | loss: 0.2684767
	speed: 4.3563s/iter; left time: 82892.1181s
	iters: 700, epoch: 2 | loss: 0.1961365
	speed: 4.3717s/iter; left time: 82747.3188s
	iters: 800, epoch: 2 | loss: 0.3102073
	speed: 4.5329s/iter; left time: 85345.5480s
	iters: 900, epoch: 2 | loss: 0.5060719
	speed: 4.6611s/iter; left time: 87293.1265s
	iters: 1000, epoch: 2 | loss: 0.3911313
	speed: 4.6554s/iter; left time: 86720.4825s
Epoch: 2 cost time: 4605.1429271698
Epoch: 2, Steps: 1033 | Train Loss: 0.3197031 Vali Loss: 0.4385142 Test Loss: 3.5007756
EarlyStopping counter: 1 out of 5
Updating learning rate to 5e-05
Parameters: 8.130852
	iters: 100, epoch: 3 | loss: 0.2305081
	speed: 13.7596s/iter; left time: 254482.8842s
	iters: 200, epoch: 3 | loss: 0.2135224
	speed: 4.3890s/iter; left time: 80735.1617s
	iters: 300, epoch: 3 | loss: 0.2641304
	speed: 4.3844s/iter; left time: 80212.9548s
	iters: 400, epoch: 3 | loss: 0.3511776
	speed: 4.3813s/iter; left time: 79717.7539s
	iters: 500, epoch: 3 | loss: 0.2550269
	speed: 4.4204s/iter; left time: 79987.8677s
	iters: 600, epoch: 3 | loss: 0.2805772
	speed: 4.3939s/iter; left time: 79067.8585s
	iters: 700, epoch: 3 | loss: 0.3325976
	speed: 4.4262s/iter; left time: 79206.7584s
	iters: 800, epoch: 3 | loss: 0.2152463
	speed: 4.3688s/iter; left time: 77743.1854s
	iters: 900, epoch: 3 | loss: 0.2562014
	speed: 4.4260s/iter; left time: 78317.2266s
	iters: 1000, epoch: 3 | loss: 0.3569715
	speed: 4.3943s/iter; left time: 77318.0769s
Epoch: 3 cost time: 4570.494649887085
Epoch: 3, Steps: 1033 | Train Loss: 0.2886231 Vali Loss: 0.4450332 Test Loss: 3.5502672
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.5e-05
Parameters: 8.130852
	iters: 100, epoch: 4 | loss: 0.2606295
	speed: 12.8883s/iter; left time: 225054.8435s
	iters: 200, epoch: 4 | loss: 0.2647013
	speed: 4.4010s/iter; left time: 76409.5596s
	iters: 300, epoch: 4 | loss: 0.3380238
	speed: 4.3528s/iter; left time: 75138.8116s
	iters: 400, epoch: 4 | loss: 0.3746451
	speed: 4.3773s/iter; left time: 75122.8030s
	iters: 500, epoch: 4 | loss: 0.2531741
	speed: 4.3636s/iter; left time: 74451.0685s
	iters: 600, epoch: 4 | loss: 0.2674220
	speed: 4.4006s/iter; left time: 74643.1781s
	iters: 700, epoch: 4 | loss: 0.3007261
	speed: 4.4000s/iter; left time: 74193.3876s
	iters: 800, epoch: 4 | loss: 0.3131374
	speed: 4.3827s/iter; left time: 73462.6437s
	iters: 900, epoch: 4 | loss: 0.3613367
	speed: 4.3752s/iter; left time: 72898.7823s
	iters: 1000, epoch: 4 | loss: 0.2429973
	speed: 4.3848s/iter; left time: 72621.3937s
Epoch: 4 cost time: 4530.474227666855
Epoch: 4, Steps: 1033 | Train Loss: 0.2747721 Vali Loss: 0.4593237 Test Loss: 3.5276256
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.25e-05
Parameters: 8.130852
	iters: 100, epoch: 5 | loss: 0.2341426
	speed: 12.9368s/iter; left time: 212539.4812s
	iters: 200, epoch: 5 | loss: 0.2559897
	speed: 4.3683s/iter; left time: 71330.3653s
	iters: 300, epoch: 5 | loss: 0.1803977
	speed: 4.3777s/iter; left time: 71046.2160s
	iters: 400, epoch: 5 | loss: 0.2319825
	speed: 4.3891s/iter; left time: 70791.3721s
	iters: 500, epoch: 5 | loss: 0.1657572
	speed: 4.3703s/iter; left time: 70052.0249s
	iters: 600, epoch: 5 | loss: 0.2592106
	speed: 4.3929s/iter; left time: 69974.2149s
	iters: 700, epoch: 5 | loss: 0.3178565
	speed: 4.3716s/iter; left time: 69197.8196s
	iters: 800, epoch: 5 | loss: 0.2823551
	speed: 4.3618s/iter; left time: 68606.7570s
	iters: 900, epoch: 5 | loss: 0.2629951
	speed: 4.3528s/iter; left time: 68030.4235s
	iters: 1000, epoch: 5 | loss: 0.2072370
	speed: 4.4000s/iter; left time: 68327.0368s
Epoch: 5 cost time: 4522.958790540695
Epoch: 5, Steps: 1033 | Train Loss: 0.2680191 Vali Loss: 0.4533755 Test Loss: 3.5014992
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.25e-06
Parameters: 8.130852
	iters: 100, epoch: 6 | loss: 0.4646957
	speed: 12.8129s/iter; left time: 197267.9011s
	iters: 200, epoch: 6 | loss: 0.3471220
	speed: 4.4067s/iter; left time: 67405.5045s
	iters: 300, epoch: 6 | loss: 0.2806208
	speed: 4.3539s/iter; left time: 66161.3537s
	iters: 400, epoch: 6 | loss: 0.2450356
	speed: 4.3824s/iter; left time: 66156.2559s
	iters: 500, epoch: 6 | loss: 0.3179748
	speed: 4.3546s/iter; left time: 65302.2668s
	iters: 600, epoch: 6 | loss: 0.2064989
	speed: 4.3720s/iter; left time: 65124.6938s
	iters: 700, epoch: 6 | loss: 0.2386086
	speed: 4.3558s/iter; left time: 64447.7783s
	iters: 800, epoch: 6 | loss: 0.2123415
	speed: 4.3974s/iter; left time: 64624.2876s
	iters: 900, epoch: 6 | loss: 0.3365275
	speed: 4.3615s/iter; left time: 63659.9174s
	iters: 1000, epoch: 6 | loss: 0.2176474
	speed: 4.3798s/iter; left time: 63489.2221s
Epoch: 6 cost time: 4520.923404932022
Epoch: 6, Steps: 1033 | Train Loss: 0.2648060 Vali Loss: 0.4636705 Test Loss: 3.4963551
EarlyStopping counter: 5 out of 5
Updating learning rate to 3.125e-06
Early stopping
>>>>>>>testing : long_term_forecast_DiscoveryPassage_and_others_720_360_96cf_Crossformer_custom_ftM_sl336_ll48_pl336_dm256_nh8_el2_dl1_df512_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Chlorophyll (ug/l) Chlorophyll (ug/l)
test 9302
test shape: (9302, 1, 336, 8) (9302, 1, 336, 8)
test shape: (9302, 336, 8) (9302, 336, 8)
mse:3.115400791168213, mae:0.8903450965881348



bash ./scripts/DiscoveryPassage_and_others_Script/crossformer.sh
MODEL IMPLEMENTED= Crossformer
PREDICTION LENGTH= 192
SEQUENCE LENGTH= 192
LEARNING RATE ADJUSTMENT= type1
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=8, checkpoints='./checkpoints/', d_ff=512, d_layers=1, d_model=256, data='custom', data_path='DiscoveryPassage_and_others_merged.csv', dec_in=8, des='Exp', devices='0,1,2,3', distil=True, dropout=0.1, e_layers=2, embed='timeF', enc_in=8, factor=3, features='M', freq='h', gpu=0, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='Crossformer', model_id='DiscoveryPassage_and_others_720_360_96cf', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=192, root_path='./dataset/', seasonal_patterns='Monthly', seq_len=192, target='Chlorophyll (ug/l)', task_name='long_term_forecast', top_k=5, train_epochs=20, use_amp=False, use_gpu=False, use_multi_gpu=False, w_lin=0.01)
Use CPU
>>>>>>>start training : long_term_forecast_DiscoveryPassage_and_others_720_360_96cf_Crossformer_custom_ftM_sl192_ll48_pl192_dm256_nh8_el2_dl1_df512_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
Chlorophyll (ug/l) Chlorophyll (ug/l)
train 33347
Chlorophyll (ug/l) Chlorophyll (ug/l)
val 4629
Chlorophyll (ug/l) Chlorophyll (ug/l)
test 9446
Parameters: 8.040228
	iters: 100, epoch: 1 | loss: 0.5313163
	speed: 3.5289s/iter; left time: 73193.8705s
	iters: 200, epoch: 1 | loss: 0.5327131
	speed: 3.5915s/iter; left time: 74133.0132s
	iters: 300, epoch: 1 | loss: 0.2510842
	speed: 2.9312s/iter; left time: 60210.2696s
	iters: 400, epoch: 1 | loss: 0.3509970
	speed: 2.6692s/iter; left time: 54560.8489s
	iters: 500, epoch: 1 | loss: 0.3561144
	speed: 2.6540s/iter; left time: 53985.3743s
	iters: 600, epoch: 1 | loss: 0.5476453
	speed: 2.6678s/iter; left time: 53999.3136s
	iters: 700, epoch: 1 | loss: 0.4708670
	speed: 2.6423s/iter; left time: 53217.9853s
	iters: 800, epoch: 1 | loss: 0.4596942
	speed: 2.6677s/iter; left time: 53463.2165s
	iters: 900, epoch: 1 | loss: 0.3119521
	speed: 2.6532s/iter; left time: 52906.5109s
	iters: 1000, epoch: 1 | loss: 0.5941469
	speed: 2.6696s/iter; left time: 52966.8989s
Epoch: 1 cost time: 2980.930457830429
Epoch: 1, Steps: 1042 | Train Loss: 0.3947760 Vali Loss: 0.3041835 Test Loss: 2.7027051
Validation loss decreased (inf --> 0.304183).  Saving model ...
Updating learning rate to 0.0001
Parameters: 8.040228
	iters: 100, epoch: 2 | loss: 0.4309171
	speed: 8.8233s/iter; left time: 173809.3397s
	iters: 200, epoch: 2 | loss: 0.2821003
	speed: 2.6638s/iter; left time: 52207.8181s
	iters: 300, epoch: 2 | loss: 0.1806701
	speed: 2.6350s/iter; left time: 51380.6711s
	iters: 400, epoch: 2 | loss: 0.2880473
	speed: 2.6677s/iter; left time: 51750.2505s
	iters: 500, epoch: 2 | loss: 0.4384755
	speed: 2.6574s/iter; left time: 51285.1522s
	iters: 600, epoch: 2 | loss: 0.2582740
	speed: 2.6233s/iter; left time: 50365.0579s
	iters: 700, epoch: 2 | loss: 0.3190036
	speed: 2.6334s/iter; left time: 50295.6184s
	iters: 800, epoch: 2 | loss: 0.2639306
	speed: 2.6640s/iter; left time: 50612.7528s
	iters: 900, epoch: 2 | loss: 0.3134233
	speed: 2.6792s/iter; left time: 50634.9354s
	iters: 1000, epoch: 2 | loss: 0.3223822
	speed: 2.6477s/iter; left time: 49773.5953s
Epoch: 2 cost time: 2766.96599984169
Epoch: 2, Steps: 1042 | Train Loss: 0.3236026 Vali Loss: 0.4384839 Test Loss: 2.8696554
EarlyStopping counter: 1 out of 5
Updating learning rate to 5e-05
Parameters: 8.040228
	iters: 100, epoch: 3 | loss: 0.2224201
	speed: 8.7774s/iter; left time: 163760.1570s
	iters: 200, epoch: 3 | loss: 0.2802565
	speed: 2.6522s/iter; left time: 49217.1415s
	iters: 300, epoch: 3 | loss: 0.2334579
	speed: 2.6485s/iter; left time: 48883.2989s
	iters: 400, epoch: 3 | loss: 0.2735251
	speed: 2.6547s/iter; left time: 48731.8967s
	iters: 500, epoch: 3 | loss: 0.3417916
	speed: 2.6546s/iter; left time: 48465.5922s
	iters: 600, epoch: 3 | loss: 0.2640507
	speed: 2.6615s/iter; left time: 48325.5719s
	iters: 700, epoch: 3 | loss: 0.2420620
	speed: 2.6644s/iter; left time: 48111.8000s
	iters: 800, epoch: 3 | loss: 0.2364947
	speed: 2.6580s/iter; left time: 47729.6522s
	iters: 900, epoch: 3 | loss: 0.4055111
	speed: 2.6437s/iter; left time: 47207.9320s
	iters: 1000, epoch: 3 | loss: 0.2998528
	speed: 2.6404s/iter; left time: 46886.0894s
Epoch: 3 cost time: 2765.57172703743
Epoch: 3, Steps: 1042 | Train Loss: 0.2909659 Vali Loss: 0.4691559 Test Loss: 2.9892023
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.5e-05
Parameters: 8.040228
	iters: 100, epoch: 4 | loss: 0.3213534
	speed: 8.7910s/iter; left time: 154853.7205s
	iters: 200, epoch: 4 | loss: 0.4153460
	speed: 2.6610s/iter; left time: 46606.5814s
	iters: 300, epoch: 4 | loss: 0.2376970
	speed: 2.6660s/iter; left time: 46427.8380s
	iters: 400, epoch: 4 | loss: 0.1933037
	speed: 2.6533s/iter; left time: 45942.3015s
	iters: 500, epoch: 4 | loss: 0.3215524
	speed: 2.6748s/iter; left time: 46046.7916s
	iters: 600, epoch: 4 | loss: 0.2072475
	speed: 2.6473s/iter; left time: 45308.7991s
	iters: 700, epoch: 4 | loss: 0.3111694
	speed: 2.6593s/iter; left time: 45248.6331s
	iters: 800, epoch: 4 | loss: 0.1933403
	speed: 2.6485s/iter; left time: 44799.6275s
	iters: 900, epoch: 4 | loss: 0.2917752
	speed: 2.6488s/iter; left time: 44539.4569s
	iters: 1000, epoch: 4 | loss: 0.2732640
	speed: 2.6683s/iter; left time: 44600.2759s
Epoch: 4 cost time: 2768.15988445282
Epoch: 4, Steps: 1042 | Train Loss: 0.2760655 Vali Loss: 0.4402360 Test Loss: 2.8634360
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.25e-05
Parameters: 8.040228
	iters: 100, epoch: 5 | loss: 0.3083767
	speed: 8.7365s/iter; left time: 144790.6845s
	iters: 200, epoch: 5 | loss: 0.2933626
	speed: 2.6623s/iter; left time: 43856.3321s
	iters: 300, epoch: 5 | loss: 0.3019805
	speed: 2.6511s/iter; left time: 43406.5365s
	iters: 400, epoch: 5 | loss: 0.2648537
	speed: 2.6388s/iter; left time: 42940.8657s
	iters: 500, epoch: 5 | loss: 0.3245902
	speed: 2.6509s/iter; left time: 42872.4195s
	iters: 600, epoch: 5 | loss: 0.2566760
	speed: 2.6438s/iter; left time: 42494.2985s
	iters: 700, epoch: 5 | loss: 0.3150289
	speed: 2.6451s/iter; left time: 42250.2394s
	iters: 800, epoch: 5 | loss: 0.2822516
	speed: 2.6252s/iter; left time: 41670.0082s
	iters: 900, epoch: 5 | loss: 0.1623462
	speed: 2.6440s/iter; left time: 41703.2086s
	iters: 1000, epoch: 5 | loss: 0.2496281
	speed: 2.6512s/iter; left time: 41552.2981s
Epoch: 5 cost time: 2758.779586315155
Epoch: 5, Steps: 1042 | Train Loss: 0.2690251 Vali Loss: 0.4435342 Test Loss: 2.9297397
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.25e-06
Parameters: 8.040228
	iters: 100, epoch: 6 | loss: 0.2896379
	speed: 8.7480s/iter; left time: 135864.7261s
	iters: 200, epoch: 6 | loss: 0.2257452
	speed: 2.6455s/iter; left time: 40823.3683s
	iters: 300, epoch: 6 | loss: 0.2640381
	speed: 2.6593s/iter; left time: 40769.6005s
	iters: 400, epoch: 6 | loss: 0.2601089
	speed: 2.6549s/iter; left time: 40436.4753s
	iters: 500, epoch: 6 | loss: 0.2924180
	speed: 2.6351s/iter; left time: 39871.4796s
	iters: 600, epoch: 6 | loss: 0.2519327
	speed: 2.6506s/iter; left time: 39840.4608s
	iters: 700, epoch: 6 | loss: 0.2778195
	speed: 2.6418s/iter; left time: 39444.3705s
	iters: 800, epoch: 6 | loss: 0.3648759
	speed: 2.6386s/iter; left time: 39132.8714s
	iters: 900, epoch: 6 | loss: 0.4307350
	speed: 2.6613s/iter; left time: 39204.1181s
	iters: 1000, epoch: 6 | loss: 0.1533958
	speed: 2.6565s/iter; left time: 38866.5205s
Epoch: 6 cost time: 2760.8867151737213
Epoch: 6, Steps: 1042 | Train Loss: 0.2655342 Vali Loss: 0.4690933 Test Loss: 2.9827406
EarlyStopping counter: 5 out of 5
Updating learning rate to 3.125e-06
Early stopping
>>>>>>>testing : long_term_forecast_DiscoveryPassage_and_others_720_360_96cf_Crossformer_custom_ftM_sl192_ll48_pl192_dm256_nh8_el2_dl1_df512_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Chlorophyll (ug/l) Chlorophyll (ug/l)
test 9446
test shape: (9446, 1, 192, 8) (9446, 1, 192, 8)
test shape: (9446, 192, 8) (9446, 192, 8)
mse:2.702702283859253, mae:0.8220290541648865

MODEL IMPLEMENTED= Crossformer
PREDICTION LENGTH= 96
SEQUENCE LENGTH= 96
LEARNING RATE ADJUSTMENT= type2 
 
bash ./scripts/DiscoveryPassage_and_others_Script/crossformer.sh
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=8, checkpoints='./checkpoints/', d_ff=512, d_layers=1, d_model=256, data='custom', data_path='DiscoveryPassage_and_others_merged.csv', dec_in=8, des='Exp', devices='0,1,2,3', distil=True, dropout=0.1, e_layers=2, embed='timeF', enc_in=8, factor=3, features='M', freq='h', gpu=0, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type2', mask_rate=0.25, model='Crossformer', model_id='DiscoveryPassage_and_others_720_360_96cf', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=96, root_path='./dataset/', seasonal_patterns='Monthly', seq_len=96, target='Chlorophyll (ug/l)', task_name='long_term_forecast', top_k=5, train_epochs=20, use_amp=False, use_gpu=False, use_multi_gpu=False, w_lin=0.01)
Use CPU
>>>>>>>start training : long_term_forecast_DiscoveryPassage_and_others_720_360_96cf_Crossformer_custom_ftM_sl96_ll48_pl96_dm256_nh8_el2_dl1_df512_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
Chlorophyll (ug/l) Chlorophyll (ug/l)
train 33539
Chlorophyll (ug/l) Chlorophyll (ug/l)
val 4725
Chlorophyll (ug/l) Chlorophyll (ug/l)
test 9542
Parameters: 7.979812
	iters: 100, epoch: 1 | loss: 0.5799417
	speed: 1.3733s/iter; left time: 57430.8248s
	iters: 200, epoch: 1 | loss: 0.5023898
	speed: 1.3107s/iter; left time: 54681.6351s
	iters: 300, epoch: 1 | loss: 0.2163882
	speed: 1.2739s/iter; left time: 53019.0521s
	iters: 400, epoch: 1 | loss: 0.4592958
	speed: 1.3376s/iter; left time: 55538.5157s
	iters: 500, epoch: 1 | loss: 0.3647887
	speed: 1.2472s/iter; left time: 51660.1231s
	iters: 600, epoch: 1 | loss: 0.2550313
	speed: 1.2849s/iter; left time: 53091.3053s
	iters: 700, epoch: 1 | loss: 0.3587349
	speed: 1.2396s/iter; left time: 51096.6946s
	iters: 800, epoch: 1 | loss: 0.1499236
	speed: 1.2845s/iter; left time: 52818.8322s
	iters: 900, epoch: 1 | loss: 0.1894469
	speed: 1.3122s/iter; left time: 53828.5121s
	iters: 1000, epoch: 1 | loss: 0.3370058
	speed: 1.2872s/iter; left time: 52673.9537s
	iters: 1100, epoch: 1 | loss: 0.4791600
	speed: 1.3036s/iter; left time: 53213.9494s
	iters: 1200, epoch: 1 | loss: 0.1431691
	speed: 1.2224s/iter; left time: 49778.5708s
	iters: 1300, epoch: 1 | loss: 0.1793242
	speed: 1.2612s/iter; left time: 51230.8603s
	iters: 1400, epoch: 1 | loss: 0.3685149
	speed: 1.2151s/iter; left time: 49235.1588s
	iters: 1500, epoch: 1 | loss: 0.1636034
	speed: 1.2087s/iter; left time: 48858.6737s
	iters: 1600, epoch: 1 | loss: 0.3636139
	speed: 1.3184s/iter; left time: 53158.5698s
	iters: 1700, epoch: 1 | loss: 0.4579906
	speed: 1.2232s/iter; left time: 49198.9477s
	iters: 1800, epoch: 1 | loss: 0.9002956
	speed: 1.2350s/iter; left time: 49548.6430s
	iters: 1900, epoch: 1 | loss: 0.3331553
	speed: 1.2332s/iter; left time: 49352.8916s
	iters: 2000, epoch: 1 | loss: 0.4831819
	speed: 1.1968s/iter; left time: 47777.9058s
Epoch: 1 cost time: 2660.0878446102142
Epoch: 1, Steps: 2096 | Train Loss: 0.3387232 Vali Loss: 0.2286899 Test Loss: 2.3658185
Validation loss decreased (inf --> 0.228690).  Saving model ...
Parameters: 7.979812
	iters: 100, epoch: 2 | loss: 0.2942507
	speed: 8.8476s/iter; left time: 351471.0219s
	iters: 200, epoch: 2 | loss: 0.3460065
	speed: 1.2999s/iter; left time: 51506.7006s
	iters: 300, epoch: 2 | loss: 0.3050756
	speed: 1.2191s/iter; left time: 48184.1057s
	iters: 400, epoch: 2 | loss: 0.3684376
	speed: 1.2410s/iter; left time: 48926.4146s
	iters: 500, epoch: 2 | loss: 0.2886531
	speed: 1.2812s/iter; left time: 50381.6961s
	iters: 600, epoch: 2 | loss: 0.2554494
	speed: 1.2026s/iter; left time: 47172.5357s
	iters: 700, epoch: 2 | loss: 0.2822553
	speed: 1.2689s/iter; left time: 49646.3834s
	iters: 800, epoch: 2 | loss: 0.2725071
	speed: 1.2216s/iter; left time: 47672.4477s
	iters: 900, epoch: 2 | loss: 0.3837982
	speed: 1.2799s/iter; left time: 49819.9246s
	iters: 1000, epoch: 2 | loss: 0.2616798
	speed: 1.2375s/iter; left time: 48045.4397s
	iters: 1100, epoch: 2 | loss: 0.3350271
	speed: 1.2709s/iter; left time: 49216.0804s
	iters: 1200, epoch: 2 | loss: 0.2298767
	speed: 1.2954s/iter; left time: 50035.6669s
	iters: 1300, epoch: 2 | loss: 0.4270741
	speed: 1.2049s/iter; left time: 46418.3423s
	iters: 1400, epoch: 2 | loss: 0.2511474
	speed: 1.2617s/iter; left time: 48482.0919s
	iters: 1500, epoch: 2 | loss: 0.1296380
	speed: 1.2062s/iter; left time: 46228.3007s
	iters: 1600, epoch: 2 | loss: 0.2211540
	speed: 1.2530s/iter; left time: 47895.1807s
	iters: 1700, epoch: 2 | loss: 0.1498622
	speed: 1.2291s/iter; left time: 46859.6421s
	iters: 1800, epoch: 2 | loss: 0.2174893
	speed: 1.2195s/iter; left time: 46370.2663s
	iters: 1900, epoch: 2 | loss: 0.1598036
	speed: 1.2930s/iter; left time: 49038.6548s
	iters: 2000, epoch: 2 | loss: 0.2474480
	speed: 1.2039s/iter; left time: 45537.1534s
Epoch: 2 cost time: 2617.1641426086426
Epoch: 2, Steps: 2096 | Train Loss: 0.2928771 Vali Loss: 0.2220791 Test Loss: 2.3882167
Validation loss decreased (0.228690 --> 0.222079).  Saving model ...
Updating learning rate to 5e-05
Parameters: 7.979812
	iters: 100, epoch: 3 | loss: 0.2071751
	speed: 8.7747s/iter; left time: 330183.5769s
	iters: 200, epoch: 3 | loss: 0.2672639
	speed: 1.2574s/iter; left time: 47187.6596s
	iters: 300, epoch: 3 | loss: 0.2228790
	speed: 1.1852s/iter; left time: 44359.7845s
	iters: 400, epoch: 3 | loss: 0.2048042
	speed: 1.1604s/iter; left time: 43316.9060s
	iters: 500, epoch: 3 | loss: 0.3445418
	speed: 1.1722s/iter; left time: 43641.5328s
	iters: 600, epoch: 3 | loss: 0.1921523
	speed: 1.0857s/iter; left time: 40310.6153s
	iters: 700, epoch: 3 | loss: 0.1076977
	speed: 1.0768s/iter; left time: 39871.2672s
	iters: 800, epoch: 3 | loss: 0.1830597
	speed: 1.1538s/iter; left time: 42609.4605s
	iters: 900, epoch: 3 | loss: 0.4469265
	speed: 1.0881s/iter; left time: 40074.1744s
	iters: 1000, epoch: 3 | loss: 0.2165793
	speed: 1.1678s/iter; left time: 42893.4563s
	iters: 1100, epoch: 3 | loss: 0.4173265
	speed: 1.1008s/iter; left time: 40322.0663s
	iters: 1200, epoch: 3 | loss: 0.1795647
	speed: 1.0751s/iter; left time: 39273.8426s
	iters: 1300, epoch: 3 | loss: 0.1886135
	speed: 1.2302s/iter; left time: 44813.2882s
	iters: 1400, epoch: 3 | loss: 0.4028910
	speed: 1.0862s/iter; left time: 39462.1319s
	iters: 1500, epoch: 3 | loss: 0.2227870
	speed: 1.0743s/iter; left time: 38921.2460s
	iters: 1600, epoch: 3 | loss: 0.2760015
	speed: 1.1545s/iter; left time: 41710.0012s
	iters: 1700, epoch: 3 | loss: 0.6100594
	speed: 1.1363s/iter; left time: 40941.2053s
	iters: 1800, epoch: 3 | loss: 0.1222358
	speed: 1.1859s/iter; left time: 42606.5978s
	iters: 1900, epoch: 3 | loss: 0.2244280
	speed: 1.1581s/iter; left time: 41493.2021s
	iters: 2000, epoch: 3 | loss: 0.3574094
	speed: 1.0854s/iter; left time: 38779.6236s
Epoch: 3 cost time: 2396.6304779052734
Epoch: 3, Steps: 2096 | Train Loss: 0.2672921 Vali Loss: 0.2156482 Test Loss: 2.3978577
Validation loss decreased (0.222079 --> 0.215648).  Saving model ...
Parameters: 7.979812
	iters: 100, epoch: 4 | loss: 0.2377739
	speed: 7.9703s/iter; left time: 283208.7323s
	iters: 200, epoch: 4 | loss: 0.2677272
	speed: 1.0725s/iter; left time: 38000.2857s
	iters: 300, epoch: 4 | loss: 0.2783265
	speed: 1.1322s/iter; left time: 40004.7229s
	iters: 400, epoch: 4 | loss: 0.3344795
	speed: 1.0795s/iter; left time: 38034.0013s
	iters: 500, epoch: 4 | loss: 0.2599123
	speed: 1.1036s/iter; left time: 38773.7289s
	iters: 600, epoch: 4 | loss: 0.1069816
	speed: 1.1363s/iter; left time: 39808.5282s
	iters: 700, epoch: 4 | loss: 0.3462608
	speed: 1.0847s/iter; left time: 37892.3810s
	iters: 800, epoch: 4 | loss: 0.1194531
	speed: 1.1966s/iter; left time: 41680.0302s
	iters: 900, epoch: 4 | loss: 0.1938377
	speed: 1.1348s/iter; left time: 39414.2784s
	iters: 1000, epoch: 4 | loss: 0.3524467
	speed: 1.0856s/iter; left time: 37597.3817s
	iters: 1100, epoch: 4 | loss: 0.2704325
	speed: 1.1504s/iter; left time: 39726.1324s
	iters: 1200, epoch: 4 | loss: 0.1150728
	speed: 1.0909s/iter; left time: 37562.0329s
	iters: 1300, epoch: 4 | loss: 0.3696254
	speed: 1.1345s/iter; left time: 38949.9167s
	iters: 1400, epoch: 4 | loss: 0.1569628
	speed: 1.1282s/iter; left time: 38620.5847s
	iters: 1500, epoch: 4 | loss: 0.3597487
	speed: 1.1347s/iter; left time: 38729.8645s
	iters: 1600, epoch: 4 | loss: 0.1595885
	speed: 1.1978s/iter; left time: 40764.1285s
	iters: 1700, epoch: 4 | loss: 0.1903259
	speed: 1.0785s/iter; left time: 36596.0844s
	iters: 1800, epoch: 4 | loss: 0.1378505
	speed: 1.0593s/iter; left time: 35838.5618s
	iters: 1900, epoch: 4 | loss: 0.1506524
	speed: 1.1289s/iter; left time: 38081.1833s
	iters: 2000, epoch: 4 | loss: 0.3410091
	speed: 1.0802s/iter; left time: 36330.1983s
Epoch: 4 cost time: 2340.269335269928
Epoch: 4, Steps: 2096 | Train Loss: 0.2559402 Vali Loss: 0.2238012 Test Loss: 2.5709920
EarlyStopping counter: 1 out of 5
Updating learning rate to 1e-05
Parameters: 7.979812
	iters: 100, epoch: 5 | loss: 0.2908200
	speed: 8.7709s/iter; left time: 293274.0645s
	iters: 200, epoch: 5 | loss: 0.0872903
	speed: 1.2098s/iter; left time: 40330.0337s
	iters: 300, epoch: 5 | loss: 0.1633138
	speed: 1.2739s/iter; left time: 42341.6958s
	iters: 400, epoch: 5 | loss: 0.1037986
	speed: 1.2053s/iter; left time: 39939.5555s
	iters: 500, epoch: 5 | loss: 0.3294582
	speed: 1.3021s/iter; left time: 43018.9226s
	iters: 600, epoch: 5 | loss: 0.1168719
	speed: 1.2058s/iter; left time: 39714.9279s
	iters: 700, epoch: 5 | loss: 0.1926716
	speed: 1.2162s/iter; left time: 39937.7344s
	iters: 800, epoch: 5 | loss: 0.3131774
	speed: 1.2735s/iter; left time: 41691.1922s
	iters: 900, epoch: 5 | loss: 0.1063882
	speed: 1.2041s/iter; left time: 39298.9794s
	iters: 1000, epoch: 5 | loss: 0.1501402
	speed: 1.2655s/iter; left time: 41176.1582s
	iters: 1100, epoch: 5 | loss: 0.3072336
	speed: 1.2117s/iter; left time: 39302.4833s
	iters: 1200, epoch: 5 | loss: 0.1954418
	speed: 1.1987s/iter; left time: 38760.8789s
	iters: 1300, epoch: 5 | loss: 0.2836188
	speed: 1.2653s/iter; left time: 40788.2679s
	iters: 1400, epoch: 5 | loss: 0.0951451
	speed: 1.2030s/iter; left time: 38661.6941s
	iters: 1500, epoch: 5 | loss: 0.2404878
	speed: 1.2741s/iter; left time: 40819.2656s
	iters: 1600, epoch: 5 | loss: 0.6082052
	speed: 1.2229s/iter; left time: 39054.7584s
	iters: 1700, epoch: 5 | loss: 0.2211640
	speed: 1.2675s/iter; left time: 40353.5324s
	iters: 1800, epoch: 5 | loss: 0.2611832
	speed: 1.2200s/iter; left time: 38718.3901s
	iters: 1900, epoch: 5 | loss: 0.5232043
	speed: 1.2045s/iter; left time: 38107.4396s
	iters: 2000, epoch: 5 | loss: 0.2006414
	speed: 1.2608s/iter; left time: 39761.7790s
Epoch: 5 cost time: 2590.229385614395
Epoch: 5, Steps: 2096 | Train Loss: 0.2427922 Vali Loss: 0.2270620 Test Loss: 2.5652370
EarlyStopping counter: 2 out of 5
Parameters: 7.979812
	iters: 100, epoch: 6 | loss: 0.2279561
	speed: 8.9388s/iter; left time: 280149.5704s
	iters: 200, epoch: 6 | loss: 0.1697130
	speed: 1.2535s/iter; left time: 39159.4108s
	iters: 300, epoch: 6 | loss: 0.2523674
	speed: 1.2854s/iter; left time: 40029.1540s
	iters: 400, epoch: 6 | loss: 0.2135527
	speed: 1.2259s/iter; left time: 38053.2281s
	iters: 500, epoch: 6 | loss: 0.4476381
	speed: 1.2108s/iter; left time: 37462.7886s
	iters: 600, epoch: 6 | loss: 0.1027187
	speed: 1.3553s/iter; left time: 41800.3461s
	iters: 700, epoch: 6 | loss: 0.2639602
	speed: 1.2472s/iter; left time: 38340.2006s
	iters: 800, epoch: 6 | loss: 0.1531570
	speed: 1.2742s/iter; left time: 39042.2508s
	iters: 900, epoch: 6 | loss: 0.3877807
	speed: 1.2287s/iter; left time: 37527.0306s
	iters: 1000, epoch: 6 | loss: 0.2782008
	speed: 1.2774s/iter; left time: 38886.2123s
	iters: 1100, epoch: 6 | loss: 0.1391855
	speed: 1.2045s/iter; left time: 36545.3877s
	iters: 1200, epoch: 6 | loss: 0.0840646
	speed: 1.2105s/iter; left time: 36605.4821s
	iters: 1300, epoch: 6 | loss: 0.3425800
	speed: 1.3360s/iter; left time: 40267.7587s
	iters: 1400, epoch: 6 | loss: 0.3531606
	speed: 1.2268s/iter; left time: 36853.2752s
	iters: 1500, epoch: 6 | loss: 0.1465868
	speed: 1.2510s/iter; left time: 37457.4374s
	iters: 1600, epoch: 6 | loss: 0.3046856
	speed: 1.2081s/iter; left time: 36050.5349s
	iters: 1700, epoch: 6 | loss: 0.2546178
	speed: 1.2785s/iter; left time: 38023.5699s
	iters: 1800, epoch: 6 | loss: 0.1089071
	speed: 1.2678s/iter; left time: 37578.5675s
	iters: 1900, epoch: 6 | loss: 0.1138545
	speed: 1.2054s/iter; left time: 35607.6905s
	iters: 2000, epoch: 6 | loss: 0.1590187
	speed: 1.2759s/iter; left time: 37562.9666s
Epoch: 6 cost time: 2639.0663776397705
Epoch: 6, Steps: 2096 | Train Loss: 0.2394095 Vali Loss: 0.2274984 Test Loss: 2.5754640
EarlyStopping counter: 3 out of 5
Updating learning rate to 5e-06
Parameters: 7.979812
	iters: 100, epoch: 7 | loss: 0.1475632
	speed: 8.8315s/iter; left time: 258278.3087s
	iters: 200, epoch: 7 | loss: 0.4694333
	speed: 1.2463s/iter; left time: 36324.4465s
	iters: 300, epoch: 7 | loss: 0.2522892
	speed: 1.1904s/iter; left time: 34574.8163s
	iters: 400, epoch: 7 | loss: 0.1452474
	speed: 1.2718s/iter; left time: 36812.5781s
	iters: 500, epoch: 7 | loss: 0.2547702
	speed: 1.2474s/iter; left time: 35982.5523s
	iters: 600, epoch: 7 | loss: 0.4950497
	speed: 1.2597s/iter; left time: 36211.0981s
	iters: 700, epoch: 7 | loss: 0.1733381
	speed: 1.1677s/iter; left time: 33450.0870s
	iters: 800, epoch: 7 | loss: 0.1265335
	speed: 1.2349s/iter; left time: 35250.8634s
	iters: 900, epoch: 7 | loss: 0.1349301
	speed: 1.1690s/iter; left time: 33251.7890s
	iters: 1000, epoch: 7 | loss: 0.1913646
	speed: 1.1177s/iter; left time: 31681.8342s
	iters: 1100, epoch: 7 | loss: 0.0862582
	speed: 1.1161s/iter; left time: 31523.6256s
	iters: 1200, epoch: 7 | loss: 0.0791932
	speed: 1.0972s/iter; left time: 30881.9659s
	iters: 1300, epoch: 7 | loss: 0.1065663
	speed: 1.1311s/iter; left time: 31722.8814s
	iters: 1400, epoch: 7 | loss: 0.2290480
	speed: 1.1686s/iter; left time: 32657.4188s
	iters: 1500, epoch: 7 | loss: 0.1285559
	speed: 1.0992s/iter; left time: 30608.4352s
	iters: 1600, epoch: 7 | loss: 0.2219520
	speed: 1.0622s/iter; left time: 29469.5801s
	iters: 1700, epoch: 7 | loss: 0.1935797
	speed: 1.1388s/iter; left time: 31481.9035s
	iters: 1800, epoch: 7 | loss: 0.2026618
	speed: 1.1194s/iter; left time: 30833.9850s
	iters: 1900, epoch: 7 | loss: 0.1409373
	speed: 1.1153s/iter; left time: 30608.5788s
	iters: 2000, epoch: 7 | loss: 0.1691463
	speed: 1.0831s/iter; left time: 29616.0533s
Epoch: 7 cost time: 2433.3625371456146
Epoch: 7, Steps: 2096 | Train Loss: 0.2360287 Vali Loss: 0.2280123 Test Loss: 2.6009145
EarlyStopping counter: 4 out of 5
Parameters: 7.979812
	iters: 100, epoch: 8 | loss: 0.2123776
	speed: 7.9441s/iter; left time: 215673.7424s
	iters: 200, epoch: 8 | loss: 0.2379048
	speed: 1.0824s/iter; left time: 29276.6841s
	iters: 300, epoch: 8 | loss: 0.1552274
	speed: 1.1349s/iter; left time: 30584.3319s
	iters: 400, epoch: 8 | loss: 0.0735982
	speed: 1.1430s/iter; left time: 30687.3798s
	iters: 500, epoch: 8 | loss: 0.4896716
	speed: 1.0766s/iter; left time: 28796.7339s
	iters: 600, epoch: 8 | loss: 0.1588183
	speed: 1.1058s/iter; left time: 29469.4799s
	iters: 700, epoch: 8 | loss: 0.2297524
	speed: 1.1403s/iter; left time: 30274.8821s
	iters: 800, epoch: 8 | loss: 0.1852481
	speed: 1.1530s/iter; left time: 30496.1419s
	iters: 900, epoch: 8 | loss: 0.1998778
	speed: 1.1140s/iter; left time: 29353.6085s
	iters: 1000, epoch: 8 | loss: 0.4445399
	speed: 1.0867s/iter; left time: 28524.9855s
	iters: 1100, epoch: 8 | loss: 0.1264738
	speed: 1.1416s/iter; left time: 29852.0579s
	iters: 1200, epoch: 8 | loss: 0.1640708
	speed: 1.1293s/iter; left time: 29417.2773s
	iters: 1300, epoch: 8 | loss: 0.1668527
	speed: 1.0800s/iter; left time: 28023.7223s
	iters: 1400, epoch: 8 | loss: 0.2463991
	speed: 1.0684s/iter; left time: 27617.4251s
	iters: 1500, epoch: 8 | loss: 0.2372381
	speed: 1.1285s/iter; left time: 29056.5316s
	iters: 1600, epoch: 8 | loss: 0.5574798
	speed: 1.0634s/iter; left time: 27275.5949s
	iters: 1700, epoch: 8 | loss: 0.3654651
	speed: 1.1229s/iter; left time: 28688.4261s
	iters: 1800, epoch: 8 | loss: 0.2383388
	speed: 1.0923s/iter; left time: 27797.3509s
	iters: 1900, epoch: 8 | loss: 0.2733009
	speed: 1.0753s/iter; left time: 27256.6579s
	iters: 2000, epoch: 8 | loss: 0.2727211
	speed: 1.1243s/iter; left time: 28387.0180s
Epoch: 8 cost time: 2329.908494949341
Epoch: 8, Steps: 2096 | Train Loss: 0.2346701 Vali Loss: 0.2316883 Test Loss: 2.5856633
EarlyStopping counter: 5 out of 5
Updating learning rate to 1e-06
Early stopping
>>>>>>>testing : long_term_forecast_DiscoveryPassage_and_others_720_360_96cf_Crossformer_custom_ftM_sl96_ll48_pl96_dm256_nh8_el2_dl1_df512_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Chlorophyll (ug/l) Chlorophyll (ug/l)
test 9542
test shape: (9542, 1, 96, 8) (9542, 1, 96, 8)
test shape: (9542, 96, 8) (9542, 96, 8)
mse:2.3978586196899414, mae:0.6970788240432739








XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX_________________________________XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX 














XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX___________________FEDFORMER_____________________XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX


 bash ./scripts/DiscoveryPassage_and_others_Script/fedformer.sh
/usr/local/bin/python3
MODEL IMPLEMENTED= FEDformer
PREDICTION LENGTH= 360
SEQUENCE LENGTH= 360
LEARNING RATE ADJUSTMENT= type1
Args in experiment:
Namespace(activation='type1', anomaly_ratio=0.25, batch_size=32, c_out=8, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='DiscoveryPassage_and_others_merged.csv', dec_in=8, des='Exp', devices='0,1,2,3', distil=True, dropout=0.1, e_layers=2, embed='timeF', enc_in=8, factor=3, features='M', freq='h', gpu=0, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='FEDformer', model_id='DiscoveryPassage_and_others_720_360_96_ff', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=360, root_path='./dataset/', seasonal_patterns='Monthly', seq_len=360, target='Chlorophyll (ug/l)', task_name='long_term_forecast', top_k=5, train_epochs=20, use_amp=False, use_gpu=False, use_multi_gpu=False, w_lin=1.0)
Use CPU
fourier enhanced block used!
modes=32, index=[0, 8, 13, 14, 22, 24, 28, 43, 56, 58, 59, 66, 72, 76, 77, 79, 80, 83, 86, 96, 99, 112, 118, 126, 136, 137, 151, 155, 158, 173, 176, 179]
fourier enhanced block used!
modes=32, index=[4, 12, 13, 34, 35, 46, 76, 87, 89, 92, 104, 106, 107, 111, 118, 124, 129, 134, 138, 150, 161, 169, 186, 189, 191, 203, 209, 213, 220, 228, 241, 263]
 fourier enhanced cross attention used!
modes_q=32, index_q=[9, 16, 18, 20, 28, 32, 40, 46, 73, 76, 79, 80, 81, 84, 85, 95, 105, 121, 123, 152, 172, 173, 174, 187, 201, 206, 207, 216, 222, 249, 252, 264]
modes_kv=32, index_kv=[6, 19, 20, 27, 35, 38, 54, 59, 60, 61, 62, 65, 67, 70, 71, 72, 74, 82, 83, 84, 85, 86, 102, 110, 111, 121, 122, 140, 146, 152, 170, 173]
>>>>>>>start training : long_term_forecast_DiscoveryPassage_and_others_720_360_96_ff_FEDformer_custom_ftM_sl360_ll48_pl360_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
Chlorophyll (ug/l) Chlorophyll (ug/l)
train 33011
Chlorophyll (ug/l) Chlorophyll (ug/l)
val 4461
Chlorophyll (ug/l) Chlorophyll (ug/l)
test 9278
Parameters: 16.83252
	iters: 100, epoch: 1 | loss: 0.5259867
	speed: 18.5683s/iter; left time: 381039.9073s
	iters: 200, epoch: 1 | loss: 0.4255499
	speed: 18.6216s/iter; left time: 380271.1880s
	iters: 300, epoch: 1 | loss: 0.6322082
	speed: 18.5121s/iter; left time: 376183.7065s
	iters: 400, epoch: 1 | loss: 0.4081861
	speed: 18.6122s/iter; left time: 376356.7164s
	iters: 500, epoch: 1 | loss: 0.4762998
	speed: 16.1146s/iter; left time: 324242.2654s
	iters: 600, epoch: 1 | loss: 0.5164861
	speed: 14.8757s/iter; left time: 297825.6756s
	iters: 700, epoch: 1 | loss: 0.4528233
	speed: 18.7071s/iter; left time: 372663.2492s
	iters: 800, epoch: 1 | loss: 0.3872176
	speed: 18.7741s/iter; left time: 372121.2727s
	iters: 900, epoch: 1 | loss: 0.3782300
	speed: 18.6812s/iter; left time: 368411.7072s
	iters: 1000, epoch: 1 | loss: 0.3096484
	speed: 18.7980s/iter; left time: 368835.6559s
Epoch: 1 cost time: 18615.907879590988
Epoch: 1, Steps: 1031 | Train Loss: 0.4920623 Vali Loss: 0.5725049 Test Loss: 2.5849643
Validation loss decreased (inf --> 0.572505).  Saving model ...
Updating learning rate to 0.0001
Parameters: 16.83252
	iters: 100, epoch: 2 | loss: 0.3013529
	speed: 67.5580s/iter; left time: 1316705.7238s
	iters: 200, epoch: 2 | loss: 0.5839249
	speed: 16.9900s/iter; left time: 329435.7987s
	iters: 300, epoch: 2 | loss: 0.5568775
	speed: 18.8187s/iter; left time: 363012.3967s
	iters: 400, epoch: 2 | loss: 0.6068729
	speed: 18.7942s/iter; left time: 360661.3524s
	iters: 500, epoch: 2 | loss: 0.3988585
	speed: 18.8632s/iter; left time: 360098.3037s
	iters: 600, epoch: 2 | loss: 0.4112579
	speed: 18.7348s/iter; left time: 355773.1305s
	iters: 700, epoch: 2 | loss: 0.5207303
	speed: 18.2357s/iter; left time: 344472.2149s
	iters: 800, epoch: 2 | loss: 0.5716896
	speed: 14.6889s/iter; left time: 276003.8933s
	iters: 900, epoch: 2 | loss: 0.4612651
	speed: 17.5007s/iter; left time: 327088.2324s
	iters: 1000, epoch: 2 | loss: 0.3900166
	speed: 18.7186s/iter; left time: 347977.9989s
Epoch: 2 cost time: 18180.94341301918
Epoch: 2, Steps: 1031 | Train Loss: 0.4678614 Vali Loss: 0.5746560 Test Loss: 2.5793834
EarlyStopping counter: 1 out of 5
Updating learning rate to 5e-05
Parameters: 16.83252
	iters: 100, epoch: 3 | loss: 0.4919833
	speed: 78.5586s/iter; left time: 1450113.7289s
	iters: 200, epoch: 3 | loss: 0.3342130
	speed: 15.9581s/iter; left time: 292975.1443s
	iters: 300, epoch: 3 | loss: 0.5932616
	speed: 15.2858s/iter; left time: 279103.6510s
	iters: 400, epoch: 3 | loss: 0.4643343
	speed: 18.8755s/iter; left time: 342760.5363s
	iters: 500, epoch: 3 | loss: 0.4942737
	speed: 18.8381s/iter; left time: 340196.8226s
	iters: 600, epoch: 3 | loss: 0.7404343
	speed: 18.7728s/iter; left time: 337140.5444s
	iters: 700, epoch: 3 | loss: 0.5905666
	speed: 18.8766s/iter; left time: 337117.0887s
	iters: 800, epoch: 3 | loss: 0.3720284
	speed: 19.0212s/iter; left time: 337797.3684s
	iters: 900, epoch: 3 | loss: 0.5418524
	speed: 15.5611s/iter; left time: 274793.3942s
	iters: 1000, epoch: 3 | loss: 0.3872111
	speed: 15.9377s/iter; left time: 279849.8632s
Epoch: 3 cost time: 18182.837364673615
Epoch: 3, Steps: 1031 | Train Loss: 0.4612573 Vali Loss: 0.5714127 Test Loss: 2.5700400
Validation loss decreased (0.572505 --> 0.571413).  Saving model ...
Updating learning rate to 2.5e-05
Parameters: 16.83252
	iters: 100, epoch: 4 | loss: 0.5268250
	speed: 78.1890s/iter; left time: 1362678.1985s
	iters: 200, epoch: 4 | loss: 0.2928102
	speed: 18.8234s/iter; left time: 326172.7003s
	iters: 300, epoch: 4 | loss: 0.4597836
	speed: 17.8312s/iter; left time: 307196.0746s
	iters: 400, epoch: 4 | loss: 0.4036751
	speed: 14.6359s/iter; left time: 250683.1359s
	iters: 500, epoch: 4 | loss: 0.7650633
	speed: 17.7531s/iter; left time: 302299.6453s
	iters: 600, epoch: 4 | loss: 0.5779473
	speed: 18.8087s/iter; left time: 318393.3777s
	iters: 700, epoch: 4 | loss: 0.4845307
	speed: 18.8285s/iter; left time: 316846.1356s
	iters: 800, epoch: 4 | loss: 0.5285743
	speed: 18.8840s/iter; left time: 315891.8068s
	iters: 900, epoch: 4 | loss: 0.4273594
	speed: 18.9428s/iter; left time: 314980.2796s
	iters: 1000, epoch: 4 | loss: 0.3546358
	speed: 17.5287s/iter; left time: 289715.0786s
Epoch: 4 cost time: 18551.85636329651
Epoch: 4, Steps: 1031 | Train Loss: 0.4583737 Vali Loss: 0.5680657 Test Loss: 2.5703371
Validation loss decreased (0.571413 --> 0.568066).  Saving model ...
Updating learning rate to 1.25e-05
Parameters: 16.83252
	iters: 100, epoch: 5 | loss: 0.5981951
	speed: 60.7888s/iter; left time: 996754.1195s
	iters: 200, epoch: 5 | loss: 0.5270996
	speed: 14.6079s/iter; left time: 238064.1894s
	iters: 300, epoch: 5 | loss: 0.2959887
	speed: 12.6273s/iter; left time: 204524.3304s
	iters: 400, epoch: 5 | loss: 0.4833470
	speed: 12.3409s/iter; left time: 198651.9720s
	iters: 500, epoch: 5 | loss: 0.3814685
	speed: 12.3640s/iter; left time: 197786.1789s
	iters: 600, epoch: 5 | loss: 0.4750731
	speed: 12.3675s/iter; left time: 196606.0176s
	iters: 700, epoch: 5 | loss: 0.6239595
	speed: 12.3200s/iter; left time: 194618.3407s
	iters: 800, epoch: 5 | loss: 0.4202153
	speed: 12.3402s/iter; left time: 193704.2984s
	iters: 900, epoch: 5 | loss: 0.5828567
	speed: 12.3471s/iter; left time: 192577.4484s
	iters: 1000, epoch: 5 | loss: 0.5025212
	speed: 12.3298s/iter; left time: 191074.5018s
Epoch: 5 cost time: 13208.282331943512
Epoch: 5, Steps: 1031 | Train Loss: 0.4572237 Vali Loss: 0.5730764 Test Loss: 2.5785251
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.25e-06
Parameters: 16.83252
	iters: 100, epoch: 6 | loss: 0.3772409
	speed: 51.7984s/iter; left time: 795933.7537s
	iters: 200, epoch: 6 | loss: 0.5160544
	speed: 12.4532s/iter; left time: 190110.2533s
	iters: 300, epoch: 6 | loss: 0.5356849
	speed: 12.4902s/iter; left time: 189426.2281s
	iters: 400, epoch: 6 | loss: 0.3860257
	speed: 12.5202s/iter; left time: 188629.5076s
	iters: 500, epoch: 6 | loss: 0.4070172
	speed: 12.4727s/iter; left time: 186666.1311s
	iters: 600, epoch: 6 | loss: 0.5542574
	speed: 12.5125s/iter; left time: 186010.0904s
	iters: 700, epoch: 6 | loss: 0.5401289
	speed: 12.5214s/iter; left time: 184890.5435s
	iters: 800, epoch: 6 | loss: 0.4818730
	speed: 12.4892s/iter; left time: 183166.4864s
	iters: 900, epoch: 6 | loss: 0.3213162
	speed: 12.5081s/iter; left time: 182193.0212s
	iters: 1000, epoch: 6 | loss: 0.3438498
	speed: 12.5438s/iter; left time: 181458.2544s
Epoch: 6 cost time: 12871.240775823593
Epoch: 6, Steps: 1031 | Train Loss: 0.4567549 Vali Loss: 0.5664407 Test Loss: 2.5796328
Validation loss decreased (0.568066 --> 0.566441).  Saving model ...
Updating learning rate to 3.125e-06
Parameters: 16.83252
	iters: 100, epoch: 7 | loss: 0.4735347
	speed: 53.4022s/iter; left time: 765520.5277s
	iters: 200, epoch: 7 | loss: 0.5151578
	speed: 12.4349s/iter; left time: 177010.4752s
	iters: 300, epoch: 7 | loss: 0.4340321
	speed: 12.5025s/iter; left time: 176722.9667s
	iters: 400, epoch: 7 | loss: 0.5598340
	speed: 12.4859s/iter; left time: 175239.2376s
	iters: 500, epoch: 7 | loss: 0.4592870
	speed: 12.5038s/iter; left time: 174239.8502s
	iters: 600, epoch: 7 | loss: 0.3266037
	speed: 12.4793s/iter; left time: 172650.9815s
	iters: 700, epoch: 7 | loss: 0.5704265
	speed: 12.4469s/iter; left time: 170957.9770s
	iters: 800, epoch: 7 | loss: 0.4441302
	speed: 12.5569s/iter; left time: 171212.9736s
	iters: 900, epoch: 7 | loss: 0.4530315
	speed: 12.4361s/iter; left time: 168323.0052s
	iters: 1000, epoch: 7 | loss: 0.5706560
	speed: 12.4209s/iter; left time: 166874.8535s
Epoch: 7 cost time: 12866.146437644958
Epoch: 7, Steps: 1031 | Train Loss: 0.4557439 Vali Loss: 0.5648067 Test Loss: 2.5754585
Validation loss decreased (0.566441 --> 0.564807).  Saving model ...
Updating learning rate to 1.5625e-06
Parameters: 16.83252
	iters: 100, epoch: 8 | loss: 0.4118218
	speed: 52.9694s/iter; left time: 704704.8573s
	iters: 200, epoch: 8 | loss: 0.4105554
	speed: 12.4551s/iter; left time: 164457.2363s
	iters: 300, epoch: 8 | loss: 0.3599526
	speed: 12.4659s/iter; left time: 163353.7844s
	iters: 400, epoch: 8 | loss: 0.4588045
	speed: 12.5122s/iter; left time: 162708.3257s
	iters: 500, epoch: 8 | loss: 0.3805520
	speed: 12.9906s/iter; left time: 167630.8863s
	iters: 600, epoch: 8 | loss: 0.5466247
	speed: 12.6382s/iter; left time: 161819.0788s
	iters: 700, epoch: 8 | loss: 0.4422183
	speed: 12.7531s/iter; left time: 162015.9960s
	iters: 800, epoch: 8 | loss: 0.5144507
	speed: 12.9907s/iter; left time: 163735.3203s
	iters: 900, epoch: 8 | loss: 0.5117003
	speed: 17.3803s/iter; left time: 217323.7683s
	iters: 1000, epoch: 8 | loss: 0.5888055
	speed: 13.8543s/iter; left time: 171848.2386s
Epoch: 8 cost time: 13656.642163991928
Epoch: 8, Steps: 1031 | Train Loss: 0.4562710 Vali Loss: 0.5670412 Test Loss: 2.5683355
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-07
Parameters: 16.83252
	iters: 100, epoch: 9 | loss: 0.3312391
	speed: 54.2312s/iter; left time: 665579.3009s
	iters: 200, epoch: 9 | loss: 0.5618106
	speed: 12.6638s/iter; left time: 154156.2867s
	iters: 300, epoch: 9 | loss: 0.4120663
	speed: 12.6587s/iter; left time: 152829.0345s
	iters: 400, epoch: 9 | loss: 0.4028278
	speed: 12.6508s/iter; left time: 151468.0650s
	iters: 500, epoch: 9 | loss: 0.4098648
	speed: 12.5883s/iter; left time: 149460.5520s
	iters: 600, epoch: 9 | loss: 0.4597312
	speed: 12.7220s/iter; left time: 149776.5863s
	iters: 700, epoch: 9 | loss: 0.4656910
	speed: 12.7022s/iter; left time: 148273.1856s
	iters: 800, epoch: 9 | loss: 0.3276046
	speed: 12.9830s/iter; left time: 150252.0808s
	iters: 900, epoch: 9 | loss: 0.4634168
	speed: 13.2617s/iter; left time: 152150.9306s
	iters: 1000, epoch: 9 | loss: 0.3300208
	speed: 12.6705s/iter; left time: 144101.6146s
Epoch: 9 cost time: 13151.899373054504
Epoch: 9, Steps: 1031 | Train Loss: 0.4564942 Vali Loss: 0.5668368 Test Loss: 2.5751891
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.90625e-07
Parameters: 16.83252
	iters: 100, epoch: 10 | loss: 0.5845406
	speed: 53.4001s/iter; left time: 600323.3872s
	iters: 200, epoch: 10 | loss: 0.5655220
	speed: 12.5460s/iter; left time: 139787.7299s
	iters: 300, epoch: 10 | loss: 0.3323089
	speed: 12.5027s/iter; left time: 138054.4712s
	iters: 400, epoch: 10 | loss: 0.5584657
	speed: 12.5425s/iter; left time: 137240.4388s
	iters: 500, epoch: 10 | loss: 0.4776474
	speed: 12.5210s/iter; left time: 135752.4535s
	iters: 600, epoch: 10 | loss: 0.2825377
	speed: 12.5133s/iter; left time: 134417.5245s
	iters: 700, epoch: 10 | loss: 0.3116187
	speed: 12.5177s/iter; left time: 133213.1038s
	iters: 800, epoch: 10 | loss: 0.3748123
	speed: 12.5492s/iter; left time: 132294.1229s
	iters: 900, epoch: 10 | loss: 0.5510255
	speed: 12.5316s/iter; left time: 130854.7172s
	iters: 1000, epoch: 10 | loss: 0.3409801
	speed: 12.5632s/iter; left time: 129928.2412s
Epoch: 10 cost time: 12921.287199258804
Epoch: 10, Steps: 1031 | Train Loss: 0.4559974 Vali Loss: 0.5685472 Test Loss: 2.5728481
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.953125e-07
Parameters: 16.83252
	iters: 100, epoch: 11 | loss: 0.4924815
	speed: 53.3726s/iter; left time: 544987.9042s
	iters: 200, epoch: 11 | loss: 0.4758196
	speed: 12.4898s/iter; left time: 126284.3216s
	iters: 300, epoch: 11 | loss: 0.3430403
	speed: 12.5235s/iter; left time: 125372.9442s
	iters: 400, epoch: 11 | loss: 0.4799826
	speed: 12.5099s/iter; left time: 123985.7851s
	iters: 500, epoch: 11 | loss: 0.4748303
	speed: 12.4801s/iter; left time: 122442.4445s
	iters: 600, epoch: 11 | loss: 0.4848645
	speed: 12.5131s/iter; left time: 121515.1127s
	iters: 700, epoch: 11 | loss: 0.5185623
	speed: 12.5261s/iter; left time: 120388.0821s
	iters: 800, epoch: 11 | loss: 0.5086633
	speed: 12.4659s/iter; left time: 118563.1446s
	iters: 900, epoch: 11 | loss: 0.4674443
	speed: 12.4740s/iter; left time: 117392.7575s
	iters: 1000, epoch: 11 | loss: 0.4252858
	speed: 12.5174s/iter; left time: 116549.2207s
Epoch: 11 cost time: 12891.808690547943
Epoch: 11, Steps: 1031 | Train Loss: 0.4554726 Vali Loss: 0.5656787 Test Loss: 2.5668442
EarlyStopping counter: 4 out of 5
Updating learning rate to 9.765625e-08
Parameters: 16.83252
	iters: 100, epoch: 12 | loss: 0.3680252
	speed: 53.3387s/iter; left time: 489649.1969s
	iters: 200, epoch: 12 | loss: 0.3696864
	speed: 12.5154s/iter; left time: 113639.7640s
	iters: 300, epoch: 12 | loss: 0.4517328
	speed: 12.5110s/iter; left time: 112349.1178s
	iters: 400, epoch: 12 | loss: 0.5104517
	speed: 12.4859s/iter; left time: 110874.8475s
	iters: 500, epoch: 12 | loss: 0.4218095
	speed: 12.4931s/iter; left time: 109689.6043s
	iters: 600, epoch: 12 | loss: 0.6249351
	speed: 12.4921s/iter; left time: 108431.7335s
	iters: 700, epoch: 12 | loss: 0.4857887
	speed: 12.5041s/iter; left time: 107285.5302s
	iters: 800, epoch: 12 | loss: 0.3976879
	speed: 12.4799s/iter; left time: 105829.4679s
	iters: 900, epoch: 12 | loss: 0.5023926
	speed: 12.4434s/iter; left time: 104275.4237s
	iters: 1000, epoch: 12 | loss: 0.3124444
	speed: 12.2940s/iter; left time: 101794.7111s
Epoch: 12 cost time: 12859.432485818863
Epoch: 12, Steps: 1031 | Train Loss: 0.4566467 Vali Loss: 0.5672722 Test Loss: 2.5706491
EarlyStopping counter: 5 out of 5
Updating learning rate to 4.8828125e-08
Early stopping
>>>>>>>testing : long_term_forecast_DiscoveryPassage_and_others_720_360_96_ff_FEDformer_custom_ftM_sl360_ll48_pl360_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Chlorophyll (ug/l) Chlorophyll (ug/l)
test 9278
test shape: (9278, 1, 360, 8) (9278, 1, 360, 8)
test shape: (9278, 360, 8) (9278, 360, 8)
mse:2.5801498889923096, mae:0.790854275226593





$ bash ./scripts/DiscoveryPassage_and_others_Script/fedformer.sh
/usr/local/bin/python3
MODEL IMPLEMENTED= FEDformer
PREDICTION LENGTH= 336
SEQUENCE LENGTH= 336
LEARNING RATE ADJUSTMENT= type1
Args in experiment:
Namespace(activation='type1', anomaly_ratio=0.25, batch_size=32, c_out=8, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='DiscoveryPassage_and_others_merged.csv', dec_in=8, des='Exp', devices='0,1,2,3', distil=True, dropout=0.1, e_layers=2, embed='timeF', enc_in=8, factor=3, features='M', freq='h', gpu=0, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='FEDformer', model_id='DiscoveryPassage_and_others_720_360_96_ff', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=336, root_path='./dataset/', seasonal_patterns='Monthly', seq_len=336, target='Chlorophyll (ug/l)', task_name='long_term_forecast', top_k=5, train_epochs=20, use_amp=False, use_gpu=False, use_multi_gpu=False, w_lin=1.0)
Use CPU
fourier enhanced block used!
modes=32, index=[0, 2, 8, 13, 14, 22, 23, 28, 34, 35, 36, 42, 45, 59, 65, 66, 68, 72, 73, 86, 95, 96, 97, 104, 125, 134, 136, 142, 143, 148, 161, 162]
fourier enhanced block used!
modes=32, index=[0, 13, 35, 37, 41, 46, 87, 103, 106, 108, 111, 118, 121, 124, 129, 130, 137, 138, 139, 140, 147, 179, 192, 202, 208, 228, 230, 233, 235, 238, 245, 249]
 fourier enhanced cross attention used!
modes_q=32, index_q=[3, 17, 20, 21, 28, 59, 70, 73, 81, 84, 85, 90, 93, 105, 111, 117, 123, 125, 128, 153, 157, 186, 191, 197, 201, 204, 207, 208, 216, 220, 236, 243]
modes_kv=32, index_kv=[8, 9, 16, 18, 24, 28, 30, 37, 52, 61, 62, 74, 78, 85, 92, 93, 99, 108, 114, 118, 123, 126, 129, 132, 140, 146, 149, 152, 154, 156, 159, 165]
>>>>>>>start training : long_term_forecast_DiscoveryPassage_and_others_720_360_96_ff_FEDformer_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
Chlorophyll (ug/l) Chlorophyll (ug/l)
train 33059
Chlorophyll (ug/l) Chlorophyll (ug/l)
val 4485
Chlorophyll (ug/l) Chlorophyll (ug/l)
test 9302
Parameters: 16.83252
	iters: 100, epoch: 1 | loss: 0.4313208
	speed: 15.4777s/iter; left time: 318237.7805s
	iters: 200, epoch: 1 | loss: 0.3493142
	speed: 15.6016s/iter; left time: 319224.8069s
	iters: 300, epoch: 1 | loss: 0.4551618
	speed: 16.3085s/iter; left time: 332056.8141s
	iters: 400, epoch: 1 | loss: 0.4565388
	speed: 17.3074s/iter; left time: 350665.8271s
	iters: 500, epoch: 1 | loss: 0.5563483
	speed: 16.8990s/iter; left time: 340700.1586s
	iters: 600, epoch: 1 | loss: 0.4190758
	speed: 16.4889s/iter; left time: 330783.5307s
	iters: 700, epoch: 1 | loss: 0.3859227
	speed: 16.6778s/iter; left time: 332904.6740s
	iters: 800, epoch: 1 | loss: 0.4940795
	speed: 16.4163s/iter; left time: 326043.1426s
	iters: 900, epoch: 1 | loss: 0.5667375
	speed: 15.7782s/iter; left time: 311793.5704s
	iters: 1000, epoch: 1 | loss: 0.4247417
	speed: 15.9689s/iter; left time: 313964.3091s
Epoch: 1 cost time: 16835.77251601219
Epoch: 1, Steps: 1033 | Train Loss: 0.4973184 Vali Loss: 0.5662584 Test Loss: 2.5184939
Validation loss decreased (inf --> 0.566258).  Saving model ...
Updating learning rate to 0.0001
Parameters: 16.83252
	iters: 100, epoch: 2 | loss: 0.6251767
	speed: 74.0445s/iter; left time: 1445940.4678s
	iters: 200, epoch: 2 | loss: 0.7865918
	speed: 15.4787s/iter; left time: 300719.7138s
	iters: 300, epoch: 2 | loss: 0.6183678
	speed: 15.5489s/iter; left time: 300528.4359s
	iters: 400, epoch: 2 | loss: 0.4962004
	speed: 15.5198s/iter; left time: 298414.6384s
	iters: 500, epoch: 2 | loss: 0.4757611
	speed: 15.4910s/iter; left time: 296312.0320s
	iters: 600, epoch: 2 | loss: 0.4923239
	speed: 15.4481s/iter; left time: 293947.0190s
	iters: 700, epoch: 2 | loss: 0.4985127
	speed: 15.5818s/iter; left time: 294932.0180s
	iters: 800, epoch: 2 | loss: 0.3421108
	speed: 15.6817s/iter; left time: 295255.4930s
	iters: 900, epoch: 2 | loss: 0.3095863
	speed: 14.8289s/iter; left time: 277715.8797s
	iters: 1000, epoch: 2 | loss: 0.3170292
	speed: 15.3315s/iter; left time: 285595.8197s
Epoch: 2 cost time: 15960.751192569733
Epoch: 2, Steps: 1033 | Train Loss: 0.4719696 Vali Loss: 0.5704830 Test Loss: 2.5308683
EarlyStopping counter: 1 out of 5
Updating learning rate to 5e-05
Parameters: 16.83252
	iters: 100, epoch: 3 | loss: 0.5109883
	speed: 73.4963s/iter; left time: 1359313.2658s
	iters: 200, epoch: 3 | loss: 0.3710851
	speed: 15.4704s/iter; left time: 284578.1736s
	iters: 300, epoch: 3 | loss: 0.5567878
	speed: 15.5327s/iter; left time: 284171.0879s
	iters: 400, epoch: 3 | loss: 0.4239039
	speed: 15.4610s/iter; left time: 281313.0973s
	iters: 500, epoch: 3 | loss: 0.4368689
	speed: 15.7437s/iter; left time: 284883.1114s
	iters: 600, epoch: 3 | loss: 0.4104552
	speed: 15.3364s/iter; left time: 275977.6986s
	iters: 700, epoch: 3 | loss: 0.4406484
	speed: 15.0918s/iter; left time: 270067.7643s
	iters: 800, epoch: 3 | loss: 0.4109930
	speed: 15.4823s/iter; left time: 275508.0224s
	iters: 900, epoch: 3 | loss: 0.4734519
	speed: 15.5502s/iter; left time: 275160.3993s
	iters: 1000, epoch: 3 | loss: 0.3733827
	speed: 15.6263s/iter; left time: 274944.8233s
Epoch: 3 cost time: 15990.070190429688
Epoch: 3, Steps: 1033 | Train Loss: 0.4650448 Vali Loss: 0.5627218 Test Loss: 2.5131030
Validation loss decreased (0.566258 --> 0.562722).  Saving model ...
Updating learning rate to 2.5e-05
Parameters: 16.83252
	iters: 100, epoch: 4 | loss: 0.4500783
	speed: 73.4442s/iter; left time: 1282481.9866s
	iters: 200, epoch: 4 | loss: 0.3900956
	speed: 15.6698s/iter; left time: 272058.9460s
	iters: 300, epoch: 4 | loss: 0.5528118
	speed: 15.7970s/iter; left time: 272688.2955s
	iters: 400, epoch: 4 | loss: 0.4924562
	speed: 15.0590s/iter; left time: 258441.7103s
	iters: 500, epoch: 4 | loss: 0.2591019
	speed: 15.4180s/iter; left time: 263061.7442s
	iters: 600, epoch: 4 | loss: 0.3632241
	speed: 15.5993s/iter; left time: 264595.8132s
	iters: 700, epoch: 4 | loss: 0.5070452
	speed: 15.4848s/iter; left time: 261105.0168s
	iters: 800, epoch: 4 | loss: 0.5759966
	speed: 15.4811s/iter; left time: 259493.5566s
	iters: 900, epoch: 4 | loss: 0.4167531
	speed: 15.3844s/iter; left time: 256334.6312s
	iters: 1000, epoch: 4 | loss: 0.6257809
	speed: 15.5922s/iter; left time: 258238.0544s
Epoch: 4 cost time: 16017.77143907547
Epoch: 4, Steps: 1033 | Train Loss: 0.4623783 Vali Loss: 0.5675399 Test Loss: 2.5135469
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.25e-05
Parameters: 16.83252
	iters: 100, epoch: 5 | loss: 0.2730650
	speed: 73.7177s/iter; left time: 1211107.4919s
	iters: 200, epoch: 5 | loss: 0.5131013
	speed: 15.1570s/iter; left time: 247498.8496s
	iters: 300, epoch: 5 | loss: 0.5469686
	speed: 15.7144s/iter; left time: 255029.0858s
	iters: 400, epoch: 5 | loss: 0.4097582
	speed: 15.6184s/iter; left time: 251909.7072s
	iters: 500, epoch: 5 | loss: 0.4058253
	speed: 15.5765s/iter; left time: 249676.1585s
	iters: 600, epoch: 5 | loss: 0.3987922
	speed: 15.5216s/iter; left time: 247243.4114s
	iters: 700, epoch: 5 | loss: 0.4172188
	speed: 15.6056s/iter; left time: 247021.5680s
	iters: 800, epoch: 5 | loss: 0.4849856
	speed: 15.6962s/iter; left time: 246885.4977s
	iters: 900, epoch: 5 | loss: 0.4550006
	speed: 15.5300s/iter; left time: 242717.7020s
	iters: 1000, epoch: 5 | loss: 0.4742075
	speed: 15.6584s/iter; left time: 243159.6969s
Epoch: 5 cost time: 16048.038342475891
Epoch: 5, Steps: 1033 | Train Loss: 0.4611584 Vali Loss: 0.5660827 Test Loss: 2.5140159
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.25e-06
Parameters: 16.83252
	iters: 100, epoch: 6 | loss: 0.4725094
	speed: 73.4046s/iter; left time: 1130137.4193s
	iters: 200, epoch: 6 | loss: 0.3760507
	speed: 15.5353s/iter; left time: 237627.3475s
	iters: 300, epoch: 6 | loss: 0.3781216
	speed: 15.5419s/iter; left time: 236174.0164s
	iters: 400, epoch: 6 | loss: 0.5001748
	speed: 15.4782s/iter; left time: 233658.8691s
	iters: 500, epoch: 6 | loss: 0.4650948
	speed: 15.5307s/iter; left time: 232898.5688s
	iters: 600, epoch: 6 | loss: 0.5470307
	speed: 15.5752s/iter; left time: 232007.8171s
	iters: 700, epoch: 6 | loss: 0.4284447
	speed: 15.5231s/iter; left time: 229679.1885s
	iters: 800, epoch: 6 | loss: 0.6868163
	speed: 15.5661s/iter; left time: 228759.1758s
	iters: 900, epoch: 6 | loss: 0.4013428
	speed: 15.6563s/iter; left time: 228518.6885s
	iters: 1000, epoch: 6 | loss: 0.5045298
	speed: 15.4521s/iter; left time: 223994.3148s
Epoch: 6 cost time: 16039.601009368896
Epoch: 6, Steps: 1033 | Train Loss: 0.4607994 Vali Loss: 0.5651514 Test Loss: 2.5186906
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.125e-06
Parameters: 16.83252
	iters: 100, epoch: 7 | loss: 0.4389072
	speed: 55.2507s/iter; left time: 793566.1837s
	iters: 200, epoch: 7 | loss: 0.5204256
	speed: 9.8119s/iter; left time: 139947.3096s
	iters: 300, epoch: 7 | loss: 0.3107323
	speed: 9.8426s/iter; left time: 139400.5013s
	iters: 400, epoch: 7 | loss: 0.5758302
	speed: 9.7776s/iter; left time: 137502.8468s
	iters: 500, epoch: 7 | loss: 0.5076072
	speed: 9.8009s/iter; left time: 136850.2098s
	iters: 600, epoch: 7 | loss: 0.5530725
	speed: 9.8557s/iter; left time: 136630.2361s
	iters: 700, epoch: 7 | loss: 0.4926229
	speed: 9.8382s/iter; left time: 135403.5417s
	iters: 800, epoch: 7 | loss: 0.5804032
	speed: 9.8286s/iter; left time: 134288.4067s
	iters: 900, epoch: 7 | loss: 0.6786501
	speed: 9.8254s/iter; left time: 133262.4374s
	iters: 1000, epoch: 7 | loss: 0.7207226
	speed: 9.8243s/iter; left time: 132264.4384s
Epoch: 7 cost time: 10144.140225172043
Epoch: 7, Steps: 1033 | Train Loss: 0.4598937 Vali Loss: 0.5651988 Test Loss: 2.5236304
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.5625e-06
Parameters: 16.83252
	iters: 100, epoch: 8 | loss: 0.5327094
	speed: 43.5429s/iter; left time: 580426.2940s
	iters: 200, epoch: 8 | loss: 0.4469754
	speed: 9.7654s/iter; left time: 129195.8916s
	iters: 300, epoch: 8 | loss: 0.6650032
	speed: 9.7879s/iter; left time: 128514.7663s
	iters: 400, epoch: 8 | loss: 0.3650821
	speed: 9.8393s/iter; left time: 128205.9984s
	iters: 500, epoch: 8 | loss: 0.4804238
	speed: 9.8130s/iter; left time: 126882.6590s
	iters: 600, epoch: 8 | loss: 0.5985790
	speed: 9.8032s/iter; left time: 125775.2272s
	iters: 700, epoch: 8 | loss: 0.3520635
	speed: 9.8171s/iter; left time: 124971.9417s
	iters: 800, epoch: 8 | loss: 0.5099994
	speed: 9.8192s/iter; left time: 124016.7880s
	iters: 900, epoch: 8 | loss: 0.4135699
	speed: 9.8307s/iter; left time: 123178.4651s
	iters: 1000, epoch: 8 | loss: 0.5902427
	speed: 9.8580s/iter; left time: 122535.0262s
Epoch: 8 cost time: 10139.634589910507
Epoch: 8, Steps: 1033 | Train Loss: 0.4604097 Vali Loss: 0.5624915 Test Loss: 2.5163469
Validation loss decreased (0.562722 --> 0.562492).  Saving model ...
Updating learning rate to 7.8125e-07
Parameters: 16.83252
	iters: 100, epoch: 9 | loss: 0.4522119
	speed: 43.6227s/iter; left time: 536427.8360s
	iters: 200, epoch: 9 | loss: 0.4682456
	speed: 9.7860s/iter; left time: 119360.0614s
	iters: 300, epoch: 9 | loss: 0.5709870
	speed: 9.7990s/iter; left time: 118538.7044s
	iters: 400, epoch: 9 | loss: 0.3942876
	speed: 9.8075s/iter; left time: 117660.8639s
	iters: 500, epoch: 9 | loss: 0.4520496
	speed: 9.7745s/iter; left time: 116286.7670s
	iters: 600, epoch: 9 | loss: 0.4250915
	speed: 9.8237s/iter; left time: 115890.6211s
	iters: 700, epoch: 9 | loss: 0.3778600
	speed: 9.7911s/iter; left time: 114526.0916s
	iters: 800, epoch: 9 | loss: 0.9208378
	speed: 9.8050s/iter; left time: 113709.0002s
	iters: 900, epoch: 9 | loss: 0.5170584
	speed: 9.8044s/iter; left time: 112720.6679s
	iters: 1000, epoch: 9 | loss: 0.3034958
	speed: 9.8261s/iter; left time: 111988.1992s
Epoch: 9 cost time: 10128.46706199646
Epoch: 9, Steps: 1033 | Train Loss: 0.4601476 Vali Loss: 0.5648482 Test Loss: 2.5163112
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.90625e-07
Parameters: 16.83252
	iters: 100, epoch: 10 | loss: 0.3894312
	speed: 43.3354s/iter; left time: 488129.7757s
	iters: 200, epoch: 10 | loss: 0.5581720
	speed: 9.7923s/iter; left time: 109321.3196s
	iters: 300, epoch: 10 | loss: 0.4041163
	speed: 9.8975s/iter; left time: 109505.9696s
	iters: 400, epoch: 10 | loss: 0.4881512
	speed: 10.2827s/iter; left time: 112739.4293s
	iters: 500, epoch: 10 | loss: 0.5179455
	speed: 10.2584s/iter; left time: 111446.8294s
	iters: 600, epoch: 10 | loss: 0.3769518
	speed: 9.9784s/iter; left time: 107407.6186s
	iters: 700, epoch: 10 | loss: 0.5371035
	speed: 9.9047s/iter; left time: 105623.4619s
	iters: 800, epoch: 10 | loss: 0.3984390
	speed: 10.2566s/iter; left time: 108351.1406s
	iters: 900, epoch: 10 | loss: 0.3961918
	speed: 10.5388s/iter; left time: 110278.5034s
	iters: 1000, epoch: 10 | loss: 0.3388050
	speed: 10.6263s/iter; left time: 110130.7510s
Epoch: 10 cost time: 10481.605490922928
Epoch: 10, Steps: 1033 | Train Loss: 0.4591762 Vali Loss: 0.5648467 Test Loss: 2.5164011
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.953125e-07
Parameters: 16.83252
	iters: 100, epoch: 11 | loss: 0.4135607
	speed: 45.3929s/iter; left time: 464414.9895s
	iters: 200, epoch: 11 | loss: 0.4100691
	speed: 10.3147s/iter; left time: 104498.1628s
	iters: 300, epoch: 11 | loss: 0.5037183
	speed: 10.6057s/iter; left time: 106385.6315s
	iters: 400, epoch: 11 | loss: 0.5340712
	speed: 11.4957s/iter; left time: 114163.3289s
	iters: 500, epoch: 11 | loss: 0.4869442
	speed: 13.4066s/iter; left time: 131800.5114s
	iters: 600, epoch: 11 | loss: 0.4780377
	speed: 10.7420s/iter; left time: 104530.2072s
	iters: 700, epoch: 11 | loss: 0.2775827
	speed: 10.4595s/iter; left time: 100735.9147s
	iters: 800, epoch: 11 | loss: 0.3399679
	speed: 10.8905s/iter; left time: 103797.6645s
	iters: 900, epoch: 11 | loss: 0.3186848
	speed: 10.8030s/iter; left time: 101883.2497s
	iters: 1000, epoch: 11 | loss: 0.5045478
	speed: 10.8164s/iter; left time: 100928.1728s
Epoch: 11 cost time: 11368.078736305237
Epoch: 11, Steps: 1033 | Train Loss: 0.4601429 Vali Loss: 0.5632094 Test Loss: 2.5155900
EarlyStopping counter: 3 out of 5
Updating learning rate to 9.765625e-08
Parameters: 16.83252
	iters: 100, epoch: 12 | loss: 0.5311536
	speed: 44.7179s/iter; left time: 411315.4226s
	iters: 200, epoch: 12 | loss: 0.5143639
	speed: 9.8909s/iter; left time: 89987.8123s
	iters: 300, epoch: 12 | loss: 0.4969262
	speed: 9.8783s/iter; left time: 88885.2272s
	iters: 400, epoch: 12 | loss: 0.6648527
	speed: 9.8937s/iter; left time: 88033.9784s
	iters: 500, epoch: 12 | loss: 0.6096797
	speed: 9.8943s/iter; left time: 87050.2274s
	iters: 600, epoch: 12 | loss: 0.5906594
	speed: 9.8238s/iter; left time: 85446.9953s
	iters: 700, epoch: 12 | loss: 0.4058889
	speed: 9.8428s/iter; left time: 84628.4947s
	iters: 800, epoch: 12 | loss: 0.6566205
	speed: 9.8835s/iter; left time: 83990.0059s
	iters: 900, epoch: 12 | loss: 0.2736254
	speed: 9.8541s/iter; left time: 82754.7838s
	iters: 1000, epoch: 12 | loss: 0.4099625
	speed: 9.8884s/iter; left time: 82053.9757s
Epoch: 12 cost time: 10199.736733436584
Epoch: 12, Steps: 1033 | Train Loss: 0.4596653 Vali Loss: 0.5634959 Test Loss: 2.5217712
EarlyStopping counter: 4 out of 5
Updating learning rate to 4.8828125e-08
Parameters: 16.83252
	iters: 100, epoch: 13 | loss: 0.5509247
	speed: 43.6789s/iter; left time: 356638.3054s
	iters: 200, epoch: 13 | loss: 0.4426839
	speed: 9.8433s/iter; left time: 79386.1876s
	iters: 300, epoch: 13 | loss: 0.4215506
	speed: 9.8417s/iter; left time: 78389.4105s
	iters: 400, epoch: 13 | loss: 0.4048556
	speed: 9.8564s/iter; left time: 77520.3560s
	iters: 500, epoch: 13 | loss: 0.6112912
	speed: 9.8218s/iter; left time: 76266.1284s
	iters: 600, epoch: 13 | loss: 0.3715136
	speed: 9.8503s/iter; left time: 75502.2393s
	iters: 700, epoch: 13 | loss: 0.4962188
	speed: 9.8455s/iter; left time: 74480.8632s
	iters: 800, epoch: 13 | loss: 0.5253296
	speed: 9.8695s/iter; left time: 73675.7594s
	iters: 900, epoch: 13 | loss: 0.4970677
	speed: 9.8468s/iter; left time: 72522.0199s
	iters: 1000, epoch: 13 | loss: 0.4614889
	speed: 9.8777s/iter; left time: 71761.6293s
Epoch: 13 cost time: 10178.290926456451
Epoch: 13, Steps: 1033 | Train Loss: 0.4600946 Vali Loss: 0.5641848 Test Loss: 2.5124795
EarlyStopping counter: 5 out of 5
Updating learning rate to 2.44140625e-08
Early stopping
>>>>>>>testing : long_term_forecast_DiscoveryPassage_and_others_720_360_96_ff_FEDformer_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Chlorophyll (ug/l) Chlorophyll (ug/l)
test 9302
test shape: (9302, 1, 336, 8) (9302, 1, 336, 8)
test shape: (9302, 336, 8) (9302, 336, 8)
mse:2.5151054859161377, mae:0.7779150605201721




doug@V2K-Chinmay:~/Desktop/Experiments/src/fusst$ bash ./scripts/DiscoveryPassage_and_others_Script/fedformer.sh
/usr/local/bin/python3
MODEL IMPLEMENTED= FEDformer
PREDICTION LENGTH= 192
SEQUENCE LENGTH= 192
LEARNING RATE ADJUSTMENT= type1
Args in experiment:
Namespace(activation='type1', anomaly_ratio=0.25, batch_size=32, c_out=8, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='DiscoveryPassage_and_others_merged.csv', dec_in=8, des='Exp', devices='0,1,2,3', distil=True, dropout=0.1, e_layers=2, embed='timeF', enc_in=8, factor=3, features='M', freq='h', gpu=0, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='FEDformer', model_id='DiscoveryPassage_and_others_720_360_96_ff', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=192, root_path='./dataset/', seasonal_patterns='Monthly', seq_len=192, target='Chlorophyll (ug/l)', task_name='long_term_forecast', top_k=5, train_epochs=20, use_amp=False, use_gpu=False, use_multi_gpu=False, w_lin=1.0)
Use CPU
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 43, 53, 55, 56, 58, 59, 64, 69, 71, 74, 75, 78, 79, 81, 84, 87, 89, 93]
fourier enhanced block used!
modes=32, index=[0, 1, 5, 8, 9, 13, 15, 22, 28, 37, 48, 56, 60, 61, 62, 63, 82, 84, 88, 93, 96, 97, 98, 114, 115, 118, 124, 125, 130, 135, 136, 141]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 4, 10, 11, 15, 24, 29, 34, 35, 37, 43, 45, 46, 58, 66, 71, 77, 83, 85, 92, 96, 103, 104, 106, 107, 112, 113, 117, 119, 129, 139, 142]
modes_kv=32, index_kv=[2, 3, 16, 17, 20, 21, 24, 26, 27, 30, 31, 34, 38, 43, 45, 46, 51, 58, 62, 64, 65, 68, 69, 72, 75, 78, 81, 83, 84, 85, 86, 87]
>>>>>>>start training : long_term_forecast_DiscoveryPassage_and_others_720_360_96_ff_FEDformer_custom_ftM_sl192_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
Chlorophyll (ug/l) Chlorophyll (ug/l)
train 33347
Chlorophyll (ug/l) Chlorophyll (ug/l)
val 4629
Chlorophyll (ug/l) Chlorophyll (ug/l)
test 9446
Parameters: 16.83252
	iters: 100, epoch: 1 | loss: 0.5134106
	speed: 10.2650s/iter; left time: 212906.5472s
	iters: 200, epoch: 1 | loss: 0.4611588
	speed: 10.5712s/iter; left time: 218201.1258s
	iters: 300, epoch: 1 | loss: 0.4039389
	speed: 10.5068s/iter; left time: 215819.8737s
	iters: 400, epoch: 1 | loss: 0.3029341
	speed: 10.4210s/iter; left time: 213014.8291s
	iters: 500, epoch: 1 | loss: 0.5815606
	speed: 10.5490s/iter; left time: 214576.7040s
	iters: 600, epoch: 1 | loss: 0.5743515
	speed: 10.4379s/iter; left time: 211273.2433s
	iters: 700, epoch: 1 | loss: 0.3986643
	speed: 10.4840s/iter; left time: 211158.8584s
	iters: 800, epoch: 1 | loss: 0.3721118
	speed: 10.3433s/iter; left time: 207289.3510s
	iters: 900, epoch: 1 | loss: 0.2459684
	speed: 10.3990s/iter; left time: 207365.7636s
	iters: 1000, epoch: 1 | loss: 0.4905360
	speed: 9.5436s/iter; left time: 189354.9615s
Epoch: 1 cost time: 10787.381742477417
Epoch: 1, Steps: 1042 | Train Loss: 0.4784543 Vali Loss: 0.5044124 Test Loss: 2.2152355
Validation loss decreased (inf --> 0.504412).  Saving model ...
Updating learning rate to 0.0001
Parameters: 16.83252
	iters: 100, epoch: 2 | loss: 0.5541698
	speed: 63.0758s/iter; left time: 1242530.4316s
	iters: 200, epoch: 2 | loss: 0.4388792
	speed: 10.3364s/iter; left time: 202582.4245s
	iters: 300, epoch: 2 | loss: 0.3232671
	speed: 10.4552s/iter; left time: 203866.7241s
	iters: 400, epoch: 2 | loss: 0.4428253
	speed: 9.7618s/iter; left time: 189368.4009s
	iters: 500, epoch: 2 | loss: 0.3241906
	speed: 9.9236s/iter; left time: 191515.1718s
	iters: 600, epoch: 2 | loss: 0.4294332
	speed: 10.3836s/iter; left time: 199353.7930s
	iters: 700, epoch: 2 | loss: 0.3554240
	speed: 10.3418s/iter; left time: 197517.8905s
	iters: 800, epoch: 2 | loss: 0.5206338
	speed: 10.3884s/iter; left time: 197369.8474s
	iters: 900, epoch: 2 | loss: 0.4521022
	speed: 10.3312s/iter; left time: 195248.5378s
	iters: 1000, epoch: 2 | loss: 0.4063310
	speed: 10.3336s/iter; left time: 194261.2143s
Epoch: 2 cost time: 10696.671263217926
Epoch: 2, Steps: 1042 | Train Loss: 0.4504442 Vali Loss: 0.4970835 Test Loss: 2.2148328
Validation loss decreased (0.504412 --> 0.497084).  Saving model ...
Updating learning rate to 5e-05
Parameters: 16.83252
	iters: 100, epoch: 3 | loss: 0.3908049
	speed: 62.7168s/iter; left time: 1170107.9643s
	iters: 200, epoch: 3 | loss: 0.3264904
	speed: 10.3034s/iter; left time: 191200.0663s
	iters: 300, epoch: 3 | loss: 0.6559327
	speed: 10.3378s/iter; left time: 190804.6835s
	iters: 400, epoch: 3 | loss: 0.5048766
	speed: 10.3779s/iter; left time: 190506.9210s
	iters: 500, epoch: 3 | loss: 0.4865355
	speed: 10.3419s/iter; left time: 188811.6770s
	iters: 600, epoch: 3 | loss: 0.3853798
	speed: 10.4083s/iter; left time: 188983.5205s
	iters: 700, epoch: 3 | loss: 0.5700559
	speed: 10.3837s/iter; left time: 187498.8209s
	iters: 800, epoch: 3 | loss: 0.3363517
	speed: 10.4181s/iter; left time: 187078.1361s
	iters: 900, epoch: 3 | loss: 0.3889678
	speed: 9.5371s/iter; left time: 170303.4248s
	iters: 1000, epoch: 3 | loss: 0.5477957
	speed: 10.2353s/iter; left time: 181748.8693s
Epoch: 3 cost time: 10709.79919719696
Epoch: 3, Steps: 1042 | Train Loss: 0.4423821 Vali Loss: 0.4974731 Test Loss: 2.2128947
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.5e-05
Parameters: 16.83252
	iters: 100, epoch: 4 | loss: 0.3882251
	speed: 63.3121s/iter; left time: 1115243.2267s
	iters: 200, epoch: 4 | loss: 0.5047956
	speed: 10.5089s/iter; left time: 184063.8400s
	iters: 300, epoch: 4 | loss: 0.3999463
	speed: 9.8067s/iter; left time: 170783.0183s
	iters: 400, epoch: 4 | loss: 0.3199495
	speed: 9.8874s/iter; left time: 171200.0620s
	iters: 500, epoch: 4 | loss: 0.5032952
	speed: 10.3300s/iter; left time: 177830.4387s
	iters: 600, epoch: 4 | loss: 0.5596921
	speed: 10.3092s/iter; left time: 176442.5463s
	iters: 700, epoch: 4 | loss: 0.3859678
	speed: 10.3654s/iter; left time: 176368.0766s
	iters: 800, epoch: 4 | loss: 0.4380179
	speed: 10.3519s/iter; left time: 175102.6142s
	iters: 900, epoch: 4 | loss: 0.4917130
	speed: 10.3496s/iter; left time: 174029.0745s
	iters: 1000, epoch: 4 | loss: 0.5838383
	speed: 10.3524s/iter; left time: 173040.8005s
Epoch: 4 cost time: 10696.353917360306
Epoch: 4, Steps: 1042 | Train Loss: 0.4389737 Vali Loss: 0.4974380 Test Loss: 2.2043371
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.25e-05
Parameters: 16.83252
	iters: 100, epoch: 5 | loss: 0.4662453
	speed: 55.9112s/iter; left time: 926616.1025s
	iters: 200, epoch: 5 | loss: 0.4530907
	speed: 6.4888s/iter; left time: 106889.7512s
	iters: 300, epoch: 5 | loss: 0.4192317
	speed: 6.5103s/iter; left time: 106592.3604s
	iters: 400, epoch: 5 | loss: 0.4039343
	speed: 6.5051s/iter; left time: 105856.9083s
	iters: 500, epoch: 5 | loss: 0.4214994
	speed: 6.4849s/iter; left time: 104880.3319s
	iters: 600, epoch: 5 | loss: 0.4857430
	speed: 6.4998s/iter; left time: 104472.0704s
	iters: 700, epoch: 5 | loss: 0.3306144
	speed: 6.4909s/iter; left time: 103679.1506s
	iters: 800, epoch: 5 | loss: 0.4969329
	speed: 6.5012s/iter; left time: 103193.1497s
	iters: 900, epoch: 5 | loss: 0.3102642
	speed: 6.4870s/iter; left time: 102318.8204s
	iters: 1000, epoch: 5 | loss: 0.5102202
	speed: 6.5174s/iter; left time: 102147.2471s
Epoch: 5 cost time: 6772.8633325099945
Epoch: 5, Steps: 1042 | Train Loss: 0.4372093 Vali Loss: 0.4900451 Test Loss: 2.2133760
Validation loss decreased (0.497084 --> 0.490045).  Saving model ...
Updating learning rate to 6.25e-06
Parameters: 16.83252
	iters: 100, epoch: 6 | loss: 0.3572471
	speed: 37.6073s/iter; left time: 584079.6451s
	iters: 200, epoch: 6 | loss: 0.2169110
	speed: 6.5059s/iter; left time: 100391.8021s
	iters: 300, epoch: 6 | loss: 0.7539422
	speed: 6.5172s/iter; left time: 99914.9101s
	iters: 400, epoch: 6 | loss: 0.2737644
	speed: 6.5013s/iter; left time: 99020.7743s
	iters: 500, epoch: 6 | loss: 0.5524483
	speed: 6.5248s/iter; left time: 98726.6663s
	iters: 600, epoch: 6 | loss: 0.3802887
	speed: 6.5462s/iter; left time: 98395.6011s
	iters: 700, epoch: 6 | loss: 0.4881639
	speed: 6.5039s/iter; left time: 97110.4589s
	iters: 800, epoch: 6 | loss: 0.3638134
	speed: 6.5035s/iter; left time: 96453.9821s
	iters: 900, epoch: 6 | loss: 0.4511167
	speed: 6.5200s/iter; left time: 96045.8314s
	iters: 1000, epoch: 6 | loss: 0.3668756
	speed: 6.5289s/iter; left time: 95524.5829s
Epoch: 6 cost time: 6794.0116102695465
Epoch: 6, Steps: 1042 | Train Loss: 0.4368926 Vali Loss: 0.4941722 Test Loss: 2.2100613
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.125e-06
Parameters: 16.83252
	iters: 100, epoch: 7 | loss: 0.5561462
	speed: 37.7616s/iter; left time: 547128.5198s
	iters: 200, epoch: 7 | loss: 0.3947135
	speed: 6.5338s/iter; left time: 94015.3100s
	iters: 300, epoch: 7 | loss: 0.3245839
	speed: 6.5105s/iter; left time: 93028.3073s
	iters: 400, epoch: 7 | loss: 0.5736244
	speed: 6.5264s/iter; left time: 92602.8814s
	iters: 500, epoch: 7 | loss: 0.3979722
	speed: 6.5373s/iter; left time: 92104.1055s
	iters: 600, epoch: 7 | loss: 0.3797030
	speed: 6.5093s/iter; left time: 91058.1367s
	iters: 700, epoch: 7 | loss: 0.4525565
	speed: 6.5155s/iter; left time: 90494.4074s
	iters: 800, epoch: 7 | loss: 0.5630279
	speed: 6.5132s/iter; left time: 89811.1534s
	iters: 900, epoch: 7 | loss: 0.5337092
	speed: 6.5129s/iter; left time: 89155.3808s
	iters: 1000, epoch: 7 | loss: 0.5045918
	speed: 6.5243s/iter; left time: 88658.5115s
Epoch: 7 cost time: 6795.156710386276
Epoch: 7, Steps: 1042 | Train Loss: 0.4363211 Vali Loss: 0.4945058 Test Loss: 2.2117770
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.5625e-06
Parameters: 16.83252
	iters: 100, epoch: 8 | loss: 0.5467682
	speed: 37.8112s/iter; left time: 508447.0824s
	iters: 200, epoch: 8 | loss: 0.4627577
	speed: 6.5252s/iter; left time: 87091.8267s
	iters: 300, epoch: 8 | loss: 0.2819255
	speed: 6.5104s/iter; left time: 86243.3870s
	iters: 400, epoch: 8 | loss: 0.3635274
	speed: 6.5059s/iter; left time: 85532.9273s
	iters: 500, epoch: 8 | loss: 0.4688817
	speed: 6.5085s/iter; left time: 84916.9979s
	iters: 600, epoch: 8 | loss: 0.4291829
	speed: 6.5131s/iter; left time: 84325.4344s
	iters: 700, epoch: 8 | loss: 0.5038680
	speed: 6.5119s/iter; left time: 83658.9434s
	iters: 800, epoch: 8 | loss: 0.4485860
	speed: 6.5051s/iter; left time: 82920.3803s
	iters: 900, epoch: 8 | loss: 0.4417757
	speed: 6.5139s/iter; left time: 82381.2027s
	iters: 1000, epoch: 8 | loss: 0.2790080
	speed: 6.5073s/iter; left time: 81646.7169s
Epoch: 8 cost time: 6785.446606874466
Epoch: 8, Steps: 1042 | Train Loss: 0.4358584 Vali Loss: 0.4939169 Test Loss: 2.2093749
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.8125e-07
Parameters: 16.83252
	iters: 100, epoch: 9 | loss: 0.2142399
	speed: 37.8754s/iter; left time: 469844.3181s
	iters: 200, epoch: 9 | loss: 0.3723555
	speed: 6.5247s/iter; left time: 80286.0737s
	iters: 300, epoch: 9 | loss: 0.3933423
	speed: 6.5214s/iter; left time: 79593.4804s
	iters: 400, epoch: 9 | loss: 0.4583490
	speed: 6.5094s/iter; left time: 78795.9591s
	iters: 500, epoch: 9 | loss: 0.5243273
	speed: 6.5212s/iter; left time: 78287.2383s
	iters: 600, epoch: 9 | loss: 0.4391545
	speed: 6.5354s/iter; left time: 77804.2667s
	iters: 700, epoch: 9 | loss: 0.3867242
	speed: 6.5338s/iter; left time: 77131.5099s
	iters: 800, epoch: 9 | loss: 0.3744364
	speed: 6.5384s/iter; left time: 76532.2354s
	iters: 900, epoch: 9 | loss: 0.4546472
	speed: 6.5108s/iter; left time: 75557.5389s
	iters: 1000, epoch: 9 | loss: 0.4260545
	speed: 6.5150s/iter; left time: 74955.1798s
Epoch: 9 cost time: 6795.802342414856
Epoch: 9, Steps: 1042 | Train Loss: 0.4354513 Vali Loss: 0.4965846 Test Loss: 2.2012320
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.90625e-07
Parameters: 16.83252
	iters: 100, epoch: 10 | loss: 0.3512850
	speed: 37.7137s/iter; left time: 428541.0467s
	iters: 200, epoch: 10 | loss: 0.4829668
	speed: 6.5139s/iter; left time: 73366.3196s
	iters: 300, epoch: 10 | loss: 0.5600984
	speed: 6.4887s/iter; left time: 72432.8320s
	iters: 400, epoch: 10 | loss: 0.3877550
	speed: 6.5005s/iter; left time: 71915.4742s
	iters: 500, epoch: 10 | loss: 0.5477760
	speed: 6.5031s/iter; left time: 71293.0627s
	iters: 600, epoch: 10 | loss: 0.4321058
	speed: 6.4949s/iter; left time: 70554.1969s
	iters: 700, epoch: 10 | loss: 0.5197687
	speed: 6.5099s/iter; left time: 70066.0780s
	iters: 800, epoch: 10 | loss: 0.4085732
	speed: 6.4916s/iter; left time: 69219.6560s
	iters: 900, epoch: 10 | loss: 0.5084388
	speed: 6.5109s/iter; left time: 68774.2883s
	iters: 1000, epoch: 10 | loss: 0.3847853
	speed: 6.5075s/iter; left time: 68087.5753s
Epoch: 10 cost time: 6777.474443912506
Epoch: 10, Steps: 1042 | Train Loss: 0.4349594 Vali Loss: 0.4923207 Test Loss: 2.2147775
EarlyStopping counter: 5 out of 5
Updating learning rate to 1.953125e-07
Early stopping
>>>>>>>testing : long_term_forecast_DiscoveryPassage_and_others_720_360_96_ff_FEDformer_custom_ftM_sl192_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Chlorophyll (ug/l) Chlorophyll (ug/l)
test 9446
test shape: (9446, 1, 192, 8) (9446, 1, 192, 8)
test shape: (9446, 192, 8) (9446, 192, 8)
mse:2.2083051204681396, mae:0.7317196726799011





MODEL IMPLEMENTED= FedFormer
PREDICTION LENGTH= 96
SEQUENCE LENGTH= 96
LEARNING RATE ADJUSTMENT= type1




bash ./scripts/DiscoveryPassage_and_others_Script/fedformer.sh
Args in experiment:
Namespace(activation='type1', anomaly_ratio=0.25, batch_size=32, c_out=8, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='DiscoveryPassage_and_others_merged.csv', dec_in=8, des='Exp', devices='0,1,2,3', distil=True, dropout=0.1, e_layers=2, embed='timeF', enc_in=8, factor=3, features='M', freq='h', gpu=0, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='FEDformer', model_id='DiscoveryPassage_and_others_720_360_96_ff', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=96, root_path='./dataset/', seasonal_patterns='Monthly', seq_len=96, target='Chlorophyll (ug/l)', task_name='long_term_forecast', top_k=5, train_epochs=20, use_amp=False, use_gpu=False, use_multi_gpu=False, w_lin=1.0)
Use CPU
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 35, 37, 38, 39, 40, 42, 43, 44, 46]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 8, 10, 12, 13, 14, 16, 21, 22, 24, 26, 28, 29, 30, 34, 35, 37, 38, 42, 43, 45, 47, 56, 57, 58, 65, 70, 71]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 8, 13, 14, 16, 17, 18, 19, 21, 22, 24, 28, 29, 33, 37, 40, 42, 43, 44, 47, 48, 50, 51, 53, 55, 56, 58, 60, 62, 63, 68, 69]
modes_kv=32, index_kv=[0, 1, 2, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16, 17, 20, 22, 24, 28, 30, 31, 32, 34, 35, 36, 37, 38, 39, 44, 45, 46, 47]
>>>>>>>start training : long_term_forecast_DiscoveryPassage_and_others_720_360_96_ff_FEDformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
Chlorophyll (ug/l) Chlorophyll (ug/l)
train 33539
Chlorophyll (ug/l) Chlorophyll (ug/l)
val 4725
Chlorophyll (ug/l) Chlorophyll (ug/l)
test 9542
Parameters: 16.83252
        iters: 100, epoch: 1 | loss: 0.4130867
        speed: 4.9082s/iter; left time: 102390.8773s
        iters: 200, epoch: 1 | loss: 0.4756548
        speed: 5.2186s/iter; left time: 108342.3514s
        iters: 300, epoch: 1 | loss: 0.4794660
        speed: 5.1636s/iter; left time: 106685.6483s
        iters: 400, epoch: 1 | loss: 0.3813165
        speed: 5.1477s/iter; left time: 105842.1403s
        iters: 500, epoch: 1 | loss: 0.3427612
        speed: 5.1394s/iter; left time: 105157.6393s
        iters: 600, epoch: 1 | loss: 0.5955805
        speed: 5.1748s/iter; left time: 105363.4216s
        iters: 700, epoch: 1 | loss: 0.6374564
        speed: 4.9498s/iter; left time: 100286.9603s
        iters: 800, epoch: 1 | loss: 0.4264622
        speed: 5.0448s/iter; left time: 101707.6365s
        iters: 900, epoch: 1 | loss: 0.5119042
        speed: 5.1504s/iter; left time: 103322.3274s
        iters: 1000, epoch: 1 | loss: 0.5548676
        speed: 7.3403s/iter; left time: 146518.8754s
Epoch: 1 cost time: 5722.151102781296
Epoch: 1, Steps: 1048 | Train Loss: 0.4518190 Vali Loss: 0.4005476 Test Loss: 2.1559353
Validation loss decreased (inf --> 0.400548).  Saving model ...
Updating learning rate to 0.0001
Parameters: 16.83252
        iters: 100, epoch: 2 | loss: 0.2446126
        speed: 64.1482s/iter; left time: 1270967.9602s
        iters: 200, epoch: 2 | loss: 0.3653236
        speed: 8.9271s/iter; left time: 175980.4265s
        iters: 300, epoch: 2 | loss: 0.4207655
        speed: 8.5256s/iter; left time: 167212.0457s
        iters: 400, epoch: 2 | loss: 0.2467283
        speed: 8.6297s/iter; left time: 168391.7656s
        iters: 500, epoch: 2 | loss: 0.3521547
        speed: 8.4397s/iter; left time: 163840.7378s
        iters: 600, epoch: 2 | loss: 0.3555219
        speed: 8.9552s/iter; left time: 172951.0808s
        iters: 700, epoch: 2 | loss: 0.4160508
        speed: 8.8983s/iter; left time: 170963.7444s
        iters: 800, epoch: 2 | loss: 0.3475474
        speed: 8.9621s/iter; left time: 171292.3162s
        iters: 900, epoch: 2 | loss: 0.6160668
        speed: 8.9510s/iter; left time: 170184.6311s
        iters: 1000, epoch: 2 | loss: 0.5000758
        speed: 9.0791s/iter; left time: 171712.2685s
Epoch: 2 cost time: 9246.07237648964
Epoch: 2, Steps: 1048 | Train Loss: 0.4221364 Vali Loss: 0.3948968 Test Loss: 2.1161768
Validation loss decreased (0.400548 --> 0.394897).  Saving model ...
Updating learning rate to 5e-05
Parameters: 16.83252
        iters: 100, epoch: 3 | loss: 0.2712660
        speed: 70.0442s/iter; left time: 1314378.4824s
        iters: 200, epoch: 3 | loss: 0.3718527
        speed: 9.1953s/iter; left time: 171630.6059s
        iters: 300, epoch: 3 | loss: 0.3019201
        speed: 9.0767s/iter; left time: 168508.5362s
        iters: 400, epoch: 3 | loss: 0.3279555
        speed: 9.0728s/iter; left time: 167528.6116s
        iters: 500, epoch: 3 | loss: 0.4462744
        speed: 9.0644s/iter; left time: 166467.1648s
        iters: 600, epoch: 3 | loss: 0.2970689
        speed: 9.1047s/iter; left time: 166296.8857s
        iters: 700, epoch: 3 | loss: 0.3644259
        speed: 9.0267s/iter; left time: 163970.4007s
        iters: 800, epoch: 3 | loss: 0.2582711
        speed: 9.2161s/iter; left time: 166488.4346s
        iters: 900, epoch: 3 | loss: 0.3722438
        speed: 9.0234s/iter; left time: 162106.0719s
        iters: 1000, epoch: 3 | loss: 0.3541847
        speed: 9.2380s/iter; left time: 165036.0414s
Epoch: 3 cost time: 9532.304011106491
Epoch: 3, Steps: 1048 | Train Loss: 0.4097782 Vali Loss: 0.3927372 Test Loss: 2.1066945
Validation loss decreased (0.394897 --> 0.392737).  Saving model ...
Updating learning rate to 2.5e-05
Parameters: 16.83252
        iters: 100, epoch: 4 | loss: 0.3529862
        speed: 70.5127s/iter; left time: 1249273.4597s
        iters: 200, epoch: 4 | loss: 0.6537726
        speed: 8.8297s/iter; left time: 155553.1453s
        iters: 300, epoch: 4 | loss: 0.5279137
        speed: 9.3591s/iter; left time: 163944.1251s
        iters: 400, epoch: 4 | loss: 0.2752323
        speed: 9.1092s/iter; left time: 158654.2035s
        iters: 500, epoch: 4 | loss: 0.3252312
        speed: 8.9070s/iter; left time: 154241.7800s
        iters: 600, epoch: 4 | loss: 0.2653193
        speed: 9.5858s/iter; left time: 165038.7530s
        iters: 700, epoch: 4 | loss: 0.3741752
        speed: 9.3475s/iter; left time: 160000.3859s
        iters: 800, epoch: 4 | loss: 0.4056701
        speed: 9.2924s/iter; left time: 158129.1976s
        iters: 900, epoch: 4 | loss: 0.3776546
        speed: 9.3703s/iter; left time: 158518.1820s
        iters: 1000, epoch: 4 | loss: 0.3129708
        speed: 9.3572s/iter; left time: 157359.8020s
Epoch: 4 cost time: 9680.410221099854
Epoch: 4, Steps: 1048 | Train Loss: 0.4043695 Vali Loss: 0.3948848 Test Loss: 2.1052930
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.25e-05
Parameters: 16.83252
        iters: 100, epoch: 5 | loss: 0.3466150
        speed: 71.7042s/iter; left time: 1195237.1247s
        iters: 200, epoch: 5 | loss: 0.5546407
        speed: 9.5012s/iter; left time: 157425.2783s
        iters: 300, epoch: 5 | loss: 0.2565285
        speed: 9.5592s/iter; left time: 157431.2521s
        iters: 400, epoch: 5 | loss: 0.5447223
        speed: 9.3483s/iter; left time: 153021.8469s
        iters: 500, epoch: 5 | loss: 0.5198126
        speed: 9.5056s/iter; left time: 154646.9861s
        iters: 600, epoch: 5 | loss: 0.2948252
        speed: 9.4534s/iter; left time: 152852.4913s
        iters: 700, epoch: 5 | loss: 0.5528173
        speed: 9.2161s/iter; left time: 148093.9693s
        iters: 800, epoch: 5 | loss: 0.3847405
        speed: 9.3333s/iter; left time: 149043.6360s
        iters: 900, epoch: 5 | loss: 0.4871591
        speed: 9.3956s/iter; left time: 149098.5703s
        iters: 1000, epoch: 5 | loss: 0.2647965
        speed: 9.3790s/iter; left time: 147896.9346s
Epoch: 5 cost time: 9859.450315237045
Epoch: 5, Steps: 1048 | Train Loss: 0.4020017 Vali Loss: 0.3934316 Test Loss: 2.1004605
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.25e-06
Parameters: 16.83252
        iters: 100, epoch: 6 | loss: 0.5880072
        speed: 52.5895s/iter; left time: 821500.0327s
        iters: 200, epoch: 6 | loss: 0.3547872
        speed: 5.1991s/iter; left time: 80695.9090s
        iters: 300, epoch: 6 | loss: 0.5201965
        speed: 5.1565s/iter; left time: 79517.7418s
        iters: 400, epoch: 6 | loss: 0.5218814
        speed: 5.1673s/iter; left time: 79167.8644s
        iters: 500, epoch: 6 | loss: 0.1602879
        speed: 5.2206s/iter; left time: 79462.7146s
        iters: 600, epoch: 6 | loss: 0.2342728
        speed: 5.3714s/iter; left time: 81221.6094s
        iters: 700, epoch: 6 | loss: 0.4656095
        speed: 5.3425s/iter; left time: 80250.4058s
        iters: 800, epoch: 6 | loss: 0.2769892
        speed: 5.2787s/iter; left time: 78763.8042s
        iters: 900, epoch: 6 | loss: 0.2423077
        speed: 5.2537s/iter; left time: 77865.3323s
        iters: 1000, epoch: 6 | loss: 0.5492650
        speed: 5.3895s/iter; left time: 79338.5486s
Epoch: 6 cost time: 5509.856364488602
Epoch: 6, Steps: 1048 | Train Loss: 0.3999955 Vali Loss: 0.3896924 Test Loss: 2.0938745
Validation loss decreased (0.392737 --> 0.389692).  Saving model ...
Updating learning rate to 3.125e-06
Parameters: 16.83252
        iters: 100, epoch: 7 | loss: 0.5169129
        speed: 41.1097s/iter; left time: 599091.3988s
        iters: 200, epoch: 7 | loss: 0.4136014
        speed: 6.5471s/iter; left time: 94756.1901s
        iters: 300, epoch: 7 | loss: 0.3485119
        speed: 7.9229s/iter; left time: 113875.5166s
        iters: 400, epoch: 7 | loss: 0.4060801
        speed: 7.7298s/iter; left time: 110327.3862s
        iters: 500, epoch: 7 | loss: 0.4321127
        speed: 7.7278s/iter; left time: 109526.7967s
        iters: 600, epoch: 7 | loss: 0.5677722
        speed: 7.4228s/iter; left time: 104461.7552s
        iters: 700, epoch: 7 | loss: 0.3773452
        speed: 7.7589s/iter; left time: 108415.0226s
        iters: 800, epoch: 7 | loss: 0.3737862
        speed: 7.6920s/iter; left time: 106710.9475s
        iters: 900, epoch: 7 | loss: 0.3590921
        speed: 7.6421s/iter; left time: 105254.0667s
        iters: 1000, epoch: 7 | loss: 0.3189155
        speed: 7.3173s/iter; left time: 100049.0348s
Epoch: 7 cost time: 7674.869744777679
Epoch: 7, Steps: 1048 | Train Loss: 0.3997203 Vali Loss: 0.3944410 Test Loss: 2.0873609
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.5625e-06
Parameters: 16.83252
        iters: 100, epoch: 8 | loss: 0.2499145
        speed: 60.5882s/iter; left time: 819456.0660s
        iters: 200, epoch: 8 | loss: 0.4269910
        speed: 7.6756s/iter; left time: 103044.9209s
        iters: 300, epoch: 8 | loss: 0.4589044
        speed: 7.6129s/iter; left time: 101441.5105s
        iters: 400, epoch: 8 | loss: 0.4436965
        speed: 7.5757s/iter; left time: 100189.1505s
        iters: 500, epoch: 8 | loss: 0.3876476
        speed: 7.4709s/iter; left time: 98055.2335s
        iters: 600, epoch: 8 | loss: 0.3309414
        speed: 7.6255s/iter; left time: 99321.6444s
        iters: 700, epoch: 8 | loss: 0.2768888
        speed: 7.7347s/iter; left time: 99970.8648s
        iters: 800, epoch: 8 | loss: 0.5163499
        speed: 7.6868s/iter; left time: 98583.2795s
        iters: 900, epoch: 8 | loss: 0.4245090
        speed: 7.7188s/iter; left time: 98221.2365s
        iters: 1000, epoch: 8 | loss: 0.4100097
        speed: 7.4110s/iter; left time: 93563.8973s
Epoch: 8 cost time: 7956.507579803467
Epoch: 8, Steps: 1048 | Train Loss: 0.4004574 Vali Loss: 0.3915703 Test Loss: 2.0764842
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.8125e-07
Parameters: 16.83252
        iters: 100, epoch: 9 | loss: 0.4959193
        speed: 59.9750s/iter; left time: 748307.6404s
        iters: 200, epoch: 9 | loss: 0.5894153
        speed: 5.9186s/iter; left time: 73254.7843s
        iters: 300, epoch: 9 | loss: 0.3159059
        speed: 5.1255s/iter; left time: 62925.5694s
        iters: 400, epoch: 9 | loss: 0.2831713
        speed: 5.0816s/iter; left time: 61878.3959s
        iters: 500, epoch: 9 | loss: 0.2343564
        speed: 5.0865s/iter; left time: 61429.4804s
        iters: 600, epoch: 9 | loss: 0.2011113
        speed: 5.1418s/iter; left time: 61583.8587s
        iters: 700, epoch: 9 | loss: 0.4178230
        speed: 5.1171s/iter; left time: 60775.5340s
        iters: 800, epoch: 9 | loss: 0.2316451
        speed: 5.0640s/iter; left time: 59639.0796s
        iters: 900, epoch: 9 | loss: 0.2378982
        speed: 5.0690s/iter; left time: 59190.9860s
        iters: 1000, epoch: 9 | loss: 0.3148876
        speed: 5.1131s/iter; left time: 59194.0159s
Epoch: 9 cost time: 5623.761016607285
Epoch: 9, Steps: 1048 | Train Loss: 0.3992282 Vali Loss: 0.3932133 Test Loss: 2.0997989
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.90625e-07
Parameters: 16.83252
        iters: 100, epoch: 10 | loss: 0.4218690
        speed: 40.6064s/iter; left time: 464090.9031s
        iters: 200, epoch: 10 | loss: 0.2112080
        speed: 5.1319s/iter; left time: 58138.9345s
        iters: 300, epoch: 10 | loss: 0.5622345
        speed: 5.1485s/iter; left time: 57812.1040s
        iters: 400, epoch: 10 | loss: 0.3497125
        speed: 5.0811s/iter; left time: 56547.2594s
        iters: 500, epoch: 10 | loss: 0.6257899
        speed: 5.1000s/iter; left time: 56247.6576s
        iters: 600, epoch: 10 | loss: 0.4756909
        speed: 5.1642s/iter; left time: 56439.4270s
        iters: 700, epoch: 10 | loss: 0.5054610
        speed: 5.1209s/iter; left time: 55454.7423s
        iters: 800, epoch: 10 | loss: 0.2940196
        speed: 5.0792s/iter; left time: 54494.9359s
        iters: 900, epoch: 10 | loss: 0.4101663
        speed: 5.1441s/iter; left time: 54677.0880s
        iters: 1000, epoch: 10 | loss: 0.4114984
        speed: 5.1290s/iter; left time: 54002.9528s
Epoch: 10 cost time: 5370.216695308685
Epoch: 10, Steps: 1048 | Train Loss: 0.3987769 Vali Loss: 0.3922373 Test Loss: 2.0817754
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.953125e-07
Parameters: 16.83252
        iters: 100, epoch: 11 | loss: 0.4940995
        speed: 40.3823s/iter; left time: 419208.7353s
        iters: 200, epoch: 11 | loss: 0.2809173
        speed: 5.0673s/iter; left time: 52096.6786s
        iters: 300, epoch: 11 | loss: 0.4402419
        speed: 5.0692s/iter; left time: 51609.0736s
        iters: 400, epoch: 11 | loss: 0.5626933
        speed: 5.0803s/iter; left time: 51214.0734s
        iters: 500, epoch: 11 | loss: 0.4186953
        speed: 5.0850s/iter; left time: 50753.1739s
        iters: 600, epoch: 11 | loss: 0.4204341
        speed: 5.0806s/iter; left time: 50200.9273s
        iters: 700, epoch: 11 | loss: 0.2687727
        speed: 5.1158s/iter; left time: 50037.3457s
        iters: 800, epoch: 11 | loss: 0.3839134
        speed: 5.0462s/iter; left time: 48851.8952s
        iters: 900, epoch: 11 | loss: 0.4517992
        speed: 5.0940s/iter; left time: 48805.7354s
        iters: 1000, epoch: 11 | loss: 0.1233079
        speed: 5.0603s/iter; left time: 47976.5077s
Epoch: 11 cost time: 5320.483256816864
Epoch: 11, Steps: 1048 | Train Loss: 0.3990939 Vali Loss: 0.3913208 Test Loss: 2.0890133
EarlyStopping counter: 5 out of 5
Updating learning rate to 9.765625e-08
Early stopping
>>>>>>>testing : long_term_forecast_DiscoveryPassage_and_others_720_360_96_ff_FEDformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Chlorophyll (ug/l) Chlorophyll (ug/l)
test 9542
test shape: (9542, 1, 96, 8) (9542, 1, 96, 8)
test shape: (9542, 96, 8) (9542, 96, 8)
mse:2.0858426094055176, mae:0.702654242515564




XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX___________________FUSST___ TYPE1__________________XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX___________________FUSST____TYPE1_________________XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
MODEL IMPLEMENTED= FUSST
PREDICTION LENGTH= 96
SEQUENCE LENGTH= 96
LEARNING RATE ADJUSTMENT= type1

bash ./scripts/DiscoveryPassage_and_others_Script/FUSST.sh
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=8, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='DiscoveryPassage_and_others_merged.csv', dec_in=8, des='Exp', devices='0,1,2,3', distil=True, dropout=0.1, e_layers=2, embed='timeF', enc_in=8, factor=3, features='M', freq='h', gpu=0, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='FUSST', model_id='DiscoveryPassage_and_others_720_360_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=96, root_path='./dataset/', seasonal_patterns='Monthly', seq_len=96, target='Chlorophyll (ug/l)', task_name='long_term_forecast', top_k=5, train_epochs=20, use_amp=False, use_gpu=False, use_multi_gpu=False, w_lin=0.01)
Use CPU
>>>>>>>start training : long_term_forecast_DiscoveryPassage_and_others_720_360_96_FUSST_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
Chlorophyll (ug/l) Chlorophyll (ug/l)
train 33539
Chlorophyll (ug/l) Chlorophyll (ug/l)
val 4725
Chlorophyll (ug/l) Chlorophyll (ug/l)
test 9542
Parameters: 0.884824
        iters: 100, epoch: 1 | loss: 0.2967753
        speed: 0.1015s/iter; left time: 2117.3834s
        iters: 200, epoch: 1 | loss: 0.3852698
        speed: 0.0966s/iter; left time: 2005.6792s
        iters: 300, epoch: 1 | loss: 0.2600857
        speed: 0.0974s/iter; left time: 2012.5134s
        iters: 400, epoch: 1 | loss: 0.4307040
        speed: 0.0975s/iter; left time: 2005.4217s
        iters: 500, epoch: 1 | loss: 0.3834481
        speed: 0.0890s/iter; left time: 1820.3708s
        iters: 600, epoch: 1 | loss: 0.2372210
        speed: 0.0940s/iter; left time: 1913.6058s
        iters: 700, epoch: 1 | loss: 0.2889076
        speed: 0.1020s/iter; left time: 2066.1283s
        iters: 800, epoch: 1 | loss: 0.3343977
        speed: 0.0960s/iter; left time: 1934.7522s
        iters: 900, epoch: 1 | loss: 0.3632017
        speed: 0.0905s/iter; left time: 1816.3786s
        iters: 1000, epoch: 1 | loss: 0.4033872
        speed: 0.0957s/iter; left time: 1910.0541s
Epoch: 1 cost time: 100.73730945587158
Epoch: 1, Steps: 1048 | Train Loss: 0.3640278 Vali Loss: 0.2484928 Test Loss: 1.6210752
Validation loss decreased (inf --> 0.248493).  Saving model ...
Updating learning rate to 0.0001
Parameters: 0.884824
        iters: 100, epoch: 2 | loss: 0.2516511
        speed: 1.0063s/iter; left time: 19938.4734s
        iters: 200, epoch: 2 | loss: 0.4052944
        speed: 0.1105s/iter; left time: 2177.4342s
        iters: 300, epoch: 2 | loss: 0.5125227
        speed: 0.1012s/iter; left time: 1984.2549s
        iters: 400, epoch: 2 | loss: 0.4108121
        speed: 0.0938s/iter; left time: 1831.2918s
        iters: 500, epoch: 2 | loss: 0.3796856
        speed: 0.0921s/iter; left time: 1788.3478s
        iters: 600, epoch: 2 | loss: 0.4908472
        speed: 0.0955s/iter; left time: 1844.3051s
        iters: 700, epoch: 2 | loss: 0.4513738
        speed: 0.0935s/iter; left time: 1797.2416s
        iters: 800, epoch: 2 | loss: 0.3283459
        speed: 0.0946s/iter; left time: 1808.2076s
        iters: 900, epoch: 2 | loss: 0.2721068
        speed: 0.0919s/iter; left time: 1746.6478s
        iters: 1000, epoch: 2 | loss: 0.3364806
        speed: 0.0934s/iter; left time: 1766.3510s
Epoch: 2 cost time: 101.72813487052917
Epoch: 2, Steps: 1048 | Train Loss: 0.3244113 Vali Loss: 0.2329404 Test Loss: 1.6036807
Validation loss decreased (0.248493 --> 0.232940).  Saving model ...
Updating learning rate to 5e-05
Parameters: 0.884824
        iters: 100, epoch: 3 | loss: 0.2104145
        speed: 0.9900s/iter; left time: 18577.3099s
        iters: 200, epoch: 3 | loss: 0.4498760
        speed: 0.1038s/iter; left time: 1937.6008s
        iters: 300, epoch: 3 | loss: 0.3325231
        speed: 0.1083s/iter; left time: 2010.8829s
        iters: 400, epoch: 3 | loss: 0.2520017
        speed: 0.1100s/iter; left time: 2031.0863s
        iters: 500, epoch: 3 | loss: 0.2486669
        speed: 0.1106s/iter; left time: 2031.8101s
        iters: 600, epoch: 3 | loss: 0.2541156
        speed: 0.1056s/iter; left time: 1928.8633s
        iters: 700, epoch: 3 | loss: 0.2463858
        speed: 0.1096s/iter; left time: 1991.3676s
        iters: 800, epoch: 3 | loss: 0.2521098
        speed: 0.1217s/iter; left time: 2198.1576s
        iters: 900, epoch: 3 | loss: 0.6345249
        speed: 0.1106s/iter; left time: 1986.3181s
        iters: 1000, epoch: 3 | loss: 0.2785265
        speed: 0.1179s/iter; left time: 2105.5234s
Epoch: 3 cost time: 116.11248636245728
Epoch: 3, Steps: 1048 | Train Loss: 0.3143452 Vali Loss: 0.2273127 Test Loss: 1.5891272
Validation loss decreased (0.232940 --> 0.227313).  Saving model ...
Updating learning rate to 2.5e-05
Parameters: 0.884824
        iters: 100, epoch: 4 | loss: 0.1852257
        speed: 1.1295s/iter; left time: 20011.4434s
        iters: 200, epoch: 4 | loss: 0.3255161
        speed: 0.0775s/iter; left time: 1364.9835s
        iters: 300, epoch: 4 | loss: 0.3529682
        speed: 0.0833s/iter; left time: 1458.7738s
        iters: 400, epoch: 4 | loss: 0.2076920
        speed: 0.0794s/iter; left time: 1382.3113s
        iters: 500, epoch: 4 | loss: 0.2961284
        speed: 0.0801s/iter; left time: 1386.8713s
        iters: 600, epoch: 4 | loss: 0.4291584
        speed: 0.0810s/iter; left time: 1394.2470s
        iters: 700, epoch: 4 | loss: 0.4306278
        speed: 0.0797s/iter; left time: 1364.0359s
        iters: 800, epoch: 4 | loss: 0.2847516
        speed: 0.0787s/iter; left time: 1338.9591s
        iters: 900, epoch: 4 | loss: 0.3347822
        speed: 0.0820s/iter; left time: 1386.9152s
        iters: 1000, epoch: 4 | loss: 0.1643834
        speed: 0.0794s/iter; left time: 1335.3892s
Epoch: 4 cost time: 87.27637887001038
Epoch: 4, Steps: 1048 | Train Loss: 0.3099190 Vali Loss: 0.2264156 Test Loss: 1.5902290
Validation loss decreased (0.227313 --> 0.226416).  Saving model ...
Updating learning rate to 1.25e-05
Parameters: 0.884824
        iters: 100, epoch: 5 | loss: 0.3866339
        speed: 0.8210s/iter; left time: 13685.9085s
        iters: 200, epoch: 5 | loss: 0.2889245
        speed: 0.0804s/iter; left time: 1332.1259s
        iters: 300, epoch: 5 | loss: 0.2751659
        speed: 0.0812s/iter; left time: 1336.6389s
        iters: 400, epoch: 5 | loss: 0.3531108
        speed: 0.0803s/iter; left time: 1314.3124s
        iters: 500, epoch: 5 | loss: 0.4266608
        speed: 0.0767s/iter; left time: 1247.6497s
        iters: 600, epoch: 5 | loss: 0.4960809
        speed: 0.0780s/iter; left time: 1260.8139s
        iters: 700, epoch: 5 | loss: 0.4617958
        speed: 0.0771s/iter; left time: 1238.7670s
        iters: 800, epoch: 5 | loss: 0.1946281
        speed: 0.0792s/iter; left time: 1264.1184s
        iters: 900, epoch: 5 | loss: 0.1743558
        speed: 0.0810s/iter; left time: 1284.9749s
        iters: 1000, epoch: 5 | loss: 0.3116300
        speed: 0.0793s/iter; left time: 1250.3009s
Epoch: 5 cost time: 83.37110042572021
Epoch: 5, Steps: 1048 | Train Loss: 0.3080571 Vali Loss: 0.2259293 Test Loss: 1.5865983
Validation loss decreased (0.226416 --> 0.225929).  Saving model ...
Updating learning rate to 6.25e-06
Parameters: 0.884824
        iters: 100, epoch: 6 | loss: 0.4177624
        speed: 0.8283s/iter; left time: 12939.3491s
        iters: 200, epoch: 6 | loss: 0.2199635
        speed: 0.0830s/iter; left time: 1287.6895s
        iters: 300, epoch: 6 | loss: 0.5546919
        speed: 0.0770s/iter; left time: 1187.6782s
        iters: 400, epoch: 6 | loss: 0.2058501
        speed: 0.0775s/iter; left time: 1188.0361s
        iters: 500, epoch: 6 | loss: 0.2914079
        speed: 0.0768s/iter; left time: 1168.6215s
        iters: 600, epoch: 6 | loss: 0.5430895
        speed: 0.0791s/iter; left time: 1196.4146s
        iters: 700, epoch: 6 | loss: 0.2199639
        speed: 0.0810s/iter; left time: 1216.6269s
        iters: 800, epoch: 6 | loss: 0.5582105
        speed: 0.0822s/iter; left time: 1227.0276s
        iters: 900, epoch: 6 | loss: 0.1663393
        speed: 0.0797s/iter; left time: 1180.9395s
        iters: 1000, epoch: 6 | loss: 0.3555500
        speed: 0.0773s/iter; left time: 1138.1263s
Epoch: 6 cost time: 82.94153094291687
Epoch: 6, Steps: 1048 | Train Loss: 0.3072469 Vali Loss: 0.2256898 Test Loss: 1.5867784
Validation loss decreased (0.225929 --> 0.225690).  Saving model ...
Updating learning rate to 3.125e-06
Parameters: 0.884824
        iters: 100, epoch: 7 | loss: 0.2502507
        speed: 0.8219s/iter; left time: 11977.8139s
        iters: 200, epoch: 7 | loss: 0.3526222
        speed: 0.0800s/iter; left time: 1157.6008s
        iters: 300, epoch: 7 | loss: 0.2318898
        speed: 0.0776s/iter; left time: 1115.9306s
        iters: 400, epoch: 7 | loss: 0.4164389
        speed: 0.0784s/iter; left time: 1119.6586s
        iters: 500, epoch: 7 | loss: 0.1472646
        speed: 0.0820s/iter; left time: 1161.8267s
        iters: 600, epoch: 7 | loss: 0.4720781
        speed: 0.0764s/iter; left time: 1075.7197s
        iters: 700, epoch: 7 | loss: 0.2035152
        speed: 0.0809s/iter; left time: 1130.8677s
        iters: 800, epoch: 7 | loss: 0.2479088
        speed: 0.0789s/iter; left time: 1094.7017s
        iters: 900, epoch: 7 | loss: 0.2445015
        speed: 0.0806s/iter; left time: 1109.7455s
        iters: 1000, epoch: 7 | loss: 0.3327692
        speed: 0.0774s/iter; left time: 1057.6589s
Epoch: 7 cost time: 83.31449627876282
Epoch: 7, Steps: 1048 | Train Loss: 0.3066519 Vali Loss: 0.2264898 Test Loss: 1.5846459
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.5625e-06
Parameters: 0.884824
        iters: 100, epoch: 8 | loss: 0.2146898
        speed: 0.8185s/iter; left time: 11070.1306s
        iters: 200, epoch: 8 | loss: 0.2711584
        speed: 0.0776s/iter; left time: 1041.1426s
        iters: 300, epoch: 8 | loss: 0.2606892
        speed: 0.0790s/iter; left time: 1052.5081s
        iters: 400, epoch: 8 | loss: 0.2263027
        speed: 0.0750s/iter; left time: 992.4336s
        iters: 500, epoch: 8 | loss: 0.1577351
        speed: 0.0795s/iter; left time: 1043.7777s
        iters: 600, epoch: 8 | loss: 0.3863109
        speed: 0.0778s/iter; left time: 1013.9782s
        iters: 700, epoch: 8 | loss: 0.4277140
        speed: 0.0786s/iter; left time: 1015.4072s
        iters: 800, epoch: 8 | loss: 0.2113228
        speed: 0.0820s/iter; left time: 1051.1842s
        iters: 900, epoch: 8 | loss: 0.2002214
        speed: 0.0807s/iter; left time: 1026.7373s
        iters: 1000, epoch: 8 | loss: 0.2160550
        speed: 0.0798s/iter; left time: 1007.7374s
Epoch: 8 cost time: 83.20428371429443
Epoch: 8, Steps: 1048 | Train Loss: 0.3064548 Vali Loss: 0.2258763 Test Loss: 1.5852609
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.8125e-07
Parameters: 0.884824
        iters: 100, epoch: 9 | loss: 0.2536929
        speed: 0.8139s/iter; left time: 10155.3108s
        iters: 200, epoch: 9 | loss: 0.3144294
        speed: 0.0864s/iter; left time: 1069.5088s
        iters: 300, epoch: 9 | loss: 0.2718612
        speed: 0.0918s/iter; left time: 1126.8992s
        iters: 400, epoch: 9 | loss: 0.2811753
        speed: 0.0956s/iter; left time: 1163.6865s
        iters: 500, epoch: 9 | loss: 0.2854787
        speed: 0.0926s/iter; left time: 1118.7725s
        iters: 600, epoch: 9 | loss: 0.3894643
        speed: 0.0945s/iter; left time: 1132.2711s
        iters: 700, epoch: 9 | loss: 0.3994863
        speed: 0.0882s/iter; left time: 1048.1128s
        iters: 800, epoch: 9 | loss: 0.3352019
        speed: 0.0947s/iter; left time: 1115.8232s
        iters: 900, epoch: 9 | loss: 0.3412293
        speed: 0.0969s/iter; left time: 1131.0522s
        iters: 1000, epoch: 9 | loss: 0.2968140
        speed: 0.0932s/iter; left time: 1078.9984s
Epoch: 9 cost time: 95.98148393630981
Epoch: 9, Steps: 1048 | Train Loss: 0.3062431 Vali Loss: 0.2261983 Test Loss: 1.5854956
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.90625e-07
Parameters: 0.884824
        iters: 100, epoch: 10 | loss: 0.3498749
        speed: 0.9465s/iter; left time: 10817.0216s
        iters: 200, epoch: 10 | loss: 0.3376561
        speed: 0.0901s/iter; left time: 1020.4455s
        iters: 300, epoch: 10 | loss: 0.2508214
        speed: 0.0967s/iter; left time: 1085.9515s
        iters: 400, epoch: 10 | loss: 0.2855411
        speed: 0.0950s/iter; left time: 1057.5551s
        iters: 500, epoch: 10 | loss: 0.2220502
        speed: 0.0891s/iter; left time: 982.7458s
        iters: 600, epoch: 10 | loss: 0.2103244
        speed: 0.0926s/iter; left time: 1012.4789s
        iters: 700, epoch: 10 | loss: 0.2896743
        speed: 0.0936s/iter; left time: 1013.9974s
        iters: 800, epoch: 10 | loss: 0.2992315
        speed: 0.0968s/iter; left time: 1038.3734s
        iters: 900, epoch: 10 | loss: 0.2243829
        speed: 0.0909s/iter; left time: 965.7864s
        iters: 1000, epoch: 10 | loss: 0.2716978
        speed: 0.0932s/iter; left time: 981.2675s
Epoch: 10 cost time: 98.46503448486328
Epoch: 10, Steps: 1048 | Train Loss: 0.3061936 Vali Loss: 0.2259266 Test Loss: 1.5855469
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.953125e-07
Parameters: 0.884824
        iters: 100, epoch: 11 | loss: 0.3414296
        speed: 0.9456s/iter; left time: 9816.1632s
        iters: 200, epoch: 11 | loss: 0.1902762
        speed: 0.0957s/iter; left time: 984.1276s
        iters: 300, epoch: 11 | loss: 0.1647386
        speed: 0.0953s/iter; left time: 970.0111s
        iters: 400, epoch: 11 | loss: 0.3048205
        speed: 0.0954s/iter; left time: 961.3924s
        iters: 500, epoch: 11 | loss: 0.2654828
        speed: 0.0957s/iter; left time: 955.2876s
        iters: 600, epoch: 11 | loss: 0.2066598
        speed: 0.0919s/iter; left time: 907.7798s
        iters: 700, epoch: 11 | loss: 0.1976128
        speed: 0.0966s/iter; left time: 944.3911s
        iters: 800, epoch: 11 | loss: 0.4208938
        speed: 0.0944s/iter; left time: 913.7091s
        iters: 900, epoch: 11 | loss: 0.3286967
        speed: 0.0934s/iter; left time: 894.5980s
        iters: 1000, epoch: 11 | loss: 0.3366351
        speed: 0.0912s/iter; left time: 864.9945s
Epoch: 11 cost time: 99.50195360183716
Epoch: 11, Steps: 1048 | Train Loss: 0.3062381 Vali Loss: 0.2260765 Test Loss: 1.5855745
EarlyStopping counter: 5 out of 5
Updating learning rate to 9.765625e-08
Early stopping
>>>>>>>testing : long_term_forecast_DiscoveryPassage_and_others_720_360_96_FUSST_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Chlorophyll (ug/l) Chlorophyll (ug/l)
test 9542
test shape: (9542, 1, 96, 8) (9542, 1, 96, 8)
test shape: (9542, 96, 8) (9542, 96, 8)
mse:1.5867785215377808, mae:0.45299604535102844






XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX___________________FUSST_____________________XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
bash ./scripts/DiscoveryPassage_and_others_Script/FUSST.sh
MODEL IMPLEMENTED= FUSST
PREDICTION LENGTH= 192
SEQUENCE LENGTH= 192
LEARNING RATE ADJUSTMENT= type1
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=8, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='DiscoveryPassage_and_others_merged.csv', dec_in=8, des='Exp', devices='0,1,2,3', distil=True, dropout=0.1, e_layers=2, embed='timeF', enc_in=8, factor=3, features='M', freq='h', gpu=0, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='FUSST', model_id='DiscoveryPassage_and_others_720_360_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=192, root_path='./dataset/', seasonal_patterns='Monthly', seq_len=192, target='Chlorophyll (ug/l)', task_name='long_term_forecast', top_k=5, train_epochs=20, use_amp=False, use_gpu=False, use_multi_gpu=False, w_lin=0.01)
Use CPU
>>>>>>>start training : long_term_forecast_DiscoveryPassage_and_others_720_360_96_FUSST_custom_ftM_sl192_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
Chlorophyll (ug/l) Chlorophyll (ug/l)
train 33347
Chlorophyll (ug/l) Chlorophyll (ug/l)
val 4629
Chlorophyll (ug/l) Chlorophyll (ug/l)
test 9446
Parameters: 1.949848
	iters: 100, epoch: 1 | loss: 0.3495916
	speed: 0.0723s/iter; left time: 1499.5421s
	iters: 200, epoch: 1 | loss: 0.2286486
	speed: 0.0707s/iter; left time: 1458.9512s
	iters: 300, epoch: 1 | loss: 0.2732294
	speed: 0.0716s/iter; left time: 1470.4607s
	iters: 400, epoch: 1 | loss: 0.5442317
	speed: 0.0716s/iter; left time: 1463.0032s
	iters: 500, epoch: 1 | loss: 0.5256715
	speed: 0.0690s/iter; left time: 1402.6409s
	iters: 600, epoch: 1 | loss: 0.4184677
	speed: 0.0669s/iter; left time: 1354.8570s
	iters: 700, epoch: 1 | loss: 0.2999500
	speed: 0.0685s/iter; left time: 1379.4271s
	iters: 800, epoch: 1 | loss: 0.3071716
	speed: 0.0692s/iter; left time: 1387.3867s
	iters: 900, epoch: 1 | loss: 0.6060724
	speed: 0.0692s/iter; left time: 1380.3779s
	iters: 1000, epoch: 1 | loss: 0.3857774
	speed: 0.0659s/iter; left time: 1306.7744s
Epoch: 1 cost time: 72.31404566764832
Epoch: 1, Steps: 1042 | Train Loss: 0.3868873 Vali Loss: 0.3304645 Test Loss: 1.8095343
Validation loss decreased (inf --> 0.330465).  Saving model ...
Updating learning rate to 0.0001
Parameters: 1.949848
	iters: 100, epoch: 2 | loss: 0.3417153
	speed: 0.6416s/iter; left time: 12639.6296s
	iters: 200, epoch: 2 | loss: 0.2751164
	speed: 0.0652s/iter; left time: 1277.9444s
	iters: 300, epoch: 2 | loss: 0.3961062
	speed: 0.0682s/iter; left time: 1330.0583s
	iters: 400, epoch: 2 | loss: 0.3973852
	speed: 0.0740s/iter; left time: 1434.9398s
	iters: 500, epoch: 2 | loss: 0.2987298
	speed: 0.0711s/iter; left time: 1371.9289s
	iters: 600, epoch: 2 | loss: 0.4075890
	speed: 0.0707s/iter; left time: 1356.9915s
	iters: 700, epoch: 2 | loss: 0.2617565
	speed: 0.0739s/iter; left time: 1410.7019s
	iters: 800, epoch: 2 | loss: 0.3780819
	speed: 0.0743s/iter; left time: 1411.9370s
	iters: 900, epoch: 2 | loss: 0.3696580
	speed: 0.0740s/iter; left time: 1399.4011s
	iters: 1000, epoch: 2 | loss: 0.2846285
	speed: 0.0736s/iter; left time: 1383.1760s
Epoch: 2 cost time: 74.38365697860718
Epoch: 2, Steps: 1042 | Train Loss: 0.3497869 Vali Loss: 0.3189384 Test Loss: 1.7897846
Validation loss decreased (0.330465 --> 0.318938).  Saving model ...
Updating learning rate to 5e-05
Parameters: 1.949848
	iters: 100, epoch: 3 | loss: 0.1660256
	speed: 0.7585s/iter; left time: 14150.9264s
	iters: 200, epoch: 3 | loss: 0.1502564
	speed: 0.0774s/iter; left time: 1436.0640s
	iters: 300, epoch: 3 | loss: 0.3178330
	speed: 0.0774s/iter; left time: 1429.2882s
	iters: 400, epoch: 3 | loss: 0.2937659
	speed: 0.0760s/iter; left time: 1394.4403s
	iters: 500, epoch: 3 | loss: 0.3041847
	speed: 0.0751s/iter; left time: 1371.5599s
	iters: 600, epoch: 3 | loss: 0.1911306
	speed: 0.0731s/iter; left time: 1327.8673s
	iters: 700, epoch: 3 | loss: 0.3518264
	speed: 0.0752s/iter; left time: 1358.2158s
	iters: 800, epoch: 3 | loss: 0.2369222
	speed: 0.0760s/iter; left time: 1365.4303s
	iters: 900, epoch: 3 | loss: 0.3632549
	speed: 0.0739s/iter; left time: 1320.2281s
	iters: 1000, epoch: 3 | loss: 0.2162663
	speed: 0.0718s/iter; left time: 1275.7178s
Epoch: 3 cost time: 78.24873924255371
Epoch: 3, Steps: 1042 | Train Loss: 0.3361289 Vali Loss: 0.3200134 Test Loss: 1.7898052
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.5e-05
Parameters: 1.949848
	iters: 100, epoch: 4 | loss: 0.4238201
	speed: 0.7223s/iter; left time: 12723.4119s
	iters: 200, epoch: 4 | loss: 0.3948433
	speed: 0.0710s/iter; left time: 1243.1608s
	iters: 300, epoch: 4 | loss: 0.1182043
	speed: 0.0706s/iter; left time: 1230.2334s
	iters: 400, epoch: 4 | loss: 0.4027019
	speed: 0.0730s/iter; left time: 1264.0438s
	iters: 500, epoch: 4 | loss: 0.7190420
	speed: 0.0738s/iter; left time: 1271.0706s
	iters: 600, epoch: 4 | loss: 0.4997795
	speed: 0.0760s/iter; left time: 1300.1541s
	iters: 700, epoch: 4 | loss: 0.4022849
	speed: 0.0739s/iter; left time: 1257.8210s
	iters: 800, epoch: 4 | loss: 0.1518359
	speed: 0.0736s/iter; left time: 1245.7490s
	iters: 900, epoch: 4 | loss: 0.3500095
	speed: 0.0725s/iter; left time: 1219.5323s
	iters: 1000, epoch: 4 | loss: 0.3887822
	speed: 0.0735s/iter; left time: 1228.0896s
Epoch: 4 cost time: 76.13418316841125
Epoch: 4, Steps: 1042 | Train Loss: 0.3291978 Vali Loss: 0.3235976 Test Loss: 1.7857111
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.25e-05
Parameters: 1.949848
	iters: 100, epoch: 5 | loss: 0.3289692
	speed: 0.7139s/iter; left time: 11831.0192s
	iters: 200, epoch: 5 | loss: 0.2131242
	speed: 0.0763s/iter; left time: 1257.5745s
	iters: 300, epoch: 5 | loss: 0.2836040
	speed: 0.0724s/iter; left time: 1186.0793s
	iters: 400, epoch: 5 | loss: 0.3521225
	speed: 0.0730s/iter; left time: 1187.9626s
	iters: 500, epoch: 5 | loss: 0.3330640
	speed: 0.0729s/iter; left time: 1178.4557s
	iters: 600, epoch: 5 | loss: 0.2772177
	speed: 0.0733s/iter; left time: 1178.2899s
	iters: 700, epoch: 5 | loss: 0.3505473
	speed: 0.0707s/iter; left time: 1130.0171s
	iters: 800, epoch: 5 | loss: 0.2348019
	speed: 0.0721s/iter; left time: 1143.8263s
	iters: 900, epoch: 5 | loss: 0.4187770
	speed: 0.0711s/iter; left time: 1120.9535s
	iters: 1000, epoch: 5 | loss: 0.2353801
	speed: 0.0753s/iter; left time: 1180.9440s
Epoch: 5 cost time: 76.50065636634827
Epoch: 5, Steps: 1042 | Train Loss: 0.3257914 Vali Loss: 0.3238207 Test Loss: 1.7807248
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.25e-06
Parameters: 1.949848
	iters: 100, epoch: 6 | loss: 0.3436894
	speed: 1.1913s/iter; left time: 18501.5676s
	iters: 200, epoch: 6 | loss: 0.4319857
	speed: 0.1156s/iter; left time: 1783.0844s
	iters: 300, epoch: 6 | loss: 0.2468115
	speed: 0.1168s/iter; left time: 1790.6342s
	iters: 400, epoch: 6 | loss: 0.3613532
	speed: 0.1219s/iter; left time: 1856.3742s
	iters: 500, epoch: 6 | loss: 0.1922482
	speed: 0.1164s/iter; left time: 1761.8738s
	iters: 600, epoch: 6 | loss: 0.3864977
	speed: 0.1196s/iter; left time: 1796.9785s
	iters: 700, epoch: 6 | loss: 0.3012015
	speed: 0.1144s/iter; left time: 1707.7451s
	iters: 800, epoch: 6 | loss: 0.4032646
	speed: 0.1176s/iter; left time: 1743.6598s
	iters: 900, epoch: 6 | loss: 0.3997499
	speed: 0.1201s/iter; left time: 1769.0070s
	iters: 1000, epoch: 6 | loss: 0.2321144
	speed: 0.1173s/iter; left time: 1716.3191s
Epoch: 6 cost time: 123.03022718429565
Epoch: 6, Steps: 1042 | Train Loss: 0.3242057 Vali Loss: 0.3236443 Test Loss: 1.7808522
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.125e-06
Parameters: 1.949848
	iters: 100, epoch: 7 | loss: 0.2453396
	speed: 1.2032s/iter; left time: 17433.1240s
	iters: 200, epoch: 7 | loss: 0.4109336
	speed: 0.1163s/iter; left time: 1673.9225s
	iters: 300, epoch: 7 | loss: 0.2810684
	speed: 0.1172s/iter; left time: 1674.3583s
	iters: 400, epoch: 7 | loss: 0.3369607
	speed: 0.1167s/iter; left time: 1655.7370s
	iters: 500, epoch: 7 | loss: 0.3986665
	speed: 0.1182s/iter; left time: 1664.6893s
	iters: 600, epoch: 7 | loss: 0.4477493
	speed: 0.1159s/iter; left time: 1621.0586s
	iters: 700, epoch: 7 | loss: 0.2237217
	speed: 0.1157s/iter; left time: 1606.2800s
	iters: 800, epoch: 7 | loss: 0.6005762
	speed: 0.1170s/iter; left time: 1613.8882s
	iters: 900, epoch: 7 | loss: 0.3243235
	speed: 0.1177s/iter; left time: 1610.6449s
	iters: 1000, epoch: 7 | loss: 0.3191133
	speed: 0.1200s/iter; left time: 1630.8711s
Epoch: 7 cost time: 122.17844653129578
Epoch: 7, Steps: 1042 | Train Loss: 0.3232099 Vali Loss: 0.3233053 Test Loss: 1.7852888
EarlyStopping counter: 5 out of 5
Updating learning rate to 1.5625e-06
Early stopping
>>>>>>>testing : long_term_forecast_DiscoveryPassage_and_others_720_360_96_FUSST_custom_ftM_sl192_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Chlorophyll (ug/l) Chlorophyll (ug/l)
test 9446
test shape: (9446, 1, 192, 8) (9446, 1, 192, 8)
test shape: (9446, 192, 8) (9446, 192, 8)
mse:1.7897837162017822, mae:0.5224279761314392
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX___________________FUSST_____________________XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX


bash ./scripts/DiscoveryPassage_and_others_Script/FUSST.sh
/usr/local/bin/python3
MODEL IMPLEMENTED= FUSST
PREDICTION LENGTH= 360
SEQUENCE LENGTH= 360
LEARNING RATE ADJUSTMENT= type1
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=8, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='DiscoveryPassage_and_others_merged.csv', dec_in=8, des='Exp', devices='0,1,2,3', distil=True, dropout=0.1, e_layers=2, embed='timeF', enc_in=8, factor=3, features='M', freq='h', gpu=0, is_training=1, itr=1, label_len=24, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='FUSST', model_id='DiscoveryPassage_and_others_720_360_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=360, root_path='./dataset/', seasonal_patterns='Monthly', seq_len=360, target='Chlorophyll (ug/l)', task_name='long_term_forecast', top_k=5, train_epochs=20, use_amp=False, use_gpu=False, use_multi_gpu=False, w_lin=0.01)
Use CPU
>>>>>>>start training : long_term_forecast_DiscoveryPassage_and_others_720_360_96_FUSST_custom_ftM_sl360_ll24_pl360_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
Chlorophyll (ug/l) Chlorophyll (ug/l)
train 33011
Chlorophyll (ug/l) Chlorophyll (ug/l)
val 4461
Chlorophyll (ug/l) Chlorophyll (ug/l)
test 9278
Parameters: 4.25716
	iters: 100, epoch: 1 | loss: 0.2829388
	speed: 0.1080s/iter; left time: 2216.9725s
	iters: 200, epoch: 1 | loss: 0.3198747
	speed: 0.1110s/iter; left time: 2267.2969s
	iters: 300, epoch: 1 | loss: 0.3376831
	speed: 0.1109s/iter; left time: 2254.1535s
	iters: 400, epoch: 1 | loss: 0.2106445
	speed: 0.1091s/iter; left time: 2206.1026s
	iters: 500, epoch: 1 | loss: 0.3271493
	speed: 0.1091s/iter; left time: 2194.3455s
	iters: 600, epoch: 1 | loss: 0.3170611
	speed: 0.1153s/iter; left time: 2308.3893s
	iters: 700, epoch: 1 | loss: 0.2496946
	speed: 0.1110s/iter; left time: 2211.2946s
	iters: 800, epoch: 1 | loss: 0.2407288
	speed: 0.1127s/iter; left time: 2234.1988s
	iters: 900, epoch: 1 | loss: 0.2811360
	speed: 0.1181s/iter; left time: 2328.5142s
	iters: 1000, epoch: 1 | loss: 0.4353600
	speed: 0.1174s/iter; left time: 2303.1200s
Epoch: 1 cost time: 116.18372821807861
Epoch: 1, Steps: 1031 | Train Loss: 0.4031215 Vali Loss: 0.4140628 Test Loss: 2.1265233
Validation loss decreased (inf --> 0.414063).  Saving model ...
Updating learning rate to 0.0001
Parameters: 4.25716
	iters: 100, epoch: 2 | loss: 0.4806575
	speed: 1.0355s/iter; left time: 20182.2135s
	iters: 200, epoch: 2 | loss: 0.3520692
	speed: 0.1107s/iter; left time: 2147.0525s
	iters: 300, epoch: 2 | loss: 0.2898492
	speed: 0.1076s/iter; left time: 2075.1158s
	iters: 400, epoch: 2 | loss: 0.4774872
	speed: 0.1110s/iter; left time: 2130.9680s
	iters: 500, epoch: 2 | loss: 0.2876963
	speed: 0.1122s/iter; left time: 2140.9764s
	iters: 600, epoch: 2 | loss: 0.2060097
	speed: 0.1117s/iter; left time: 2121.9397s
	iters: 700, epoch: 2 | loss: 0.3550122
	speed: 0.1117s/iter; left time: 2109.0886s
	iters: 800, epoch: 2 | loss: 0.3125185
	speed: 0.1118s/iter; left time: 2101.1933s
	iters: 900, epoch: 2 | loss: 0.3638349
	speed: 0.1135s/iter; left time: 2121.2115s
	iters: 1000, epoch: 2 | loss: 0.2903265
	speed: 0.1122s/iter; left time: 2085.5513s
Epoch: 2 cost time: 115.21438026428223
Epoch: 2, Steps: 1031 | Train Loss: 0.3567797 Vali Loss: 0.4214747 Test Loss: 2.1207118
EarlyStopping counter: 1 out of 5
Updating learning rate to 5e-05
Parameters: 4.25716
	iters: 100, epoch: 3 | loss: 0.2252661
	speed: 1.0090s/iter; left time: 18625.5486s
	iters: 200, epoch: 3 | loss: 0.2819715
	speed: 0.1118s/iter; left time: 2052.1950s
	iters: 300, epoch: 3 | loss: 0.3589341
	speed: 0.1120s/iter; left time: 2044.2603s
	iters: 400, epoch: 3 | loss: 0.3089761
	speed: 0.1055s/iter; left time: 1916.5705s
	iters: 500, epoch: 3 | loss: 0.2223244
	speed: 0.1093s/iter; left time: 1974.1850s
	iters: 600, epoch: 3 | loss: 0.3468110
	speed: 0.1114s/iter; left time: 2000.9104s
	iters: 700, epoch: 3 | loss: 0.3395804
	speed: 0.1129s/iter; left time: 2015.7703s
	iters: 800, epoch: 3 | loss: 0.4719917
	speed: 0.1124s/iter; left time: 1995.5381s
	iters: 900, epoch: 3 | loss: 0.5485120
	speed: 0.1117s/iter; left time: 1971.8486s
	iters: 1000, epoch: 3 | loss: 0.2583979
	speed: 0.1098s/iter; left time: 1928.6034s
Epoch: 3 cost time: 114.29407954216003
Epoch: 3, Steps: 1031 | Train Loss: 0.3341911 Vali Loss: 0.4287878 Test Loss: 2.1454418
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.5e-05
Parameters: 4.25716
	iters: 100, epoch: 4 | loss: 0.2824178
	speed: 1.0249s/iter; left time: 17862.1264s
	iters: 200, epoch: 4 | loss: 0.3512096
	speed: 0.1143s/iter; left time: 1980.0148s
	iters: 300, epoch: 4 | loss: 0.3919902
	speed: 0.1093s/iter; left time: 1882.4526s
	iters: 400, epoch: 4 | loss: 0.3348370
	speed: 0.1025s/iter; left time: 1754.9093s
	iters: 500, epoch: 4 | loss: 0.3176474
	speed: 0.1010s/iter; left time: 1720.4637s
	iters: 600, epoch: 4 | loss: 0.3691289
	speed: 0.1082s/iter; left time: 1830.9488s
	iters: 700, epoch: 4 | loss: 0.2887280
	speed: 0.1178s/iter; left time: 1981.8409s
	iters: 800, epoch: 4 | loss: 0.2365084
	speed: 0.1180s/iter; left time: 1974.5460s
	iters: 900, epoch: 4 | loss: 0.3218725
	speed: 0.1142s/iter; left time: 1898.1783s
	iters: 1000, epoch: 4 | loss: 0.1727264
	speed: 0.1150s/iter; left time: 1901.1151s
Epoch: 4 cost time: 114.59015989303589
Epoch: 4, Steps: 1031 | Train Loss: 0.3233367 Vali Loss: 0.4359171 Test Loss: 2.1820757
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.25e-05
Parameters: 4.25716
	iters: 100, epoch: 5 | loss: 0.3072549
	speed: 1.1078s/iter; left time: 18165.0005s
	iters: 200, epoch: 5 | loss: 0.3035831
	speed: 0.1108s/iter; left time: 1806.0740s
	iters: 300, epoch: 5 | loss: 0.2568437
	speed: 0.1105s/iter; left time: 1790.2329s
	iters: 400, epoch: 5 | loss: 0.1496736
	speed: 0.1037s/iter; left time: 1668.5471s
	iters: 500, epoch: 5 | loss: 0.3597257
	speed: 0.1099s/iter; left time: 1757.8463s
	iters: 600, epoch: 5 | loss: 0.3668795
	speed: 0.1036s/iter; left time: 1647.1429s
	iters: 700, epoch: 5 | loss: 0.3268367
	speed: 0.1073s/iter; left time: 1694.7209s
	iters: 800, epoch: 5 | loss: 0.3127731
	speed: 0.1105s/iter; left time: 1735.2336s
	iters: 900, epoch: 5 | loss: 0.1998589
	speed: 0.1110s/iter; left time: 1730.5619s
	iters: 1000, epoch: 5 | loss: 0.3183779
	speed: 0.1153s/iter; left time: 1787.4546s
Epoch: 5 cost time: 113.13608384132385
Epoch: 5, Steps: 1031 | Train Loss: 0.3183471 Vali Loss: 0.4383185 Test Loss: 2.1954966
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.25e-06
Parameters: 4.25716
	iters: 100, epoch: 6 | loss: 0.2214901
	speed: 1.0394s/iter; left time: 15970.7986s
	iters: 200, epoch: 6 | loss: 0.2718237
	speed: 0.1183s/iter; left time: 1805.7211s
	iters: 300, epoch: 6 | loss: 0.3984320
	speed: 0.1132s/iter; left time: 1716.4179s
	iters: 400, epoch: 6 | loss: 0.3053235
	speed: 0.1082s/iter; left time: 1630.6413s
	iters: 500, epoch: 6 | loss: 0.3668989
	speed: 0.1108s/iter; left time: 1658.4613s
	iters: 600, epoch: 6 | loss: 0.3355696
	speed: 0.1093s/iter; left time: 1625.3829s
	iters: 700, epoch: 6 | loss: 0.5209484
	speed: 0.1122s/iter; left time: 1657.3294s
	iters: 800, epoch: 6 | loss: 0.3161106
	speed: 0.1079s/iter; left time: 1582.8676s
	iters: 900, epoch: 6 | loss: 0.2767028
	speed: 0.1100s/iter; left time: 1602.5613s
	iters: 1000, epoch: 6 | loss: 0.3132021
	speed: 0.1038s/iter; left time: 1502.0950s
Epoch: 6 cost time: 113.73814463615417
Epoch: 6, Steps: 1031 | Train Loss: 0.3157951 Vali Loss: 0.4394670 Test Loss: 2.2116470
EarlyStopping counter: 5 out of 5
Updating learning rate to 3.125e-06
Early stopping
>>>>>>>testing : long_term_forecast_DiscoveryPassage_and_others_720_360_96_FUSST_custom_ftM_sl360_ll24_pl360_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Chlorophyll (ug/l) Chlorophyll (ug/l)
test 9278
test shape: (9278, 1, 360, 8) (9278, 1, 360, 8)
test shape: (9278, 360, 8) (9278, 360, 8)
mse:2.1265225410461426, mae:0.6026824116706848





bash ./scripts/DiscoveryPassage_and_others_Script/FUSST.sh
MODEL IMPLEMENTED= FUSST
PREDICTION LENGTH= 336
SEQUENCE LENGTH= 336
LEARNING RATE ADJUSTMENT= type1
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=8, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='DiscoveryPassage_and_others_merged.csv', dec_in=8, des='Exp', devices='0,1,2,3', distil=True, dropout=0.1, e_layers=2, embed='timeF', enc_in=8, factor=3, features='M', freq='h', gpu=0, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='FUSST', model_id='DiscoveryPassage_and_others_720_360_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=336, root_path='./dataset/', seasonal_patterns='Monthly', seq_len=336, target='Chlorophyll (ug/l)', task_name='long_term_forecast', top_k=5, train_epochs=20, use_amp=False, use_gpu=False, use_multi_gpu=False, w_lin=0.01)
Use CPU
>>>>>>>start training : long_term_forecast_DiscoveryPassage_and_others_720_360_96_FUSST_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
Chlorophyll (ug/l) Chlorophyll (ug/l)
train 33059
Chlorophyll (ug/l) Chlorophyll (ug/l)
val 4485
Chlorophyll (ug/l) Chlorophyll (ug/l)
test 9302
Parameters: 3.892984
	iters: 100, epoch: 1 | loss: 0.4924503
	speed: 0.1528s/iter; left time: 3141.5092s
	iters: 200, epoch: 1 | loss: 0.3805559
	speed: 0.1767s/iter; left time: 3616.3301s
	iters: 300, epoch: 1 | loss: 0.4529744
	speed: 0.1926s/iter; left time: 3920.5480s
	iters: 400, epoch: 1 | loss: 0.3205625
	speed: 0.1753s/iter; left time: 3551.1081s
	iters: 500, epoch: 1 | loss: 0.2150431
	speed: 0.1671s/iter; left time: 3369.8820s
	iters: 600, epoch: 1 | loss: 0.3362184
	speed: 0.1456s/iter; left time: 2921.1273s
	iters: 700, epoch: 1 | loss: 0.2526111
	speed: 0.1507s/iter; left time: 3008.4791s
	iters: 800, epoch: 1 | loss: 0.2800413
	speed: 0.1519s/iter; left time: 3017.6864s
	iters: 900, epoch: 1 | loss: 0.3721791
	speed: 0.1576s/iter; left time: 3113.5125s
	iters: 1000, epoch: 1 | loss: 0.4496038
	speed: 0.1472s/iter; left time: 2894.4397s
Epoch: 1 cost time: 166.85560131072998
Epoch: 1, Steps: 1033 | Train Loss: 0.4011462 Vali Loss: 0.3949540 Test Loss: 2.0654445
Validation loss decreased (inf --> 0.394954).  Saving model ...
Updating learning rate to 0.0001
Parameters: 3.892984
	iters: 100, epoch: 2 | loss: 0.2927067
	speed: 1.6244s/iter; left time: 31721.1343s
	iters: 200, epoch: 2 | loss: 0.3467694
	speed: 0.1689s/iter; left time: 3281.3606s
	iters: 300, epoch: 2 | loss: 0.4046809
	speed: 0.1801s/iter; left time: 3481.4117s
	iters: 400, epoch: 2 | loss: 0.3053670
	speed: 0.1646s/iter; left time: 3164.9419s
	iters: 500, epoch: 2 | loss: 0.3291298
	speed: 0.1680s/iter; left time: 3214.2947s
	iters: 600, epoch: 2 | loss: 0.6276538
	speed: 0.1689s/iter; left time: 3214.2618s
	iters: 700, epoch: 2 | loss: 0.2958814
	speed: 0.1709s/iter; left time: 3234.9567s
	iters: 800, epoch: 2 | loss: 0.3604006
	speed: 0.1675s/iter; left time: 3154.2337s
	iters: 900, epoch: 2 | loss: 0.4361189
	speed: 0.1659s/iter; left time: 3107.3010s
	iters: 1000, epoch: 2 | loss: 0.4412201
	speed: 0.1665s/iter; left time: 3102.4316s
Epoch: 2 cost time: 174.89459705352783
Epoch: 2, Steps: 1033 | Train Loss: 0.3576659 Vali Loss: 0.4008718 Test Loss: 2.0699985
EarlyStopping counter: 1 out of 5
Updating learning rate to 5e-05
Parameters: 3.892984
	iters: 100, epoch: 3 | loss: 0.2440607
	speed: 1.6297s/iter; left time: 30141.4882s
	iters: 200, epoch: 3 | loss: 0.3968969
	speed: 0.1640s/iter; left time: 3016.5167s
	iters: 300, epoch: 3 | loss: 0.4168265
	speed: 0.1669s/iter; left time: 3052.8311s
	iters: 400, epoch: 3 | loss: 0.4353980
	speed: 0.1680s/iter; left time: 3056.4407s
	iters: 500, epoch: 3 | loss: 0.2754532
	speed: 0.1678s/iter; left time: 3036.7801s
	iters: 600, epoch: 3 | loss: 0.4985910
	speed: 0.1680s/iter; left time: 3023.3855s
	iters: 700, epoch: 3 | loss: 0.4033841
	speed: 0.1693s/iter; left time: 3029.2178s
	iters: 800, epoch: 3 | loss: 0.3766668
	speed: 0.1644s/iter; left time: 2925.6245s
	iters: 900, epoch: 3 | loss: 0.4189438
	speed: 0.1649s/iter; left time: 2918.2993s
	iters: 1000, epoch: 3 | loss: 0.4645346
	speed: 0.1699s/iter; left time: 2990.0591s
Epoch: 3 cost time: 172.881183385849
Epoch: 3, Steps: 1033 | Train Loss: 0.3361409 Vali Loss: 0.4091023 Test Loss: 2.0955179
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.5e-05
Parameters: 3.892984
	iters: 100, epoch: 4 | loss: 0.2436396
	speed: 1.7444s/iter; left time: 30460.2034s
	iters: 200, epoch: 4 | loss: 0.2045917
	speed: 0.1760s/iter; left time: 3056.1083s
	iters: 300, epoch: 4 | loss: 0.2661379
	speed: 0.1857s/iter; left time: 3205.5072s
	iters: 400, epoch: 4 | loss: 0.3079351
	speed: 0.1745s/iter; left time: 2994.3293s
	iters: 500, epoch: 4 | loss: 0.3051999
	speed: 0.1849s/iter; left time: 3154.7434s
	iters: 600, epoch: 4 | loss: 0.1945641
	speed: 0.1895s/iter; left time: 3215.0560s
	iters: 700, epoch: 4 | loss: 0.2476989
	speed: 0.1745s/iter; left time: 2942.6292s
	iters: 800, epoch: 4 | loss: 0.3456100
	speed: 0.1680s/iter; left time: 2816.5344s
	iters: 900, epoch: 4 | loss: 0.3176826
	speed: 0.1681s/iter; left time: 2801.5449s
	iters: 1000, epoch: 4 | loss: 0.2865889
	speed: 0.1714s/iter; left time: 2839.2517s
Epoch: 4 cost time: 185.24956250190735
Epoch: 4, Steps: 1033 | Train Loss: 0.3259291 Vali Loss: 0.4103329 Test Loss: 2.0990236
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.25e-05
Parameters: 3.892984
	iters: 100, epoch: 5 | loss: 0.2875398
	speed: 1.6651s/iter; left time: 27355.8265s
	iters: 200, epoch: 5 | loss: 0.3834579
	speed: 0.1703s/iter; left time: 2780.7908s
	iters: 300, epoch: 5 | loss: 0.3394435
	speed: 0.1666s/iter; left time: 2703.1651s
	iters: 400, epoch: 5 | loss: 0.2437899
	speed: 0.1682s/iter; left time: 2712.1294s
	iters: 500, epoch: 5 | loss: 0.2508382
	speed: 0.1620s/iter; left time: 2595.9591s
	iters: 600, epoch: 5 | loss: 0.2729713
	speed: 0.1697s/iter; left time: 2703.0886s
	iters: 700, epoch: 5 | loss: 0.3131968
	speed: 0.1694s/iter; left time: 2682.0514s
	iters: 800, epoch: 5 | loss: 0.3478314
	speed: 0.1710s/iter; left time: 2689.4533s
	iters: 900, epoch: 5 | loss: 0.3188050
	speed: 0.1684s/iter; left time: 2632.6084s
	iters: 1000, epoch: 5 | loss: 0.2671434
	speed: 0.1645s/iter; left time: 2554.7875s
Epoch: 5 cost time: 173.0501639842987
Epoch: 5, Steps: 1033 | Train Loss: 0.3209920 Vali Loss: 0.4147027 Test Loss: 2.1001222
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.25e-06
Parameters: 3.892984
	iters: 100, epoch: 6 | loss: 0.2322655
	speed: 1.6508s/iter; left time: 25416.3226s
	iters: 200, epoch: 6 | loss: 0.2567024
	speed: 0.1692s/iter; left time: 2587.9886s
	iters: 300, epoch: 6 | loss: 0.3429273
	speed: 0.1684s/iter; left time: 2559.2134s
	iters: 400, epoch: 6 | loss: 0.3055179
	speed: 0.1677s/iter; left time: 2531.4577s
	iters: 500, epoch: 6 | loss: 0.2758939
	speed: 0.1724s/iter; left time: 2584.7637s
	iters: 600, epoch: 6 | loss: 0.1713587
	speed: 0.1683s/iter; left time: 2506.9816s
	iters: 700, epoch: 6 | loss: 0.4341192
	speed: 0.1651s/iter; left time: 2442.7873s
	iters: 800, epoch: 6 | loss: 0.2412063
	speed: 0.1622s/iter; left time: 2383.7220s
	iters: 900, epoch: 6 | loss: 0.2377546
	speed: 0.1717s/iter; left time: 2506.0496s
	iters: 1000, epoch: 6 | loss: 0.2021993
	speed: 0.1654s/iter; left time: 2397.7012s
Epoch: 6 cost time: 173.6141905784607
Epoch: 6, Steps: 1033 | Train Loss: 0.3186055 Vali Loss: 0.4160234 Test Loss: 2.0934374
EarlyStopping counter: 5 out of 5
Updating learning rate to 3.125e-06
Early stopping
>>>>>>>testing : long_term_forecast_DiscoveryPassage_and_others_720_360_96_FUSST_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Chlorophyll (ug/l) Chlorophyll (ug/l)
test 9302
test shape: (9302, 1, 336, 8) (9302, 1, 336, 8)
test shape: (9302, 336, 8) (9302, 336, 8)
mse:2.0654447078704834, mae:0.5887762904167175





bash ./scripts/DiscoveryPassage_and_others_Script/FUSST.sh
MODEL IMPLEMENTED= FUSST
PREDICTION LENGTH= 720
SEQUENCE LENGTH= 720
LEARNING RATE ADJUSTMENT= type1
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=8, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='DiscoveryPassage_and_others_merged.csv', dec_in=8, des='Exp', devices='0,1,2,3', distil=True, dropout=0.1, e_layers=2, embed='timeF', enc_in=8, factor=3, features='M', freq='h', gpu=0, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='FUSST', model_id='DiscoveryPassage_and_others_720_360_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=720, root_path='./dataset/', seasonal_patterns='Monthly', seq_len=720, target='Chlorophyll (ug/l)', task_name='long_term_forecast', top_k=5, train_epochs=20, use_amp=False, use_gpu=False, use_multi_gpu=False, w_lin=0.01)
Use CPU
>>>>>>>start training : long_term_forecast_DiscoveryPassage_and_others_720_360_96_FUSST_custom_ftM_sl720_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
Chlorophyll (ug/l) Chlorophyll (ug/l)
train 32291
Chlorophyll (ug/l) Chlorophyll (ug/l)
val 4101
Chlorophyll (ug/l) Chlorophyll (ug/l)
test 8918
Parameters: 11.1022
	iters: 100, epoch: 1 | loss: 0.6175330
	speed: 0.3777s/iter; left time: 7585.5265s
	iters: 200, epoch: 1 | loss: 0.4057451
	speed: 0.3889s/iter; left time: 7770.1734s
	iters: 300, epoch: 1 | loss: 0.4675917
	speed: 0.3675s/iter; left time: 7306.3942s
	iters: 400, epoch: 1 | loss: 0.5190539
	speed: 0.3608s/iter; left time: 7136.9622s
	iters: 500, epoch: 1 | loss: 0.4209979
	speed: 0.3704s/iter; left time: 7290.7496s
	iters: 600, epoch: 1 | loss: 0.4614912
	speed: 0.3548s/iter; left time: 6947.2973s
	iters: 700, epoch: 1 | loss: 0.3658894
	speed: 0.3569s/iter; left time: 6952.2529s
	iters: 800, epoch: 1 | loss: 0.4317559
	speed: 0.3575s/iter; left time: 6928.1510s
	iters: 900, epoch: 1 | loss: 0.3595015
	speed: 0.3655s/iter; left time: 7047.3039s
	iters: 1000, epoch: 1 | loss: 0.4011306
	speed: 0.3640s/iter; left time: 6981.5886s
Epoch: 1 cost time: 369.7680413722992
Epoch: 1, Steps: 1009 | Train Loss: 0.4293635 Vali Loss: 0.7605293 Test Loss: 3.2964234
Validation loss decreased (inf --> 0.760529).  Saving model ...
Updating learning rate to 0.0001
Parameters: 11.1022
	iters: 100, epoch: 2 | loss: 0.4162135
	speed: 2.9101s/iter; left time: 55500.8815s
	iters: 200, epoch: 2 | loss: 0.3058365
	speed: 0.3613s/iter; left time: 6853.7301s
	iters: 300, epoch: 2 | loss: 0.3728504
	speed: 0.3615s/iter; left time: 6821.4011s
	iters: 400, epoch: 2 | loss: 0.2783006
	speed: 0.3621s/iter; left time: 6796.5395s
	iters: 500, epoch: 2 | loss: 0.3119536
	speed: 0.3608s/iter; left time: 6737.5477s
	iters: 600, epoch: 2 | loss: 0.2675224
	speed: 0.3590s/iter; left time: 6667.8498s
	iters: 700, epoch: 2 | loss: 0.6574208
	speed: 0.3613s/iter; left time: 6674.6307s
	iters: 800, epoch: 2 | loss: 0.3611204
	speed: 0.3542s/iter; left time: 6507.1433s
	iters: 900, epoch: 2 | loss: 0.3731258
	speed: 0.3635s/iter; left time: 6641.5262s
	iters: 1000, epoch: 2 | loss: 0.3552577
	speed: 0.3579s/iter; left time: 6503.6312s
Epoch: 2 cost time: 364.28106808662415
Epoch: 2, Steps: 1009 | Train Loss: 0.3584613 Vali Loss: 0.7878827 Test Loss: 3.3342714
EarlyStopping counter: 1 out of 5
Updating learning rate to 5e-05
Parameters: 11.1022
	iters: 100, epoch: 3 | loss: 0.4860013
	speed: 2.9055s/iter; left time: 52482.6780s
	iters: 200, epoch: 3 | loss: 0.2402649
	speed: 0.3558s/iter; left time: 6390.9943s
	iters: 300, epoch: 3 | loss: 0.3225640
	speed: 0.3612s/iter; left time: 6451.5840s
	iters: 400, epoch: 3 | loss: 0.4145656
	speed: 0.3647s/iter; left time: 6477.2908s
	iters: 500, epoch: 3 | loss: 0.2989153
	speed: 0.3543s/iter; left time: 6258.3337s
	iters: 600, epoch: 3 | loss: 0.3687168
	speed: 0.3588s/iter; left time: 6302.3380s
	iters: 700, epoch: 3 | loss: 0.3120234
	speed: 0.3612s/iter; left time: 6308.3537s
	iters: 800, epoch: 3 | loss: 0.1805010
	speed: 0.3509s/iter; left time: 6093.1748s
	iters: 900, epoch: 3 | loss: 0.3791443
	speed: 0.3488s/iter; left time: 6021.2128s
	iters: 1000, epoch: 3 | loss: 0.2781035
	speed: 0.3581s/iter; left time: 6145.3856s
Epoch: 3 cost time: 360.34170293807983
Epoch: 3, Steps: 1009 | Train Loss: 0.3257342 Vali Loss: 0.7632967 Test Loss: 3.4471180
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.5e-05
Parameters: 11.1022
	iters: 100, epoch: 4 | loss: 0.2587621
	speed: 2.9176s/iter; left time: 49756.4622s
	iters: 200, epoch: 4 | loss: 0.3887886
	speed: 0.3623s/iter; left time: 6142.0662s
	iters: 300, epoch: 4 | loss: 0.3782128
	speed: 0.3699s/iter; left time: 6234.8933s
	iters: 400, epoch: 4 | loss: 0.3106990
	speed: 0.3633s/iter; left time: 6086.6477s
	iters: 500, epoch: 4 | loss: 0.2632732
	speed: 0.3626s/iter; left time: 6038.7706s
	iters: 600, epoch: 4 | loss: 0.3440239
	speed: 0.3640s/iter; left time: 6025.9239s
	iters: 700, epoch: 4 | loss: 0.3487551
	speed: 0.3562s/iter; left time: 5861.3458s
	iters: 800, epoch: 4 | loss: 0.3162296
	speed: 0.3587s/iter; left time: 5866.6108s
	iters: 900, epoch: 4 | loss: 0.2924839
	speed: 0.3621s/iter; left time: 5884.7831s
	iters: 1000, epoch: 4 | loss: 0.2487018
	speed: 0.3668s/iter; left time: 5925.6280s
Epoch: 4 cost time: 366.3974025249481
Epoch: 4, Steps: 1009 | Train Loss: 0.3101204 Vali Loss: 0.7468567 Test Loss: 3.3314500
Validation loss decreased (0.760529 --> 0.746857).  Saving model ...
Updating learning rate to 1.25e-05
Parameters: 11.1022
	iters: 100, epoch: 5 | loss: 0.3427660
	speed: 2.9244s/iter; left time: 46922.7781s
	iters: 200, epoch: 5 | loss: 0.2337544
	speed: 0.3626s/iter; left time: 5782.2502s
	iters: 300, epoch: 5 | loss: 0.3404547
	speed: 0.3635s/iter; left time: 5759.6487s
	iters: 400, epoch: 5 | loss: 0.2387854
	speed: 0.3665s/iter; left time: 5770.3008s
	iters: 500, epoch: 5 | loss: 0.3396662
	speed: 0.3913s/iter; left time: 6121.7476s
	iters: 600, epoch: 5 | loss: 0.4513713
	speed: 0.3956s/iter; left time: 6149.7010s
	iters: 700, epoch: 5 | loss: 0.3937947
	speed: 0.3951s/iter; left time: 6101.7048s
	iters: 800, epoch: 5 | loss: 0.2822008
	speed: 0.3867s/iter; left time: 5933.6835s
	iters: 900, epoch: 5 | loss: 0.3375548
	speed: 0.3858s/iter; left time: 5880.9395s
	iters: 1000, epoch: 5 | loss: 0.3537682
	speed: 0.3854s/iter; left time: 5836.6896s
Epoch: 5 cost time: 383.3244676589966
Epoch: 5, Steps: 1009 | Train Loss: 0.3026179 Vali Loss: 0.7367126 Test Loss: 3.3316765
Validation loss decreased (0.746857 --> 0.736713).  Saving model ...
Updating learning rate to 6.25e-06
Parameters: 11.1022
	iters: 100, epoch: 6 | loss: 0.3999588
	speed: 2.8240s/iter; left time: 42462.3088s
	iters: 200, epoch: 6 | loss: 0.2910248
	speed: 0.3459s/iter; left time: 5166.9050s
	iters: 300, epoch: 6 | loss: 0.3066284
	speed: 0.3485s/iter; left time: 5170.3233s
	iters: 400, epoch: 6 | loss: 0.2583055
	speed: 0.3511s/iter; left time: 5173.7786s
	iters: 500, epoch: 6 | loss: 0.2795599
	speed: 0.3390s/iter; left time: 4962.0879s
	iters: 600, epoch: 6 | loss: 0.2950761
	speed: 0.3497s/iter; left time: 5082.6807s
	iters: 700, epoch: 6 | loss: 0.3213174
	speed: 0.3412s/iter; left time: 4925.5649s
	iters: 800, epoch: 6 | loss: 0.1944753
	speed: 0.3429s/iter; left time: 4916.3660s
	iters: 900, epoch: 6 | loss: 0.1857893
	speed: 0.3503s/iter; left time: 4986.7870s
	iters: 1000, epoch: 6 | loss: 0.2986907
	speed: 0.3468s/iter; left time: 4902.8542s
Epoch: 6 cost time: 349.68152618408203
Epoch: 6, Steps: 1009 | Train Loss: 0.2988413 Vali Loss: 0.7275221 Test Loss: 3.3482425
Validation loss decreased (0.736713 --> 0.727522).  Saving model ...
Updating learning rate to 3.125e-06
Parameters: 11.1022
	iters: 100, epoch: 7 | loss: 0.2261841
	speed: 2.8035s/iter; left time: 39324.2139s
	iters: 200, epoch: 7 | loss: 0.2113401
	speed: 0.3561s/iter; left time: 4959.7367s
	iters: 300, epoch: 7 | loss: 0.3751935
	speed: 0.3539s/iter; left time: 4893.7617s
	iters: 400, epoch: 7 | loss: 0.2617450
	speed: 0.3600s/iter; left time: 4942.2409s
	iters: 500, epoch: 7 | loss: 0.3253945
	speed: 0.3620s/iter; left time: 4933.2811s
	iters: 600, epoch: 7 | loss: 0.3508462
	speed: 0.3690s/iter; left time: 4991.3220s
	iters: 700, epoch: 7 | loss: 0.2267704
	speed: 0.3794s/iter; left time: 5094.3933s
	iters: 800, epoch: 7 | loss: 0.3917194
	speed: 0.3681s/iter; left time: 4905.3829s
	iters: 900, epoch: 7 | loss: 0.2447710
	speed: 0.3635s/iter; left time: 4807.7858s
	iters: 1000, epoch: 7 | loss: 0.2391742
	speed: 0.4240s/iter; left time: 5566.5041s
Epoch: 7 cost time: 374.9495646953583
Epoch: 7, Steps: 1009 | Train Loss: 0.2971930 Vali Loss: 0.7425504 Test Loss: 3.3262110
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.5625e-06
Parameters: 11.1022
	iters: 100, epoch: 8 | loss: 0.3468714
	speed: 3.2330s/iter; left time: 42087.1982s
	iters: 200, epoch: 8 | loss: 0.2751200
	speed: 0.3888s/iter; left time: 5022.5828s
	iters: 300, epoch: 8 | loss: 0.3965375
	speed: 0.4027s/iter; left time: 5161.5133s
	iters: 400, epoch: 8 | loss: 0.2365821
	speed: 0.4209s/iter; left time: 5353.3544s
	iters: 500, epoch: 8 | loss: 0.2906856
	speed: 0.3691s/iter; left time: 4657.5916s
	iters: 600, epoch: 8 | loss: 0.2384474
	speed: 0.3670s/iter; left time: 4593.6745s
	iters: 700, epoch: 8 | loss: 0.2439237
	speed: 0.3667s/iter; left time: 4553.3511s
	iters: 800, epoch: 8 | loss: 0.4352333
	speed: 0.3629s/iter; left time: 4469.8323s
	iters: 900, epoch: 8 | loss: 0.2459550
	speed: 0.3724s/iter; left time: 4549.9146s
	iters: 1000, epoch: 8 | loss: 0.3182709
	speed: 0.3712s/iter; left time: 4498.6281s
Epoch: 8 cost time: 388.02578139305115
Epoch: 8, Steps: 1009 | Train Loss: 0.2962136 Vali Loss: 0.7338252 Test Loss: 3.3423207
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.8125e-07
Parameters: 11.1022
	iters: 100, epoch: 9 | loss: 0.2576870
	speed: 2.9258s/iter; left time: 35135.6626s
	iters: 200, epoch: 9 | loss: 0.2207805
	speed: 0.3712s/iter; left time: 4421.1474s
	iters: 300, epoch: 9 | loss: 0.2599238
	speed: 0.3699s/iter; left time: 4368.0256s
	iters: 400, epoch: 9 | loss: 0.2446759
	speed: 0.3644s/iter; left time: 4267.2893s
	iters: 500, epoch: 9 | loss: 0.2544906
	speed: 0.3670s/iter; left time: 4260.4868s
	iters: 600, epoch: 9 | loss: 0.2496510
	speed: 0.3580s/iter; left time: 4119.9921s
	iters: 700, epoch: 9 | loss: 0.4118745
	speed: 0.3548s/iter; left time: 4047.6557s
	iters: 800, epoch: 9 | loss: 0.4217267
	speed: 0.3668s/iter; left time: 4148.0121s
	iters: 900, epoch: 9 | loss: 0.3496534
	speed: 0.3593s/iter; left time: 4027.2102s
	iters: 1000, epoch: 9 | loss: 0.3102532
	speed: 0.3645s/iter; left time: 4049.1087s
Epoch: 9 cost time: 368.03298473358154
Epoch: 9, Steps: 1009 | Train Loss: 0.2957987 Vali Loss: 0.7416023 Test Loss: 3.3404582
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.90625e-07
Parameters: 11.1022
	iters: 100, epoch: 10 | loss: 0.3522605
	speed: 2.9612s/iter; left time: 32572.7876s
	iters: 200, epoch: 10 | loss: 0.3302911
	speed: 0.3663s/iter; left time: 3992.2197s
	iters: 300, epoch: 10 | loss: 0.4036207
	speed: 0.3612s/iter; left time: 3900.4401s
	iters: 400, epoch: 10 | loss: 0.2798429
	speed: 0.3656s/iter; left time: 3912.2173s
	iters: 500, epoch: 10 | loss: 0.2960093
	speed: 0.3673s/iter; left time: 3892.9208s
	iters: 600, epoch: 10 | loss: 0.2508748
	speed: 0.3623s/iter; left time: 3804.1961s
	iters: 700, epoch: 10 | loss: 0.2843731
	speed: 0.3625s/iter; left time: 3770.2381s
	iters: 800, epoch: 10 | loss: 0.3370262
	speed: 0.3666s/iter; left time: 3776.1481s
	iters: 900, epoch: 10 | loss: 0.2367036
	speed: 0.3655s/iter; left time: 3727.7804s
	iters: 1000, epoch: 10 | loss: 0.2939762
	speed: 0.3668s/iter; left time: 3704.2738s
Epoch: 10 cost time: 368.5987358093262
Epoch: 10, Steps: 1009 | Train Loss: 0.2955245 Vali Loss: 0.7402842 Test Loss: 3.3378057
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.953125e-07
Parameters: 11.1022
	iters: 100, epoch: 11 | loss: 0.2865119
	speed: 2.9067s/iter; left time: 29040.4761s
	iters: 200, epoch: 11 | loss: 0.3398450
	speed: 0.3644s/iter; left time: 3603.9185s
	iters: 300, epoch: 11 | loss: 0.1875455
	speed: 0.3662s/iter; left time: 3585.0377s
	iters: 400, epoch: 11 | loss: 0.1688237
	speed: 0.3588s/iter; left time: 3477.2931s
	iters: 500, epoch: 11 | loss: 0.3823825
	speed: 0.3678s/iter; left time: 3527.7972s
	iters: 600, epoch: 11 | loss: 0.3427135
	speed: 0.3674s/iter; left time: 3486.7504s
	iters: 700, epoch: 11 | loss: 0.3787331
	speed: 0.3747s/iter; left time: 3518.8700s
	iters: 800, epoch: 11 | loss: 0.4678454
	speed: 0.3671s/iter; left time: 3411.1290s
	iters: 900, epoch: 11 | loss: 0.2448360
	speed: 0.3732s/iter; left time: 3429.9030s
	iters: 1000, epoch: 11 | loss: 0.2244921
	speed: 0.3677s/iter; left time: 3342.8323s
Epoch: 11 cost time: 371.00358271598816
Epoch: 11, Steps: 1009 | Train Loss: 0.2953287 Vali Loss: 0.7374054 Test Loss: 3.3342323
EarlyStopping counter: 5 out of 5
Updating learning rate to 9.765625e-08
Early stopping
>>>>>>>testing : long_term_forecast_DiscoveryPassage_and_others_720_360_96_FUSST_custom_ftM_sl720_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Chlorophyll (ug/l) Chlorophyll (ug/l)
test 8918
test shape: (8918, 1, 720, 8) (8918, 1, 720, 8)
test shape: (8918, 720, 8) (8918, 720, 8)
mse:3.3482394218444824, mae:0.832334578037262


doug@V2K-Chinmay:~/Desktop/Experiments/src/fusst$ bash ./scripts/DiscoveryPassage_and_others_Script/FUSST.sh
/usr/local/bin/python3
MODEL IMPLEMENTED= FUSST
PREDICTION LENGTH= 1440
SEQUENCE LENGTH= 1440
LEARNING RATE ADJUSTMENT= type1
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=8, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='DiscoveryPassage_and_others_merged.csv', dec_in=8, des='Exp', devices='0,1,2,3', distil=True, dropout=0.1, e_layers=2, embed='timeF', enc_in=8, factor=3, features='M', freq='h', gpu=0, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='FUSST', model_id='DiscoveryPassage_and_others_720_360_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=1440, root_path='./dataset/', seasonal_patterns='Monthly', seq_len=1440, target='Chlorophyll (ug/l)', task_name='long_term_forecast', top_k=5, train_epochs=20, use_amp=False, use_gpu=False, use_multi_gpu=False, w_lin=0.01)
Use CPU
>>>>>>>start training : long_term_forecast_DiscoveryPassage_and_others_720_360_96_FUSST_custom_ftM_sl1440_ll48_pl1440_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
Chlorophyll (ug/l) Chlorophyll (ug/l)
train 30851
Chlorophyll (ug/l) Chlorophyll (ug/l)
val 3381
Chlorophyll (ug/l) Chlorophyll (ug/l)
test 8198
Parameters: 32.56828
	iters: 100, epoch: 1 | loss: 0.6094666
	speed: 0.4341s/iter; left time: 8327.0165s
	iters: 200, epoch: 1 | loss: 0.8216696
	speed: 0.4818s/iter; left time: 9192.5386s
	iters: 300, epoch: 1 | loss: 0.6200919
	speed: 0.4993s/iter; left time: 9477.6397s
	iters: 400, epoch: 1 | loss: 0.4096255
	speed: 0.4990s/iter; left time: 9421.4092s
	iters: 500, epoch: 1 | loss: 0.3827711
	speed: 0.4998s/iter; left time: 9386.3516s
 	iters: 600, epoch: 1 | loss: 0.4862644
	speed: 0.4987s/iter; left time: 9316.2785s
	iters: 700, epoch: 1 | loss: 0.3492960
	speed: 0.4978s/iter; left time: 9248.7222s
	iters: 800, epoch: 1 | loss: 0.4323558
	speed: 0.5036s/iter; left time: 9306.4996s
	iters: 900, epoch: 1 | loss: 0.4378842
	speed: 0.4987s/iter; left time: 9167.4510s
Epoch: 1 cost time: 473.4852328300476
Epoch: 1, Steps: 964 | Train Loss: 0.4970636 Vali Loss: 1.6516302 Test Loss: 4.4841962
Validation loss decreased (inf --> 1.651630).  Saving model ...
Updating learning rate to 0.0001
Parameters: 32.56828
	iters: 100, epoch: 2 | loss: 0.3502562
	speed: 3.4073s/iter; left time: 62070.6327s
	iters: 200, epoch: 2 | loss: 0.4595299
	speed: 0.5018s/iter; left time: 9091.7745s
	iters: 300, epoch: 2 | loss: 0.4716304
	speed: 0.4981s/iter; left time: 8973.7106s
	iters: 400, epoch: 2 | loss: 0.4151912
	speed: 0.4985s/iter; left time: 8931.0048s
	iters: 500, epoch: 2 | loss: 0.3545542
	speed: 0.4988s/iter; left time: 8886.4078s
	iters: 600, epoch: 2 | loss: 0.4064558
	speed: 0.4949s/iter; left time: 8767.7941s
	iters: 700, epoch: 2 | loss: 0.3812043
	speed: 0.4984s/iter; left time: 8779.5059s
	iters: 800, epoch: 2 | loss: 0.2898272
	speed: 0.5193s/iter; left time: 9096.2139s
	iters: 900, epoch: 2 | loss: 0.2420269
	speed: 0.5395s/iter; left time: 9396.1845s
Epoch: 2 cost time: 488.8068859577179
Epoch: 2, Steps: 964 | Train Loss: 0.3623404 Vali Loss: 1.6490438 Test Loss: 4.4298201
Validation loss decreased (1.651630 --> 1.649044).  Saving model ...
Updating learning rate to 5e-05
Parameters: 32.56828
	iters: 100, epoch: 3 | loss: 0.3559908
	speed: 3.7528s/iter; left time: 64746.4830s
	iters: 200, epoch: 3 | loss: 0.4289261
	speed: 0.5267s/iter; left time: 9034.8816s
	iters: 300, epoch: 3 | loss: 0.3969527
	speed: 0.5637s/iter; left time: 9613.2062s
	iters: 400, epoch: 3 | loss: 0.3789434
	speed: 0.5146s/iter; left time: 8724.5825s
	iters: 500, epoch: 3 | loss: 0.1380761
	speed: 0.5128s/iter; left time: 8642.4821s
	iters: 600, epoch: 3 | loss: 0.3519481
	speed: 0.5121s/iter; left time: 8579.7608s
	iters: 700, epoch: 3 | loss: 0.3880193
	speed: 0.5106s/iter; left time: 8502.5502s
	iters: 800, epoch: 3 | loss: 0.2647050
	speed: 0.5140s/iter; left time: 8507.5133s
	iters: 900, epoch: 3 | loss: 0.2397829
	speed: 0.5114s/iter; left time: 8413.2723s
Epoch: 3 cost time: 508.2398245334625
Epoch: 3, Steps: 964 | Train Loss: 0.3170480 Vali Loss: 2.0673664 Test Loss: 4.2798085
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.5e-05
Parameters: 32.56828
	iters: 100, epoch: 4 | loss: 0.2528590
	speed: 3.6113s/iter; left time: 58824.8748s
	iters: 200, epoch: 4 | loss: 0.3370803
	speed: 0.5360s/iter; left time: 8677.7095s
	iters: 300, epoch: 4 | loss: 0.2574841
	speed: 0.4999s/iter; left time: 8042.9190s
	iters: 400, epoch: 4 | loss: 0.3428403
	speed: 0.5128s/iter; left time: 8199.1449s
	iters: 500, epoch: 4 | loss: 0.3206081
	speed: 0.5017s/iter; left time: 7971.2422s
	iters: 600, epoch: 4 | loss: 0.2449497
	speed: 0.5431s/iter; left time: 8575.5927s
	iters: 700, epoch: 4 | loss: 0.3217304
	speed: 0.5562s/iter; left time: 8725.8409s
	iters: 800, epoch: 4 | loss: 0.2838578
	speed: 0.5444s/iter; left time: 8486.3809s
	iters: 900, epoch: 4 | loss: 0.2324074
	speed: 0.5216s/iter; left time: 8079.5495s
Epoch: 4 cost time: 509.037211894989
Epoch: 4, Steps: 964 | Train Loss: 0.2986548 Vali Loss: 2.1468396 Test Loss: 4.3915296
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.25e-05
Parameters: 32.56828
	iters: 100, epoch: 5 | loss: 0.1882413
	speed: 3.9631s/iter; left time: 60735.2249s
	iters: 200, epoch: 5 | loss: 0.2368518
	speed: 0.5072s/iter; left time: 7722.2319s
	iters: 300, epoch: 5 | loss: 0.2274054
	speed: 0.5018s/iter; left time: 7590.0297s
	iters: 400, epoch: 5 | loss: 0.2813989
	speed: 0.4980s/iter; left time: 7483.1754s
	iters: 500, epoch: 5 | loss: 0.2057150
	speed: 0.5089s/iter; left time: 7595.3448s
	iters: 600, epoch: 5 | loss: 0.2439238
	speed: 0.5107s/iter; left time: 7571.0162s
	iters: 700, epoch: 5 | loss: 0.4084533
	speed: 0.5275s/iter; left time: 7767.8307s
	iters: 800, epoch: 5 | loss: 0.2108687
	speed: 0.5304s/iter; left time: 7756.9960s
	iters: 900, epoch: 5 | loss: 0.3390541
	speed: 0.5270s/iter; left time: 7654.4357s
Epoch: 5 cost time: 498.9530122280121
Epoch: 5, Steps: 964 | Train Loss: 0.2901670 Vali Loss: 2.2312274 Test Loss: 4.4289484
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.25e-06
Parameters: 32.56828
	iters: 100, epoch: 6 | loss: 0.2509236
	speed: 3.4261s/iter; left time: 49201.8519s
	iters: 200, epoch: 6 | loss: 0.1666733
	speed: 0.5140s/iter; left time: 7329.9306s
	iters: 300, epoch: 6 | loss: 0.3032778
	speed: 0.5427s/iter; left time: 7685.8130s
	iters: 400, epoch: 6 | loss: 0.3799471
	speed: 0.6087s/iter; left time: 8558.8786s
	iters: 500, epoch: 6 | loss: 0.2427637
	speed: 0.7545s/iter; left time: 10533.1113s
	iters: 600, epoch: 6 | loss: 0.2873960
	speed: 0.6233s/iter; left time: 8639.9466s
	iters: 700, epoch: 6 | loss: 0.2805749
	speed: 0.5818s/iter; left time: 8006.1948s
	iters: 800, epoch: 6 | loss: 0.2496439
	speed: 0.5067s/iter; left time: 6921.8642s
	iters: 900, epoch: 6 | loss: 0.3334824
	speed: 0.5180s/iter; left time: 7025.1247s
Epoch: 6 cost time: 548.6279079914093
Epoch: 6, Steps: 964 | Train Loss: 0.2860821 Vali Loss: 2.2186296 Test Loss: 4.4249725
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.125e-06
Parameters: 32.56828
	iters: 100, epoch: 7 | loss: 0.1947750
	speed: 3.4736s/iter; left time: 46535.3592s
	iters: 200, epoch: 7 | loss: 0.3301833
	speed: 0.5000s/iter; left time: 6648.1931s
	iters: 300, epoch: 7 | loss: 0.2811278
	speed: 0.5153s/iter; left time: 6800.0935s
	iters: 400, epoch: 7 | loss: 0.2610628
	speed: 0.5102s/iter; left time: 6682.4304s
	iters: 500, epoch: 7 | loss: 0.2532535
	speed: 0.5108s/iter; left time: 6638.7534s
	iters: 600, epoch: 7 | loss: 0.2672877
	speed: 0.5061s/iter; left time: 6527.0800s
	iters: 700, epoch: 7 | loss: 0.2927980
	speed: 0.5047s/iter; left time: 6458.8619s
	iters: 800, epoch: 7 | loss: 0.2687348
	speed: 0.5081s/iter; left time: 6451.1299s
	iters: 900, epoch: 7 | loss: 0.2561240
	speed: 0.5323s/iter; left time: 6705.0620s
Epoch: 7 cost time: 494.18515849113464
Epoch: 7, Steps: 964 | Train Loss: 0.2840858 Vali Loss: 2.2474165 Test Loss: 4.4866781
EarlyStopping counter: 5 out of 5
Updating learning rate to 1.5625e-06
Early stopping
>>>>>>>testing : long_term_forecast_DiscoveryPassage_and_others_720_360_96_FUSST_custom_ftM_sl1440_ll48_pl1440_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Chlorophyll (ug/l) Chlorophyll (ug/l)
test 8198
test shape: (8198, 1, 1440, 8) (8198, 1, 1440, 8)
test shape: (8198, 1440, 8) (8198, 1440, 8)
mse:4.429808616638184, mae:1.1396549940109253





MODEL IMPLEMENTED= FUSST
PREDICTION LENGTH= 24
SEQUENCE LENGTH= 192
LEARNING RATE ADJUSTMENT= type1
bash ./scripts/DiscoveryPassage_and_others_Script/FUSST.sh
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=8, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='DiscoveryPassage_and_others_merged.csv', dec_in=8, des='Exp', devices='0,1,2,3', distil=True, dropout=0.1, e_layers=2, embed='timeF', enc_in=8, factor=3, features='M', freq='h', gpu=0, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='FUSST', model_id='DiscoveryPassage_and_others_720_360_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=24, root_path='./dataset/', seasonal_patterns='Monthly', seq_len=192, target='Chlorophyll (ug/l)', task_name='long_term_forecast', top_k=5, train_epochs=20, use_amp=False, use_gpu=False, use_multi_gpu=False, w_lin=0.01)
Use CPU
>>>>>>>start training : long_term_forecast_DiscoveryPassage_and_others_720_360_96_FUSST_custom_ftM_sl192_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
Chlorophyll (ug/l) Chlorophyll (ug/l)
train 33515
Chlorophyll (ug/l) Chlorophyll (ug/l)
val 4797
Chlorophyll (ug/l) Chlorophyll (ug/l)
test 9614
Parameters: 1.885
	iters: 100, epoch: 1 | loss: 0.2461353
	speed: 0.0682s/iter; left time: 1420.4827s
	iters: 200, epoch: 1 | loss: 0.1558702
	speed: 0.0655s/iter; left time: 1359.4837s
	iters: 300, epoch: 1 | loss: 0.4555801
	speed: 0.0625s/iter; left time: 1290.5075s
	iters: 400, epoch: 1 | loss: 0.2923796
	speed: 0.0633s/iter; left time: 1301.1009s
	iters: 500, epoch: 1 | loss: 0.2917295
	speed: 0.0642s/iter; left time: 1313.0124s
	iters: 600, epoch: 1 | loss: 0.1634703
	speed: 0.0635s/iter; left time: 1292.3679s
	iters: 700, epoch: 1 | loss: 0.2531481
	speed: 0.0663s/iter; left time: 1341.8963s
	iters: 800, epoch: 1 | loss: 0.2069948
	speed: 0.0643s/iter; left time: 1295.0491s
	iters: 900, epoch: 1 | loss: 0.2262785
	speed: 0.0651s/iter; left time: 1305.2008s
	iters: 1000, epoch: 1 | loss: 0.3318053
	speed: 0.0659s/iter; left time: 1314.3833s
Epoch: 1 cost time: 67.98726105690002
Epoch: 1, Steps: 1047 | Train Loss: 0.2847267 Vali Loss: 0.1475463 Test Loss: 1.3297700
Validation loss decreased (inf --> 0.147546).  Saving model ...
Updating learning rate to 0.0001
Parameters: 1.885
	iters: 100, epoch: 2 | loss: 0.2166587
	speed: 0.6561s/iter; left time: 12987.7366s
	iters: 200, epoch: 2 | loss: 0.2514933
	speed: 0.0716s/iter; left time: 1409.9027s
	iters: 300, epoch: 2 | loss: 0.2351795
	speed: 0.0692s/iter; left time: 1356.4766s
	iters: 400, epoch: 2 | loss: 0.4183070
	speed: 0.0693s/iter; left time: 1349.9923s
	iters: 500, epoch: 2 | loss: 0.3130374
	speed: 0.0747s/iter; left time: 1449.0966s
	iters: 600, epoch: 2 | loss: 0.3100190
	speed: 0.0748s/iter; left time: 1443.4698s
	iters: 700, epoch: 2 | loss: 0.2427578
	speed: 0.0725s/iter; left time: 1391.3344s
	iters: 800, epoch: 2 | loss: 0.1978368
	speed: 0.0717s/iter; left time: 1369.3218s
	iters: 900, epoch: 2 | loss: 0.1821300
	speed: 0.0706s/iter; left time: 1340.9504s
	iters: 1000, epoch: 2 | loss: 0.2509040
	speed: 0.0681s/iter; left time: 1286.5331s
Epoch: 2 cost time: 74.49607634544373
Epoch: 2, Steps: 1047 | Train Loss: 0.2520831 Vali Loss: 0.1413042 Test Loss: 1.3024087
Validation loss decreased (0.147546 --> 0.141304).  Saving model ...
Updating learning rate to 5e-05
Parameters: 1.885
	iters: 100, epoch: 3 | loss: 0.1814127
	speed: 0.7368s/iter; left time: 13813.1458s
	iters: 200, epoch: 3 | loss: 0.2052314
	speed: 0.0681s/iter; left time: 1270.1440s
	iters: 300, epoch: 3 | loss: 0.1202002
	speed: 0.0684s/iter; left time: 1269.2767s
	iters: 400, epoch: 3 | loss: 0.2269885
	speed: 0.0678s/iter; left time: 1250.1625s
	iters: 500, epoch: 3 | loss: 0.4852366
	speed: 0.0680s/iter; left time: 1247.1120s
	iters: 600, epoch: 3 | loss: 0.0928088
	speed: 0.0710s/iter; left time: 1296.0239s
	iters: 700, epoch: 3 | loss: 0.0795006
	speed: 0.0683s/iter; left time: 1238.9267s
	iters: 800, epoch: 3 | loss: 0.2207947
	speed: 0.0690s/iter; left time: 1245.3086s
	iters: 900, epoch: 3 | loss: 0.2781832
	speed: 0.0690s/iter; left time: 1238.2967s
	iters: 1000, epoch: 3 | loss: 0.1878295
	speed: 0.0692s/iter; left time: 1235.3879s
Epoch: 3 cost time: 72.17123794555664
Epoch: 3, Steps: 1047 | Train Loss: 0.2364671 Vali Loss: 0.1407771 Test Loss: 1.2964824
Validation loss decreased (0.141304 --> 0.140777).  Saving model ...
Updating learning rate to 2.5e-05
Parameters: 1.885
	iters: 100, epoch: 4 | loss: 0.2205068
	speed: 0.7271s/iter; left time: 12869.3614s
	iters: 200, epoch: 4 | loss: 0.1853866
	speed: 0.0686s/iter; left time: 1208.0985s
	iters: 300, epoch: 4 | loss: 0.0798555
	speed: 0.0682s/iter; left time: 1192.7570s
	iters: 400, epoch: 4 | loss: 0.0969221
	speed: 0.0695s/iter; left time: 1209.6174s
	iters: 500, epoch: 4 | loss: 0.2518047
	speed: 0.0697s/iter; left time: 1205.5446s
	iters: 600, epoch: 4 | loss: 0.3055210
	speed: 0.0683s/iter; left time: 1174.4878s
	iters: 700, epoch: 4 | loss: 0.0986734
	speed: 0.0672s/iter; left time: 1148.8065s
	iters: 800, epoch: 4 | loss: 0.3553989
	speed: 0.0692s/iter; left time: 1176.2128s
	iters: 900, epoch: 4 | loss: 0.2421029
	speed: 0.0694s/iter; left time: 1173.5835s
	iters: 1000, epoch: 4 | loss: 0.2099911
	speed: 0.0694s/iter; left time: 1166.2673s
Epoch: 4 cost time: 72.38991284370422
Epoch: 4, Steps: 1047 | Train Loss: 0.2277039 Vali Loss: 0.1400238 Test Loss: 1.2988898
Validation loss decreased (0.140777 --> 0.140024).  Saving model ...
Updating learning rate to 1.25e-05
Parameters: 1.885
	iters: 100, epoch: 5 | loss: 0.2108809
	speed: 0.7319s/iter; left time: 12188.9751s
	iters: 200, epoch: 5 | loss: 0.2700348
	speed: 0.0710s/iter; left time: 1175.2350s
	iters: 300, epoch: 5 | loss: 0.1938509
	speed: 0.0674s/iter; left time: 1108.3762s
	iters: 400, epoch: 5 | loss: 0.3956426
	speed: 0.0672s/iter; left time: 1098.4705s
	iters: 500, epoch: 5 | loss: 0.3688862
	speed: 0.0684s/iter; left time: 1111.1284s
	iters: 600, epoch: 5 | loss: 0.1691233
	speed: 0.0693s/iter; left time: 1119.9497s
	iters: 700, epoch: 5 | loss: 0.1178236
	speed: 0.0680s/iter; left time: 1091.8954s
	iters: 800, epoch: 5 | loss: 0.1530468
	speed: 0.0694s/iter; left time: 1106.6448s
	iters: 900, epoch: 5 | loss: 0.1308282
	speed: 0.0696s/iter; left time: 1103.4221s
	iters: 1000, epoch: 5 | loss: 0.2149537
	speed: 0.0699s/iter; left time: 1101.9129s
Epoch: 5 cost time: 72.50399708747864
Epoch: 5, Steps: 1047 | Train Loss: 0.2229961 Vali Loss: 0.1403829 Test Loss: 1.2975724
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.25e-06
Parameters: 1.885
	iters: 100, epoch: 6 | loss: 0.2075722
	speed: 0.7201s/iter; left time: 11237.5356s
	iters: 200, epoch: 6 | loss: 0.2032531
	speed: 0.0686s/iter; left time: 1064.0244s
	iters: 300, epoch: 6 | loss: 0.1351513
	speed: 0.0689s/iter; left time: 1061.9356s
	iters: 400, epoch: 6 | loss: 0.2584620
	speed: 0.0694s/iter; left time: 1062.8323s
	iters: 500, epoch: 6 | loss: 0.3270001
	speed: 0.0687s/iter; left time: 1044.2010s
	iters: 600, epoch: 6 | loss: 0.2888670
	speed: 0.0714s/iter; left time: 1077.9601s
	iters: 700, epoch: 6 | loss: 0.1123626
	speed: 0.0683s/iter; left time: 1024.2043s
	iters: 800, epoch: 6 | loss: 0.3183667
	speed: 0.0684s/iter; left time: 1019.1679s
	iters: 900, epoch: 6 | loss: 0.2506517
	speed: 0.0701s/iter; left time: 1037.7241s
	iters: 1000, epoch: 6 | loss: 0.2322567
	speed: 0.0697s/iter; left time: 1024.3964s
Epoch: 6 cost time: 72.5749294757843
Epoch: 6, Steps: 1047 | Train Loss: 0.2204468 Vali Loss: 0.1400225 Test Loss: 1.2966940
Validation loss decreased (0.140024 --> 0.140022).  Saving model ...
Updating learning rate to 3.125e-06
Parameters: 1.885
	iters: 100, epoch: 7 | loss: 0.1912344
	speed: 0.7474s/iter; left time: 10881.8341s
	iters: 200, epoch: 7 | loss: 0.0773203
	speed: 0.0742s/iter; left time: 1073.4431s
	iters: 300, epoch: 7 | loss: 0.2487624
	speed: 0.0744s/iter; left time: 1067.7782s
	iters: 400, epoch: 7 | loss: 0.1888265
	speed: 0.0701s/iter; left time: 1000.0341s
	iters: 500, epoch: 7 | loss: 0.2611003
	speed: 0.0717s/iter; left time: 1015.1060s
	iters: 600, epoch: 7 | loss: 0.1505936
	speed: 0.0734s/iter; left time: 1031.4001s
	iters: 700, epoch: 7 | loss: 0.2116355
	speed: 0.0697s/iter; left time: 973.3374s
	iters: 800, epoch: 7 | loss: 0.2305719
	speed: 0.0680s/iter; left time: 943.1004s
	iters: 900, epoch: 7 | loss: 0.1293883
	speed: 0.0696s/iter; left time: 957.6641s
	iters: 1000, epoch: 7 | loss: 0.3333189
	speed: 0.0709s/iter; left time: 968.0038s
Epoch: 7 cost time: 75.20869779586792
Epoch: 7, Steps: 1047 | Train Loss: 0.2191817 Vali Loss: 0.1410507 Test Loss: 1.2976580
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.5625e-06
Parameters: 1.885
	iters: 100, epoch: 8 | loss: 0.2938344
	speed: 0.7222s/iter; left time: 9758.3146s
	iters: 200, epoch: 8 | loss: 0.2668920
	speed: 0.0680s/iter; left time: 912.5526s
	iters: 300, epoch: 8 | loss: 0.1466974
	speed: 0.0689s/iter; left time: 917.2735s
	iters: 400, epoch: 8 | loss: 0.0769345
	speed: 0.0689s/iter; left time: 910.9278s
	iters: 500, epoch: 8 | loss: 0.1481193
	speed: 0.0717s/iter; left time: 940.1440s
	iters: 600, epoch: 8 | loss: 0.1360281
	speed: 0.0721s/iter; left time: 937.7087s
	iters: 700, epoch: 8 | loss: 0.1566210
	speed: 0.0689s/iter; left time: 890.2415s
	iters: 800, epoch: 8 | loss: 0.0943494
	speed: 0.0691s/iter; left time: 885.2503s
	iters: 900, epoch: 8 | loss: 0.1340855
	speed: 0.0687s/iter; left time: 872.9267s
	iters: 1000, epoch: 8 | loss: 0.1799705
	speed: 0.0710s/iter; left time: 895.8829s
Epoch: 8 cost time: 73.20799493789673
Epoch: 8, Steps: 1047 | Train Loss: 0.2183897 Vali Loss: 0.1407288 Test Loss: 1.2981173
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.8125e-07
Parameters: 1.885
	iters: 100, epoch: 9 | loss: 0.1821333
	speed: 0.7236s/iter; left time: 9019.5786s
	iters: 200, epoch: 9 | loss: 0.3882609
	speed: 0.0697s/iter; left time: 862.2278s
	iters: 300, epoch: 9 | loss: 0.1373283
	speed: 0.0709s/iter; left time: 869.7586s
	iters: 400, epoch: 9 | loss: 0.2024719
	speed: 0.0699s/iter; left time: 850.5812s
	iters: 500, epoch: 9 | loss: 0.1711102
	speed: 0.0698s/iter; left time: 841.6574s
	iters: 600, epoch: 9 | loss: 0.1454028
	speed: 0.0700s/iter; left time: 837.3475s
	iters: 700, epoch: 9 | loss: 0.1848654
	speed: 0.0693s/iter; left time: 822.0205s
	iters: 800, epoch: 9 | loss: 0.2636881
	speed: 0.0698s/iter; left time: 821.3385s
	iters: 900, epoch: 9 | loss: 0.2029095
	speed: 0.0707s/iter; left time: 824.2772s
	iters: 1000, epoch: 9 | loss: 0.2346707
	speed: 0.0691s/iter; left time: 799.6649s
Epoch: 9 cost time: 73.31814551353455
Epoch: 9, Steps: 1047 | Train Loss: 0.2183122 Vali Loss: 0.1409554 Test Loss: 1.2984049
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.90625e-07
Parameters: 1.885
	iters: 100, epoch: 10 | loss: 0.1461826
	speed: 0.7178s/iter; left time: 8196.2654s
	iters: 200, epoch: 10 | loss: 0.2801233
	speed: 0.0707s/iter; left time: 799.7018s
	iters: 300, epoch: 10 | loss: 0.2651325
	speed: 0.0698s/iter; left time: 782.8221s
	iters: 400, epoch: 10 | loss: 0.1379703
	speed: 0.0694s/iter; left time: 771.8437s
	iters: 500, epoch: 10 | loss: 0.2687678
	speed: 0.0688s/iter; left time: 757.5009s
	iters: 600, epoch: 10 | loss: 0.2724860
	speed: 0.0714s/iter; left time: 779.7442s
	iters: 700, epoch: 10 | loss: 0.1715298
	speed: 0.0689s/iter; left time: 745.6489s
	iters: 800, epoch: 10 | loss: 0.1147190
	speed: 0.0696s/iter; left time: 746.4579s
	iters: 900, epoch: 10 | loss: 0.3402925
	speed: 0.0701s/iter; left time: 744.1739s
	iters: 1000, epoch: 10 | loss: 0.1564235
	speed: 0.0694s/iter; left time: 730.0099s
Epoch: 10 cost time: 73.08580136299133
Epoch: 10, Steps: 1047 | Train Loss: 0.2182901 Vali Loss: 0.1410245 Test Loss: 1.2983717
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.953125e-07
Parameters: 1.885
	iters: 100, epoch: 11 | loss: 0.3933808
	speed: 0.7192s/iter; left time: 7458.3744s
	iters: 200, epoch: 11 | loss: 0.1559155
	speed: 0.0711s/iter; left time: 730.2994s
	iters: 300, epoch: 11 | loss: 0.1712894
	speed: 0.0701s/iter; left time: 712.8230s
	iters: 400, epoch: 11 | loss: 0.2129659
	speed: 0.0700s/iter; left time: 704.9729s
	iters: 500, epoch: 11 | loss: 0.3034512
	speed: 0.0708s/iter; left time: 705.8888s
	iters: 600, epoch: 11 | loss: 0.3731997
	speed: 0.0718s/iter; left time: 708.4243s
	iters: 700, epoch: 11 | loss: 0.2850221
	speed: 0.0702s/iter; left time: 686.2019s
	iters: 800, epoch: 11 | loss: 0.0967678
	speed: 0.0707s/iter; left time: 683.3394s
	iters: 900, epoch: 11 | loss: 0.1461513
	speed: 0.0709s/iter; left time: 678.6563s
	iters: 1000, epoch: 11 | loss: 0.1498511
	speed: 0.0683s/iter; left time: 646.8292s
Epoch: 11 cost time: 73.79357028007507
Epoch: 11, Steps: 1047 | Train Loss: 0.2180773 Vali Loss: 0.1409722 Test Loss: 1.2984656
EarlyStopping counter: 5 out of 5
Updating learning rate to 9.765625e-08
Early stopping
>>>>>>>testing : long_term_forecast_DiscoveryPassage_and_others_720_360_96_FUSST_custom_ftM_sl192_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Chlorophyll (ug/l) Chlorophyll (ug/l)
test 9614
test shape: (9614, 1, 24, 8) (9614, 1, 24, 8)
test shape: (9614, 24, 8) (9614, 24, 8)
mse:1.296694040298462, mae:0.37197059392929077








XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX________________autoformer__________________XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX________________autoformer__________________XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX________________autoformer__________________XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX________________autoformer__________________XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX________________autoformer__________________XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX________________autoformer__________________XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX________________autoformer__________________XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX



doug@V2K-Chinmay:~/Desktop/Experiments/src/fusst$ bash ./scripts/DiscoveryPassage_and_others_Script/autoformer.sh
/usr/local/bin/python3
MODEL IMPLEMENTED= Autoformer
PREDICTION LENGTH= 336
SEQUENCE LENGTH= 336
LEARNING RATE ADJUSTMENT= type1
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=8, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='DiscoveryPassage_and_others_merged.csv', dec_in=8, des='Exp', devices='0,1,2,3', distil=True, dropout=0.1, e_layers=2, embed='timeF', enc_in=8, factor=3, features='M', freq='h', gpu=0, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='Autoformer', model_id='DiscoveryPassage_and_others_720_360_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=336, root_path='./dataset/', seasonal_patterns='Monthly', seq_len=336, target='Chlorophyll (ug/l)', task_name='long_term_forecast', top_k=5, train_epochs=20, use_amp=False, use_gpu=False, use_multi_gpu=False, w_lin=1.0)
Use CPU
>>>>>>>start training : long_term_forecast_DiscoveryPassage_and_others_720_360_96_Autoformer_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
Chlorophyll (ug/l) Chlorophyll (ug/l)
train 33059
Chlorophyll (ug/l) Chlorophyll (ug/l)
val 4485
Chlorophyll (ug/l) Chlorophyll (ug/l)
test 9302
Parameters: 10.541064
	iters: 100, epoch: 1 | loss: 0.4343841
	speed: 14.7134s/iter; left time: 302522.5575s
	iters: 200, epoch: 1 | loss: 0.3192453
	speed: 14.9623s/iter; left time: 306143.4923s
	iters: 300, epoch: 1 | loss: 0.5076628
	speed: 15.3728s/iter; left time: 313004.7404s
	iters: 400, epoch: 1 | loss: 0.2846749
	speed: 16.0546s/iter; left time: 325282.9313s
	iters: 500, epoch: 1 | loss: 0.3068244
	speed: 16.0462s/iter; left time: 323508.3154s
	iters: 600, epoch: 1 | loss: 0.3497706
	speed: 15.8966s/iter; left time: 318900.8818s
	iters: 700, epoch: 1 | loss: 0.3885942
	speed: 15.6335s/iter; left time: 312059.5346s
	iters: 800, epoch: 1 | loss: 0.3023462
	speed: 15.9265s/iter; left time: 316316.6457s
	iters: 900, epoch: 1 | loss: 0.3227090
	speed: 15.0593s/iter; left time: 297587.6186s
	iters: 1000, epoch: 1 | loss: 0.3052737
	speed: 15.0741s/iter; left time: 296371.3448s
Epoch: 1 cost time: 15984.536701202393
Epoch: 1, Steps: 1033 | Train Loss: 0.3725667 Vali Loss: 0.7349801 Test Loss: 2.4468100
Validation loss decreased (inf --> 0.734980).  Saving model ...
Updating learning rate to 0.0001
Parameters: 10.541064
	iters: 100, epoch: 2 | loss: 0.2306841
	speed: 45.6469s/iter; left time: 891392.3610s
	iters: 200, epoch: 2 | loss: 0.4216435
	speed: 12.8141s/iter; left time: 248952.1324s
	iters: 300, epoch: 2 | loss: 0.3371012
	speed: 13.4784s/iter; left time: 260510.9135s
	iters: 400, epoch: 2 | loss: 0.3226614
	speed: 14.7644s/iter; left time: 283890.5523s
	iters: 500, epoch: 2 | loss: 0.4045717
	speed: 14.7957s/iter; left time: 283012.5758s
	iters: 600, epoch: 2 | loss: 0.2926824
	speed: 14.7625s/iter; left time: 280900.3085s
	iters: 700, epoch: 2 | loss: 0.2289869
	speed: 14.7399s/iter; left time: 278997.4195s
	iters: 800, epoch: 2 | loss: 0.1726082
	speed: 14.8145s/iter; left time: 278926.6857s
	iters: 900, epoch: 2 | loss: 0.3273992
	speed: 14.7841s/iter; left time: 276875.9349s
	iters: 1000, epoch: 2 | loss: 0.1937969
	speed: 14.7593s/iter; left time: 274937.1699s
Epoch: 2 cost time: 14772.298545122147
Epoch: 2, Steps: 1033 | Train Loss: 0.2756822 Vali Loss: 0.6523707 Test Loss: 2.4205205
Validation loss decreased (0.734980 --> 0.652371).  Saving model ...
Updating learning rate to 5e-05
Parameters: 10.541064
	iters: 100, epoch: 3 | loss: 0.2238984
	speed: 48.4069s/iter; left time: 895285.6549s
	iters: 200, epoch: 3 | loss: 0.2568359
	speed: 13.5936s/iter; left time: 250054.8571s
	iters: 300, epoch: 3 | loss: 0.1113113
	speed: 12.7977s/iter; left time: 234133.2320s
	iters: 400, epoch: 3 | loss: 0.2382312
	speed: 12.6320s/iter; left time: 229839.1605s
	iters: 500, epoch: 3 | loss: 0.1815885
	speed: 12.6747s/iter; left time: 229349.4094s
	iters: 600, epoch: 3 | loss: 0.2025891
	speed: 14.1415s/iter; left time: 254476.7628s
	iters: 700, epoch: 3 | loss: 0.1608915
	speed: 14.8348s/iter; left time: 265469.5621s
	iters: 800, epoch: 3 | loss: 0.1516911
	speed: 14.8791s/iter; left time: 264773.2532s
	iters: 900, epoch: 3 | loss: 0.1887268
	speed: 14.7631s/iter; left time: 261233.2032s
	iters: 1000, epoch: 3 | loss: 0.2467931
	speed: 14.8279s/iter; left time: 260896.5922s
Epoch: 3 cost time: 14485.306866407394
Epoch: 3, Steps: 1033 | Train Loss: 0.2189122 Vali Loss: 0.6702782 Test Loss: 2.4415953
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.5e-05
Parameters: 10.541064
	iters: 100, epoch: 4 | loss: 0.2186618
	speed: 48.1168s/iter; left time: 840215.2278s
	iters: 200, epoch: 4 | loss: 0.1959141
	speed: 14.7854s/iter; left time: 256704.9298s
	iters: 300, epoch: 4 | loss: 0.1623546
	speed: 14.7170s/iter; left time: 254044.0074s
	iters: 400, epoch: 4 | loss: 0.1158643
	speed: 14.6880s/iter; left time: 252075.7324s
	iters: 500, epoch: 4 | loss: 0.1655819
	speed: 13.0667s/iter; left time: 222944.3097s
	iters: 600, epoch: 4 | loss: 0.2170984
	speed: 12.7678s/iter; left time: 216566.9491s
	iters: 700, epoch: 4 | loss: 0.1493585
	speed: 12.6406s/iter; left time: 213145.9742s
	iters: 800, epoch: 4 | loss: 0.1503015
	speed: 12.8284s/iter; left time: 215029.4621s
	iters: 900, epoch: 4 | loss: 0.2088349
	speed: 14.7599s/iter; left time: 245928.6458s
	iters: 1000, epoch: 4 | loss: 0.2078040
	speed: 14.6817s/iter; left time: 243157.7100s
Epoch: 4 cost time: 14467.977386951447
Epoch: 4, Steps: 1033 | Train Loss: 0.1924530 Vali Loss: 0.6634156 Test Loss: 2.4358592
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.25e-05
Parameters: 10.541064
	iters: 100, epoch: 5 | loss: 0.1449644
	speed: 48.1708s/iter; left time: 791398.7075s
	iters: 200, epoch: 5 | loss: 0.1698814
	speed: 14.7495s/iter; left time: 240845.1292s
	iters: 300, epoch: 5 | loss: 0.1524220
	speed: 14.8273s/iter; left time: 240632.6410s
	iters: 400, epoch: 5 | loss: 0.1972688
	speed: 14.8117s/iter; left time: 238898.3059s
	iters: 500, epoch: 5 | loss: 0.1771291
	speed: 14.9070s/iter; left time: 238943.5661s
	iters: 600, epoch: 5 | loss: 0.1546819
	speed: 14.8097s/iter; left time: 235904.1116s
	iters: 700, epoch: 5 | loss: 0.1802717
	speed: 14.3477s/iter; left time: 227109.2239s
	iters: 800, epoch: 5 | loss: 0.1511836
	speed: 12.7617s/iter; left time: 200729.5405s
	iters: 900, epoch: 5 | loss: 0.1345411
	speed: 12.8066s/iter; left time: 200154.8220s
	iters: 1000, epoch: 5 | loss: 0.1907493
	speed: 12.7327s/iter; left time: 197726.7210s
Epoch: 5 cost time: 14579.029809236526
Epoch: 5, Steps: 1033 | Train Loss: 0.1797021 Vali Loss: 0.6679037 Test Loss: 2.4402864
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.25e-06
Parameters: 10.541064
	iters: 100, epoch: 6 | loss: 0.1441763
	speed: 46.7641s/iter; left time: 719979.5301s
	iters: 200, epoch: 6 | loss: 0.1723616
	speed: 14.8133s/iter; left time: 226583.8967s
	iters: 300, epoch: 6 | loss: 0.1594031
	speed: 14.7937s/iter; left time: 224805.0047s
	iters: 400, epoch: 6 | loss: 0.1784306
	speed: 14.8435s/iter; left time: 224076.8442s
	iters: 500, epoch: 6 | loss: 0.1773683
	speed: 14.7381s/iter; left time: 221012.7989s
	iters: 600, epoch: 6 | loss: 0.1755403
	speed: 14.8198s/iter; left time: 220756.1893s
	iters: 700, epoch: 6 | loss: 0.1415593
	speed: 14.8034s/iter; left time: 219030.8233s
	iters: 800, epoch: 6 | loss: 0.1784439
	speed: 14.8018s/iter; left time: 217526.7603s
	iters: 900, epoch: 6 | loss: 0.2174284
	speed: 14.7255s/iter; left time: 214932.8250s
	iters: 1000, epoch: 6 | loss: 0.1661530
	speed: 13.7769s/iter; left time: 199710.1342s
Epoch: 6 cost time: 15110.319748878479
Epoch: 6, Steps: 1033 | Train Loss: 0.1736105 Vali Loss: 0.6643036 Test Loss: 2.4449766
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.125e-06
Parameters: 10.541064
	iters: 100, epoch: 7 | loss: 0.1667647
	speed: 42.2585s/iter; left time: 606959.0590s
	iters: 200, epoch: 7 | loss: 0.1639201
	speed: 14.8090s/iter; left time: 211220.6596s
	iters: 300, epoch: 7 | loss: 0.1743992
	speed: 14.8156s/iter; left time: 209833.7673s
	iters: 400, epoch: 7 | loss: 0.1988836
	speed: 14.8347s/iter; left time: 208619.7646s
	iters: 500, epoch: 7 | loss: 0.2016127
	speed: 14.8904s/iter; left time: 207915.2618s
	iters: 600, epoch: 7 | loss: 0.1744986
	speed: 14.8304s/iter; left time: 205594.2743s
	iters: 700, epoch: 7 | loss: 0.1593202
	speed: 14.8398s/iter; left time: 204239.6771s
	iters: 800, epoch: 7 | loss: 0.1484942
	speed: 14.8945s/iter; left time: 203503.1120s
	iters: 900, epoch: 7 | loss: 0.1914758
	speed: 14.8501s/iter; left time: 201411.9233s
	iters: 1000, epoch: 7 | loss: 0.1456785
	speed: 14.8229s/iter; left time: 199561.1496s
Epoch: 7 cost time: 15130.300460577011
Epoch: 7, Steps: 1033 | Train Loss: 0.1706695 Vali Loss: 0.6550254 Test Loss: 2.4418645
EarlyStopping counter: 5 out of 5
Updating learning rate to 1.5625e-06
Early stopping
>>>>>>>testing : long_term_forecast_DiscoveryPassage_and_others_720_360_96_Autoformer_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Chlorophyll (ug/l) Chlorophyll (ug/l)
test 9302
test shape: (9302, 1, 336, 8) (9302, 1, 336, 8)
test shape: (9302, 336, 8) (9302, 336, 8)
mse:2.4205241203308105, mae:0.7627061605453491





doug@V2K-Chinmay:~/Desktop/Experiments/src/fusst$ bash ./scripts/DiscoveryPassage_and_others_Script/autoformer.sh
/usr/local/bin/python3
MODEL IMPLEMENTED= Autoformer
PREDICTION LENGTH= 192
SEQUENCE LENGTH= 192
LEARNING RATE ADJUSTMENT= type1
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=8, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='DiscoveryPassage_and_others_merged.csv', dec_in=8, des='Exp', devices='0,1,2,3', distil=True, dropout=0.1, e_layers=2, embed='timeF', enc_in=8, factor=3, features='M', freq='h', gpu=0, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='Autoformer', model_id='DiscoveryPassage_and_others_720_360_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=192, root_path='./dataset/', seasonal_patterns='Monthly', seq_len=192, target='Chlorophyll (ug/l)', task_name='long_term_forecast', top_k=5, train_epochs=20, use_amp=False, use_gpu=False, use_multi_gpu=False, w_lin=1.0)
Use CPU
>>>>>>>start training : long_term_forecast_DiscoveryPassage_and_others_720_360_96_Autoformer_custom_ftM_sl192_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
Chlorophyll (ug/l) Chlorophyll (ug/l)
train 33347
Chlorophyll (ug/l) Chlorophyll (ug/l)
val 4629
Chlorophyll (ug/l) Chlorophyll (ug/l)
test 9446
Parameters: 10.541064
	iters: 100, epoch: 1 | loss: 0.4050741
	speed: 7.7421s/iter; left time: 160579.2234s
	iters: 200, epoch: 1 | loss: 0.3273478
	speed: 8.4928s/iter; left time: 175300.6366s
	iters: 300, epoch: 1 | loss: 0.3216935
	speed: 8.5366s/iter; left time: 175350.6029s
	iters: 400, epoch: 1 | loss: 0.3056819
	speed: 8.4884s/iter; left time: 173510.8658s
	iters: 500, epoch: 1 | loss: 0.3546641
	speed: 8.4111s/iter; left time: 171090.4027s
	iters: 600, epoch: 1 | loss: 0.2376056
	speed: 8.5224s/iter; left time: 172501.6801s
	iters: 700, epoch: 1 | loss: 0.3428182
	speed: 8.4009s/iter; left time: 169203.1249s
	iters: 800, epoch: 1 | loss: 0.4081380
	speed: 8.3961s/iter; left time: 168265.4529s
	iters: 900, epoch: 1 | loss: 0.3172539
	speed: 8.3868s/iter; left time: 167241.8541s
	iters: 1000, epoch: 1 | loss: 0.2458991
	speed: 8.3490s/iter; left time: 165653.3723s
Epoch: 1 cost time: 8725.68022608757
Epoch: 1, Steps: 1042 | Train Loss: 0.3621779 Vali Loss: 0.4660172 Test Loss: 2.0396318
Validation loss decreased (inf --> 0.466017).  Saving model ...
Updating learning rate to 0.0001
Parameters: 10.541064
	iters: 100, epoch: 2 | loss: 0.3812896
	speed: 29.3015s/iter; left time: 577209.5960s
	iters: 200, epoch: 2 | loss: 0.1656488
	speed: 7.3011s/iter; left time: 143093.6794s
	iters: 300, epoch: 2 | loss: 0.1444429
	speed: 7.2943s/iter; left time: 142232.4576s
	iters: 400, epoch: 2 | loss: 0.3508005
	speed: 7.2587s/iter; left time: 140811.9833s
	iters: 500, epoch: 2 | loss: 0.2866789
	speed: 7.2382s/iter; left time: 139690.1268s
	iters: 600, epoch: 2 | loss: 0.2439263
	speed: 7.3257s/iter; left time: 140646.1165s
	iters: 700, epoch: 2 | loss: 0.2232900
	speed: 7.2568s/iter; left time: 138596.8645s
	iters: 800, epoch: 2 | loss: 0.2435459
	speed: 8.3080s/iter; left time: 157844.0527s
	iters: 900, epoch: 2 | loss: 0.3423097
	speed: 8.3583s/iter; left time: 157963.7687s
	iters: 1000, epoch: 2 | loss: 0.2805279
	speed: 8.3888s/iter; left time: 157701.7547s
Epoch: 2 cost time: 8027.5981686115265
Epoch: 2, Steps: 1042 | Train Loss: 0.2755038 Vali Loss: 0.5211057 Test Loss: 2.0633705
EarlyStopping counter: 1 out of 5
Updating learning rate to 5e-05
Parameters: 10.541064
	iters: 100, epoch: 3 | loss: 0.2159885
	speed: 29.7124s/iter; left time: 554344.3729s
	iters: 200, epoch: 3 | loss: 0.3763603
	speed: 8.3318s/iter; left time: 154613.0415s
	iters: 300, epoch: 3 | loss: 0.1771987
	speed: 8.3507s/iter; left time: 154129.5803s
	iters: 400, epoch: 3 | loss: 0.1696355
	speed: 8.3125s/iter; left time: 152592.7988s
	iters: 500, epoch: 3 | loss: 0.2918434
	speed: 8.3536s/iter; left time: 152512.1728s
	iters: 600, epoch: 3 | loss: 0.2440939
	speed: 8.3973s/iter; left time: 152469.9190s
	iters: 700, epoch: 3 | loss: 0.3368002
	speed: 8.3323s/iter; left time: 150456.6693s
	iters: 800, epoch: 3 | loss: 0.1516683
	speed: 7.9028s/iter; left time: 141910.8181s
	iters: 900, epoch: 3 | loss: 0.1923480
	speed: 7.2526s/iter; left time: 129509.6626s
	iters: 1000, epoch: 3 | loss: 0.1869574
	speed: 7.2881s/iter; left time: 129414.2230s
Epoch: 3 cost time: 8394.016206026077
Epoch: 3, Steps: 1042 | Train Loss: 0.2228194 Vali Loss: 0.5287635 Test Loss: 2.0734630
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.5e-05
Parameters: 10.541064
	iters: 100, epoch: 4 | loss: 0.1390747
	speed: 25.6801s/iter; left time: 452355.2224s
	iters: 200, epoch: 4 | loss: 0.1126671
	speed: 7.9982s/iter; left time: 140087.7324s
	iters: 300, epoch: 4 | loss: 0.3091958
	speed: 8.3709s/iter; left time: 145778.7508s
	iters: 400, epoch: 4 | loss: 0.2174850
	speed: 8.3321s/iter; left time: 144269.7691s
	iters: 500, epoch: 4 | loss: 0.1147642
	speed: 8.3050s/iter; left time: 142970.3593s
	iters: 600, epoch: 4 | loss: 0.1918784
	speed: 8.2854s/iter; left time: 141804.3713s
	iters: 700, epoch: 4 | loss: 0.2573053
	speed: 8.3264s/iter; left time: 141673.3337s
	iters: 800, epoch: 4 | loss: 0.2202459
	speed: 8.3136s/iter; left time: 140623.8318s
	iters: 900, epoch: 4 | loss: 0.2299502
	speed: 8.3141s/iter; left time: 139801.7499s
	iters: 1000, epoch: 4 | loss: 0.1925854
	speed: 8.3135s/iter; left time: 138960.6156s
Epoch: 4 cost time: 8526.49491739273
Epoch: 4, Steps: 1042 | Train Loss: 0.1975265 Vali Loss: 0.5044162 Test Loss: 2.0677843
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.25e-05
Parameters: 10.541064
	iters: 100, epoch: 5 | loss: 0.2076145
	speed: 29.7065s/iter; left time: 492325.4214s
	iters: 200, epoch: 5 | loss: 0.1526968
	speed: 8.1932s/iter; left time: 134966.8157s
	iters: 300, epoch: 5 | loss: 0.1643205
	speed: 7.2967s/iter; left time: 119469.1639s
	iters: 400, epoch: 5 | loss: 0.1763566
	speed: 7.2884s/iter; left time: 118604.3152s
	iters: 500, epoch: 5 | loss: 0.1614607
	speed: 7.2893s/iter; left time: 117890.3393s
	iters: 600, epoch: 5 | loss: 0.2036942
	speed: 7.2296s/iter; left time: 116201.8309s
	iters: 700, epoch: 5 | loss: 0.1936492
	speed: 7.2987s/iter; left time: 116582.4325s
	iters: 800, epoch: 5 | loss: 0.1431863
	speed: 7.3080s/iter; left time: 115999.9820s
	iters: 900, epoch: 5 | loss: 0.1965830
	speed: 8.0673s/iter; left time: 127245.9882s
	iters: 1000, epoch: 5 | loss: 0.1371794
	speed: 8.3584s/iter; left time: 131000.6774s
Epoch: 5 cost time: 8017.562016487122
Epoch: 5, Steps: 1042 | Train Loss: 0.1857065 Vali Loss: 0.5102205 Test Loss: 2.0613205
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.25e-06
Parameters: 10.541064
	iters: 100, epoch: 6 | loss: 0.1757749
	speed: 29.6740s/iter; left time: 460866.5261s
	iters: 200, epoch: 6 | loss: 0.1240017
	speed: 8.3755s/iter; left time: 129241.8554s
	iters: 300, epoch: 6 | loss: 0.1625360
	speed: 8.3819s/iter; left time: 128503.2248s
	iters: 400, epoch: 6 | loss: 0.1568418
	speed: 8.3809s/iter; left time: 127648.7818s
	iters: 500, epoch: 6 | loss: 0.2225069
	speed: 8.3932s/iter; left time: 126997.9391s
	iters: 600, epoch: 6 | loss: 0.1856557
	speed: 8.3924s/iter; left time: 126146.4413s
	iters: 700, epoch: 6 | loss: 0.1770227
	speed: 8.3516s/iter; left time: 124697.0978s
	iters: 800, epoch: 6 | loss: 0.1693676
	speed: 8.3616s/iter; left time: 124011.4194s
	iters: 900, epoch: 6 | loss: 0.1463847
	speed: 8.1244s/iter; left time: 119679.9462s
	iters: 1000, epoch: 6 | loss: 0.1877190
	speed: 7.2995s/iter; left time: 106799.0725s
Epoch: 6 cost time: 8552.636952161789
Epoch: 6, Steps: 1042 | Train Loss: 0.1799643 Vali Loss: 0.5009984 Test Loss: 2.0560226
EarlyStopping counter: 5 out of 5
Updating learning rate to 3.125e-06
Early stopping
>>>>>>>testing : long_term_forecast_DiscoveryPassage_and_others_720_360_96_Autoformer_custom_ftM_sl192_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Chlorophyll (ug/l) Chlorophyll (ug/l)
test 9446
test shape: (9446, 1, 192, 8) (9446, 1, 192, 8)
test shape: (9446, 192, 8) (9446, 192, 8)
mse:2.039632558822632, mae:0.6712631583213806





MODEL IMPLEMENTED= Autoformer
PREDICTION LENGTH= 96
SEQUENCE LENGTH= 96
LEARNING RATE ADJUSTMENT= type1

bash ./scripts/DiscoveryPassage_and_others_Script/autoformer.sh
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=8, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='DiscoveryPassage_and_others_merged.csv', dec_in=8, des='Exp', devices='0,1,2,3', distil=True, dropout=0.1, e_layers=2, embed='timeF', enc_in=8, factor=3, features='M', freq='h', gpu=0, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='Autoformer', model_id='DiscoveryPassage_and_others_720_360_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=96, root_path='./dataset/', seasonal_patterns='Monthly', seq_len=96, target='Chlorophyll (ug/l)', task_name='long_term_forecast', top_k=5, train_epochs=20, use_amp=False, use_gpu=False, use_multi_gpu=False, w_lin=1.0)
Use CPU
>>>>>>>start training : long_term_forecast_DiscoveryPassage_and_others_720_360_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
Chlorophyll (ug/l) Chlorophyll (ug/l)
train 33539
Chlorophyll (ug/l) Chlorophyll (ug/l)
val 4725
Chlorophyll (ug/l) Chlorophyll (ug/l)
test 9542
Parameters: 10.541064
	iters: 100, epoch: 1 | loss: 0.2179005
	speed: 3.3446s/iter; left time: 69770.9548s
	iters: 200, epoch: 1 | loss: 0.2015602
	speed: 3.4320s/iter; left time: 71251.4391s
	iters: 300, epoch: 1 | loss: 0.2711225
	speed: 3.5268s/iter; left time: 72867.8326s
	iters: 400, epoch: 1 | loss: 0.3191009
	speed: 3.5009s/iter; left time: 71982.6658s
	iters: 500, epoch: 1 | loss: 0.2515816
	speed: 3.4365s/iter; left time: 70314.1363s
	iters: 600, epoch: 1 | loss: 0.2937800
	speed: 3.3763s/iter; left time: 68744.0614s
	iters: 700, epoch: 1 | loss: 0.2408754
	speed: 3.3263s/iter; left time: 67393.2143s
	iters: 800, epoch: 1 | loss: 0.4011752
	speed: 3.3574s/iter; left time: 67687.7911s
	iters: 900, epoch: 1 | loss: 0.3363434
	speed: 3.3709s/iter; left time: 67623.2600s
	iters: 1000, epoch: 1 | loss: 0.1358262
	speed: 3.3551s/iter; left time: 66970.3692s
Epoch: 1 cost time: 3568.622949361801
Epoch: 1, Steps: 1048 | Train Loss: 0.3321748 Vali Loss: 0.3819769 Test Loss: 1.8892394
Validation loss decreased (inf --> 0.381977).  Saving model ...
Updating learning rate to 0.0001
Parameters: 10.541064
	iters: 100, epoch: 2 | loss: 0.4474893
	speed: 12.4846s/iter; left time: 247357.0724s
	iters: 200, epoch: 2 | loss: 0.3104936
	speed: 3.9241s/iter; left time: 77355.6489s
	iters: 300, epoch: 2 | loss: 0.1758435
	speed: 5.3436s/iter; left time: 104803.5702s
  	iters: 400, epoch: 2 | loss: 0.1952800
	speed: 5.3160s/iter; left time: 103731.4087s
	iters: 500, epoch: 2 | loss: 0.3999378
	speed: 5.4642s/iter; left time: 106076.7102s
	iters: 600, epoch: 2 | loss: 0.3164908
	speed: 3.3928s/iter; left time: 65524.2423s
	iters: 700, epoch: 2 | loss: 0.2915280
	speed: 3.3642s/iter; left time: 64635.8737s
	iters: 800, epoch: 2 | loss: 0.2087182
	speed: 3.3782s/iter; left time: 64567.5670s
	iters: 900, epoch: 2 | loss: 0.2194209
	speed: 3.3422s/iter; left time: 63545.2565s
	iters: 1000, epoch: 2 | loss: 0.3627139
	speed: 3.7361s/iter; left time: 70661.7365s
Epoch: 2 cost time: 4282.830416202545
Epoch: 2, Steps: 1048 | Train Loss: 0.2698518 Vali Loss: 0.3560264 Test Loss: 1.8453523
Validation loss decreased (0.381977 --> 0.356026).  Saving model ...
Updating learning rate to 5e-05
Parameters: 10.541064
	iters: 100, epoch: 3 | loss: 0.1587212
	speed: 16.5554s/iter; left time: 310662.0432s
	iters: 200, epoch: 3 | loss: 0.3064002
	speed: 4.0840s/iter; left time: 76227.1950s
	iters: 300, epoch: 3 | loss: 0.3350258
	speed: 3.2925s/iter; left time: 61125.9936s
	iters: 400, epoch: 3 | loss: 0.2948681
	speed: 3.3214s/iter; left time: 61329.8474s
	iters: 500, epoch: 3 | loss: 0.1617266
	speed: 3.3099s/iter; left time: 60785.4738s
	iters: 600, epoch: 3 | loss: 0.2769472
	speed: 3.3116s/iter; left time: 60485.9857s
	iters: 700, epoch: 3 | loss: 0.2093625
	speed: 3.3198s/iter; left time: 60303.8926s
	iters: 800, epoch: 3 | loss: 0.1675802
	speed: 3.3212s/iter; left time: 59996.9937s
	iters: 900, epoch: 3 | loss: 0.2580898
	speed: 3.3138s/iter; left time: 59531.6227s
	iters: 1000, epoch: 3 | loss: 0.1381404
	speed: 3.3402s/iter; left time: 59671.8080s
Epoch: 3 cost time: 3655.223483324051
Epoch: 3, Steps: 1048 | Train Loss: 0.2213069 Vali Loss: 0.3640460 Test Loss: 1.9050159
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.5e-05
Parameters: 10.541064
	iters: 100, epoch: 4 | loss: 0.2135375
	speed: 11.9206s/iter; left time: 211198.0608s
	iters: 200, epoch: 4 | loss: 0.1645684
	speed: 3.3428s/iter; left time: 58890.3380s
	iters: 300, epoch: 4 | loss: 0.1234182
	speed: 3.3368s/iter; left time: 58450.9584s
	iters: 400, epoch: 4 | loss: 0.2301223
	speed: 3.3241s/iter; left time: 57896.1416s
	iters: 500, epoch: 4 | loss: 0.2097028
	speed: 3.3272s/iter; left time: 57617.3251s
	iters: 600, epoch: 4 | loss: 0.1883171
	speed: 3.3201s/iter; left time: 57161.3184s
	iters: 700, epoch: 4 | loss: 0.2415662
	speed: 3.3457s/iter; left time: 57268.1064s
	iters: 800, epoch: 4 | loss: 0.1775180
	speed: 3.3288s/iter; left time: 56646.9999s
	iters: 900, epoch: 4 | loss: 0.2505683
	speed: 3.3493s/iter; left time: 56660.1615s
	iters: 1000, epoch: 4 | loss: 0.2266021
	speed: 3.3262s/iter; left time: 55936.3029s
Epoch: 4 cost time: 3492.949944972992
Epoch: 4, Steps: 1048 | Train Loss: 0.1963048 Vali Loss: 0.3732127 Test Loss: 1.9048964
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.25e-05
Parameters: 10.541064
	iters: 100, epoch: 5 | loss: 0.1972932
	speed: 11.9391s/iter; left time: 199013.4441s
	iters: 200, epoch: 5 | loss: 0.2349263
	speed: 3.3193s/iter; left time: 54996.7376s
	iters: 300, epoch: 5 | loss: 0.2591492
	speed: 3.3379s/iter; left time: 54971.7708s
	iters: 400, epoch: 5 | loss: 0.1098296
	speed: 3.3199s/iter; left time: 54343.5239s
	iters: 500, epoch: 5 | loss: 0.1236286
	speed: 3.3441s/iter; left time: 54404.7795s
	iters: 600, epoch: 5 | loss: 0.1551495
	speed: 3.3340s/iter; left time: 53906.9930s
	iters: 700, epoch: 5 | loss: 0.2432841
	speed: 3.3207s/iter; left time: 53360.1016s
	iters: 800, epoch: 5 | loss: 0.1495957
	speed: 3.3250s/iter; left time: 53096.7152s
	iters: 900, epoch: 5 | loss: 0.2461491
	speed: 3.3422s/iter; left time: 53036.7347s
	iters: 1000, epoch: 5 | loss: 0.1199640
	speed: 3.3404s/iter; left time: 52674.5374s
Epoch: 5 cost time: 3491.8935096263885
Epoch: 5, Steps: 1048 | Train Loss: 0.1846710 Vali Loss: 0.3849832 Test Loss: 1.9150053
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.25e-06
Parameters: 10.541064
	iters: 100, epoch: 6 | loss: 0.1483322
	speed: 11.9536s/iter; left time: 186726.4197s
	iters: 200, epoch: 6 | loss: 0.1415184
	speed: 3.3433s/iter; left time: 51891.5566s
	iters: 300, epoch: 6 | loss: 0.2078983
	speed: 3.3265s/iter; left time: 51297.5202s
	iters: 400, epoch: 6 | loss: 0.1746017
	speed: 3.3442s/iter; left time: 51236.6516s
	iters: 500, epoch: 6 | loss: 0.1894208
	speed: 3.3454s/iter; left time: 50920.2222s
	iters: 600, epoch: 6 | loss: 0.1597482
	speed: 3.3339s/iter; left time: 50412.4659s
	iters: 700, epoch: 6 | loss: 0.1114548
	speed: 3.3199s/iter; left time: 49867.9037s
	iters: 800, epoch: 6 | loss: 0.1534814
	speed: 3.3504s/iter; left time: 49991.1943s
	iters: 900, epoch: 6 | loss: 0.1386573
	speed: 3.3343s/iter; left time: 49418.2994s
	iters: 1000, epoch: 6 | loss: 0.1814425
	speed: 3.3425s/iter; left time: 49204.5474s
Epoch: 6 cost time: 3501.9904568195343
Epoch: 6, Steps: 1048 | Train Loss: 0.1791171 Vali Loss: 0.3937461 Test Loss: 1.9141402
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.125e-06
Parameters: 10.541064
	iters: 100, epoch: 7 | loss: 0.1061141
	speed: 11.9938s/iter; left time: 174786.2275s
	iters: 200, epoch: 7 | loss: 0.1676531
	speed: 3.3425s/iter; left time: 48375.3921s
	iters: 300, epoch: 7 | loss: 0.1544735
	speed: 3.3334s/iter; left time: 47911.0935s
	iters: 400, epoch: 7 | loss: 0.1369909
	speed: 3.3527s/iter; left time: 47853.6122s
	iters: 500, epoch: 7 | loss: 0.1658483
	speed: 3.3409s/iter; left time: 47350.9756s
	iters: 600, epoch: 7 | loss: 0.1571451
	speed: 3.3407s/iter; left time: 47014.3465s
	iters: 700, epoch: 7 | loss: 0.1667573
	speed: 3.3150s/iter; left time: 46321.1372s
	iters: 800, epoch: 7 | loss: 0.1864303
	speed: 3.3294s/iter; left time: 46189.4306s
	iters: 900, epoch: 7 | loss: 0.1460618
	speed: 3.3188s/iter; left time: 45709.9343s
	iters: 1000, epoch: 7 | loss: 0.1286800
	speed: 3.3135s/iter; left time: 45305.6479s
Epoch: 7 cost time: 3495.8417508602142
Epoch: 7, Steps: 1048 | Train Loss: 0.1763201 Vali Loss: 0.3753121 Test Loss: 1.8989450
EarlyStopping counter: 5 out of 5
Updating learning rate to 1.5625e-06
Early stopping
>>>>>>>testing : long_term_forecast_DiscoveryPassage_and_others_720_360_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Chlorophyll (ug/l) Chlorophyll (ug/l)
test 9542
test shape: (9542, 1, 96, 8) (9542, 1, 96, 8)
test shape: (9542, 96, 8) (9542, 96, 8)
mse:1.845353126525879, mae:0.5954226851463318






XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX__________________________________XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX__________________________________XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX




XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX_____________DLINEAR_____________________XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX_____________DLINEAR_____________________XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX

 bash ./scripts/DiscoveryPassage_and_others_Script/DLinear.sh
MODEL IMPLEMENTED= DLinear
PREDICTION LENGTH= 1440
SEQUENCE LENGTH= 1440
LEARNING RATE ADJUSTMENT= type1
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=8, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='DiscoveryPassage_and_others_merged.csv', dec_in=8, des='Exp', devices='0,1,2,3', distil=True, dropout=0.1, e_layers=2, embed='timeF', enc_in=8, factor=3, features='M', freq='h', gpu=0, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='DLinear', model_id='DiscoveryPassage_and_others_720_360_96_tn', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=1440, root_path='./dataset/', seasonal_patterns='Monthly', seq_len=1440, target='Chlorophyll (ug/l)', task_name='long_term_forecast', top_k=5, train_epochs=20, use_amp=False, use_gpu=False, use_multi_gpu=False, w_lin=0.01)
Use CPU
>>>>>>>start training : long_term_forecast_DiscoveryPassage_and_others_720_360_96_tn_DLinear_custom_ftM_sl1440_ll48_pl1440_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
Chlorophyll (ug/l) Chlorophyll (ug/l)
train 30851
Chlorophyll (ug/l) Chlorophyll (ug/l)
val 3381
Chlorophyll (ug/l) Chlorophyll (ug/l)
test 8198
Parameters: 4.15008
	iters: 100, epoch: 1 | loss: 0.5095481
	speed: 0.1186s/iter; left time: 2274.3629s
	iters: 200, epoch: 1 | loss: 0.6984035
	speed: 0.1070s/iter; left time: 2041.2691s
	iters: 300, epoch: 1 | loss: 0.5271161
	speed: 0.1082s/iter; left time: 2053.1890s
	iters: 400, epoch: 1 | loss: 0.4241320
	speed: 0.1130s/iter; left time: 2133.6448s
	iters: 500, epoch: 1 | loss: 0.5596319
	speed: 0.1102s/iter; left time: 2070.3606s
	iters: 600, epoch: 1 | loss: 0.5756444
	speed: 0.1073s/iter; left time: 2004.8441s
	iters: 700, epoch: 1 | loss: 0.6020324
	speed: 0.1078s/iter; left time: 2003.8876s
	iters: 800, epoch: 1 | loss: 0.3833333
	speed: 0.1106s/iter; left time: 2043.1214s
	iters: 900, epoch: 1 | loss: 0.6253168
	speed: 0.1073s/iter; left time: 1973.1700s
Epoch: 1 cost time: 105.68263125419617
Epoch: 1, Steps: 964 | Train Loss: 0.5379539 Vali Loss: 0.8221214 Test Loss: 4.1949077
Validation loss decreased (inf --> 0.822121).  Saving model ...
Updating learning rate to 0.0001
Parameters: 4.15008
	iters: 100, epoch: 2 | loss: 0.4851540
	speed: 0.7365s/iter; left time: 13416.0180s
	iters: 200, epoch: 2 | loss: 0.2634248
	speed: 0.1034s/iter; left time: 1874.1763s
	iters: 300, epoch: 2 | loss: 0.5504209
	speed: 0.1066s/iter; left time: 1921.4675s
	iters: 400, epoch: 2 | loss: 0.4954594
	speed: 0.1278s/iter; left time: 2290.4129s
	iters: 500, epoch: 2 | loss: 0.5487409
	speed: 0.1517s/iter; left time: 2701.9873s
	iters: 600, epoch: 2 | loss: 0.4786138
	speed: 0.1128s/iter; left time: 1999.0883s
	iters: 700, epoch: 2 | loss: 0.5493901
	speed: 0.1039s/iter; left time: 1831.1467s
	iters: 800, epoch: 2 | loss: 0.6798745
	speed: 0.1034s/iter; left time: 1811.5804s
	iters: 900, epoch: 2 | loss: 0.7714599
	speed: 0.1052s/iter; left time: 1832.0677s
Epoch: 2 cost time: 114.21002054214478
Epoch: 2, Steps: 964 | Train Loss: 0.5270168 Vali Loss: 0.8173279 Test Loss: 4.3930616
Validation loss decreased (0.822121 --> 0.817328).  Saving model ...
Updating learning rate to 5e-05
Parameters: 4.15008
	iters: 100, epoch: 3 | loss: 0.5494943
	speed: 2.7779s/iter; left time: 47927.1010s
	iters: 200, epoch: 3 | loss: 0.5950057
	speed: 0.3788s/iter; left time: 6497.4614s
	iters: 300, epoch: 3 | loss: 0.5548960
	speed: 0.3802s/iter; left time: 6483.9152s
	iters: 400, epoch: 3 | loss: 0.5405123
	speed: 0.3683s/iter; left time: 6243.3406s
	iters: 500, epoch: 3 | loss: 0.5593779
	speed: 0.3818s/iter; left time: 6434.9113s
	iters: 600, epoch: 3 | loss: 0.5575780
	speed: 0.3777s/iter; left time: 6327.9172s
	iters: 700, epoch: 3 | loss: 0.5190836
	speed: 0.3773s/iter; left time: 6282.8533s
	iters: 800, epoch: 3 | loss: 0.5208823
	speed: 0.1090s/iter; left time: 1803.4516s
	iters: 900, epoch: 3 | loss: 0.5507672
	speed: 0.1067s/iter; left time: 1755.7314s
Epoch: 3 cost time: 289.81753754615784
Epoch: 3, Steps: 964 | Train Loss: 0.5220131 Vali Loss: 0.8258571 Test Loss: 4.1947451
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.5e-05
Parameters: 4.15008
	iters: 100, epoch: 4 | loss: 0.4112856
	speed: 0.6796s/iter; left time: 11069.8945s
	iters: 200, epoch: 4 | loss: 0.3537280
	speed: 0.1254s/iter; left time: 2029.7123s
	iters: 300, epoch: 4 | loss: 0.4033262
	speed: 0.1229s/iter; left time: 1977.0062s
	iters: 400, epoch: 4 | loss: 0.4495347
	speed: 0.1233s/iter; left time: 1971.3548s
	iters: 500, epoch: 4 | loss: 0.6320767
	speed: 0.1062s/iter; left time: 1687.2036s
	iters: 600, epoch: 4 | loss: 0.5253681
	speed: 0.1081s/iter; left time: 1706.4640s
	iters: 700, epoch: 4 | loss: 0.4141319
	speed: 0.1280s/iter; left time: 2007.4320s
	iters: 800, epoch: 4 | loss: 0.6610602
	speed: 0.1245s/iter; left time: 1940.6265s
	iters: 900, epoch: 4 | loss: 0.5117995
	speed: 0.1194s/iter; left time: 1849.1103s
Epoch: 4 cost time: 114.90598893165588
Epoch: 4, Steps: 964 | Train Loss: 0.5196186 Vali Loss: 0.8309856 Test Loss: 4.2509408
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.25e-05
Parameters: 4.15008
	iters: 100, epoch: 5 | loss: 0.4554276
	speed: 0.7665s/iter; left time: 11747.2580s
	iters: 200, epoch: 5 | loss: 0.3952411
	speed: 0.1109s/iter; left time: 1688.4493s
	iters: 300, epoch: 5 | loss: 0.4454873
	speed: 0.1138s/iter; left time: 1721.1332s
	iters: 400, epoch: 5 | loss: 0.5678615
	speed: 0.1266s/iter; left time: 1902.8903s
	iters: 500, epoch: 5 | loss: 0.4256164
	speed: 0.1171s/iter; left time: 1748.4067s
	iters: 600, epoch: 5 | loss: 0.6030928
	speed: 0.1050s/iter; left time: 1555.8999s
	iters: 700, epoch: 5 | loss: 0.6198391
	speed: 0.1204s/iter; left time: 1773.0586s
	iters: 800, epoch: 5 | loss: 0.5355040
	speed: 0.1163s/iter; left time: 1701.4987s
	iters: 900, epoch: 5 | loss: 0.3579186
	speed: 0.1216s/iter; left time: 1765.5959s
Epoch: 5 cost time: 111.58213400840759
Epoch: 5, Steps: 964 | Train Loss: 0.5184263 Vali Loss: 0.8153378 Test Loss: 4.2393913
Validation loss decreased (0.817328 --> 0.815338).  Saving model ...
Updating learning rate to 6.25e-06
Parameters: 4.15008
	iters: 100, epoch: 6 | loss: 0.4212897
	speed: 0.7364s/iter; left time: 10575.2191s
	iters: 200, epoch: 6 | loss: 0.5429022
	speed: 0.1083s/iter; left time: 1544.5723s
	iters: 300, epoch: 6 | loss: 0.6315062
	speed: 0.1107s/iter; left time: 1567.2409s
	iters: 400, epoch: 6 | loss: 0.5966463
	speed: 0.1074s/iter; left time: 1509.5730s
	iters: 500, epoch: 6 | loss: 0.3302029
	speed: 0.1080s/iter; left time: 1507.6892s
	iters: 600, epoch: 6 | loss: 0.4643243
	speed: 0.1042s/iter; left time: 1444.1698s
	iters: 700, epoch: 6 | loss: 0.4881575
	speed: 0.1084s/iter; left time: 1491.2337s
	iters: 800, epoch: 6 | loss: 0.4924427
	speed: 0.1066s/iter; left time: 1456.9022s
	iters: 900, epoch: 6 | loss: 0.3519612
	speed: 0.1087s/iter; left time: 1474.6279s
Epoch: 6 cost time: 104.07256054878235
Epoch: 6, Steps: 964 | Train Loss: 0.5178420 Vali Loss: 0.8134573 Test Loss: 4.2372832
Validation loss decreased (0.815338 --> 0.813457).  Saving model ...
Updating learning rate to 3.125e-06
Parameters: 4.15008
	iters: 100, epoch: 7 | loss: 0.5635317
	speed: 0.7666s/iter; left time: 10270.3403s
	iters: 200, epoch: 7 | loss: 0.5568355
	speed: 0.1134s/iter; left time: 1507.9350s
	iters: 300, epoch: 7 | loss: 0.4166510
	speed: 0.1105s/iter; left time: 1458.7366s
	iters: 400, epoch: 7 | loss: 0.4151965
	speed: 0.1056s/iter; left time: 1383.4933s
	iters: 500, epoch: 7 | loss: 0.4237681
	speed: 0.1014s/iter; left time: 1318.1264s
	iters: 600, epoch: 7 | loss: 0.5268196
	speed: 0.1110s/iter; left time: 1431.9111s
	iters: 700, epoch: 7 | loss: 0.5717786
	speed: 0.1139s/iter; left time: 1458.1823s
	iters: 800, epoch: 7 | loss: 0.3178498
	speed: 0.1154s/iter; left time: 1465.5932s
	iters: 900, epoch: 7 | loss: 0.5955900
	speed: 0.1200s/iter; left time: 1511.8376s
Epoch: 7 cost time: 107.49201917648315
Epoch: 7, Steps: 964 | Train Loss: 0.5174676 Vali Loss: 0.8136486 Test Loss: 4.2285910
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.5625e-06
Parameters: 4.15008
	iters: 100, epoch: 8 | loss: 0.5298545
	speed: 0.6329s/iter; left time: 7868.3117s
	iters: 200, epoch: 8 | loss: 0.3987060
	speed: 0.0937s/iter; left time: 1155.3940s
	iters: 300, epoch: 8 | loss: 0.4558434
	speed: 0.0986s/iter; left time: 1206.0076s
	iters: 400, epoch: 8 | loss: 0.4241589
	speed: 0.0953s/iter; left time: 1155.8478s
	iters: 500, epoch: 8 | loss: 0.3360659
	speed: 0.0946s/iter; left time: 1138.1969s
	iters: 600, epoch: 8 | loss: 0.6701319
	speed: 0.0957s/iter; left time: 1141.9680s
	iters: 700, epoch: 8 | loss: 0.7097743
	speed: 0.0986s/iter; left time: 1166.7114s
	iters: 800, epoch: 8 | loss: 0.4212376
	speed: 0.0973s/iter; left time: 1141.9713s
	iters: 900, epoch: 8 | loss: 0.4380954
	speed: 0.0979s/iter; left time: 1138.3213s
Epoch: 8 cost time: 93.64858722686768
Epoch: 8, Steps: 964 | Train Loss: 0.5173309 Vali Loss: 0.8107450 Test Loss: 4.2557864
Validation loss decreased (0.813457 --> 0.810745).  Saving model ...
Updating learning rate to 7.8125e-07
Parameters: 4.15008
	iters: 100, epoch: 9 | loss: 0.3513402
	speed: 0.6385s/iter; left time: 7323.0323s
	iters: 200, epoch: 9 | loss: 0.3973396
	speed: 0.1010s/iter; left time: 1148.2647s
	iters: 300, epoch: 9 | loss: 0.3631531
	speed: 0.0981s/iter; left time: 1105.4756s
	iters: 400, epoch: 9 | loss: 0.7380349
	speed: 0.0974s/iter; left time: 1087.9144s
	iters: 500, epoch: 9 | loss: 0.6048014
	speed: 0.0971s/iter; left time: 1074.4188s
	iters: 600, epoch: 9 | loss: 0.7045518
	speed: 0.0959s/iter; left time: 1052.0654s
	iters: 700, epoch: 9 | loss: 0.5975584
	speed: 0.1040s/iter; left time: 1129.9209s
	iters: 800, epoch: 9 | loss: 0.5980430
	speed: 0.0984s/iter; left time: 1060.0587s
	iters: 900, epoch: 9 | loss: 0.6323918
	speed: 0.0956s/iter; left time: 1020.2314s
Epoch: 9 cost time: 96.0908522605896
Epoch: 9, Steps: 964 | Train Loss: 0.5172281 Vali Loss: 0.8132226 Test Loss: 4.2485871
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.90625e-07
Parameters: 4.15008
	iters: 100, epoch: 10 | loss: 0.4020346
	speed: 0.6249s/iter; left time: 6564.8370s
	iters: 200, epoch: 10 | loss: 0.4167926
	speed: 0.0997s/iter; left time: 1037.8439s
	iters: 300, epoch: 10 | loss: 0.5896239
	speed: 0.0959s/iter; left time: 988.6932s
	iters: 400, epoch: 10 | loss: 0.4722427
	speed: 0.0954s/iter; left time: 973.3986s
	iters: 500, epoch: 10 | loss: 0.5225607
	speed: 0.0970s/iter; left time: 980.4043s
	iters: 600, epoch: 10 | loss: 0.4735666
	speed: 0.0993s/iter; left time: 993.7754s
	iters: 700, epoch: 10 | loss: 0.6511533
	speed: 0.0966s/iter; left time: 957.1676s
	iters: 800, epoch: 10 | loss: 0.7064497
	speed: 0.0978s/iter; left time: 958.6308s
	iters: 900, epoch: 10 | loss: 0.4098250
	speed: 0.0981s/iter; left time: 952.0705s
Epoch: 10 cost time: 94.36628079414368
Epoch: 10, Steps: 964 | Train Loss: 0.5171916 Vali Loss: 0.8106860 Test Loss: 4.2473741
Validation loss decreased (0.810745 --> 0.810686).  Saving model ...
Updating learning rate to 1.953125e-07
Parameters: 4.15008
	iters: 100, epoch: 11 | loss: 0.5596962
	speed: 0.6207s/iter; left time: 5922.0969s
	iters: 200, epoch: 11 | loss: 0.5241458
	speed: 0.0956s/iter; left time: 902.5124s
	iters: 300, epoch: 11 | loss: 0.4381301
	speed: 0.0951s/iter; left time: 887.9838s
	iters: 400, epoch: 11 | loss: 0.6680630
	speed: 0.0975s/iter; left time: 901.3488s
	iters: 500, epoch: 11 | loss: 0.5988834
	speed: 0.0952s/iter; left time: 870.3326s
	iters: 600, epoch: 11 | loss: 0.6376120
	speed: 0.0934s/iter; left time: 844.2213s
	iters: 700, epoch: 11 | loss: 0.3559273
	speed: 0.0963s/iter; left time: 861.2047s
	iters: 800, epoch: 11 | loss: 0.5401143
	speed: 0.0969s/iter; left time: 856.7433s
	iters: 900, epoch: 11 | loss: 0.5133721
	speed: 0.0957s/iter; left time: 836.2724s
Epoch: 11 cost time: 92.86721158027649
Epoch: 11, Steps: 964 | Train Loss: 0.5171242 Vali Loss: 0.8111583 Test Loss: 4.2477589
EarlyStopping counter: 1 out of 5
Updating learning rate to 9.765625e-08
Parameters: 4.15008
	iters: 100, epoch: 12 | loss: 0.5150189
	speed: 0.6228s/iter; left time: 5341.7071s
	iters: 200, epoch: 12 | loss: 0.5400254
	speed: 0.0940s/iter; left time: 797.0680s
	iters: 300, epoch: 12 | loss: 0.3802584
	speed: 0.0943s/iter; left time: 790.2899s
	iters: 400, epoch: 12 | loss: 0.8198925
	speed: 0.0981s/iter; left time: 811.6969s
	iters: 500, epoch: 12 | loss: 0.5628714
	speed: 0.0974s/iter; left time: 796.2517s
	iters: 600, epoch: 12 | loss: 0.5044204
	speed: 0.0929s/iter; left time: 750.6492s
	iters: 700, epoch: 12 | loss: 0.3849501
	speed: 0.0949s/iter; left time: 756.6929s
	iters: 800, epoch: 12 | loss: 0.4492556
	speed: 0.1021s/iter; left time: 804.1381s
	iters: 900, epoch: 12 | loss: 0.5849764
	speed: 0.0946s/iter; left time: 735.5839s
Epoch: 12 cost time: 92.95414280891418
Epoch: 12, Steps: 964 | Train Loss: 0.5171069 Vali Loss: 0.8117127 Test Loss: 4.2482986
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.8828125e-08
Parameters: 4.15008
	iters: 100, epoch: 13 | loss: 0.5415822
	speed: 0.6233s/iter; left time: 4745.3068s
	iters: 200, epoch: 13 | loss: 0.4276243
	speed: 0.0968s/iter; left time: 727.5928s
	iters: 300, epoch: 13 | loss: 0.3252615
	speed: 0.0944s/iter; left time: 699.5003s
	iters: 400, epoch: 13 | loss: 0.3706109
	speed: 0.0935s/iter; left time: 684.0567s
	iters: 500, epoch: 13 | loss: 0.7125953
	speed: 0.0908s/iter; left time: 654.8857s
	iters: 600, epoch: 13 | loss: 0.3826248
	speed: 0.0938s/iter; left time: 667.4824s
	iters: 700, epoch: 13 | loss: 0.3473718
	speed: 0.0977s/iter; left time: 685.0713s
	iters: 800, epoch: 13 | loss: 0.2910672
	speed: 0.0972s/iter; left time: 671.8759s
	iters: 900, epoch: 13 | loss: 0.6451547
	speed: 0.0950s/iter; left time: 647.0325s
Epoch: 13 cost time: 92.32237696647644
Epoch: 13, Steps: 964 | Train Loss: 0.5171281 Vali Loss: 0.8123983 Test Loss: 4.2488565
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.44140625e-08
Parameters: 4.15008
	iters: 100, epoch: 14 | loss: 0.3935663
	speed: 0.6125s/iter; left time: 4072.6826s
	iters: 200, epoch: 14 | loss: 0.4047838
	speed: 0.0949s/iter; left time: 621.6767s
	iters: 300, epoch: 14 | loss: 0.3658258
	speed: 0.0969s/iter; left time: 624.8588s
	iters: 400, epoch: 14 | loss: 0.3886294
	speed: 0.1042s/iter; left time: 661.3234s
	iters: 500, epoch: 14 | loss: 0.3948085
	speed: 0.0990s/iter; left time: 618.5650s
	iters: 600, epoch: 14 | loss: 0.5000998
	speed: 0.0953s/iter; left time: 586.1696s
	iters: 700, epoch: 14 | loss: 0.4119008
	speed: 0.0941s/iter; left time: 569.4736s
	iters: 800, epoch: 14 | loss: 0.4574652
	speed: 0.0977s/iter; left time: 581.3226s
	iters: 900, epoch: 14 | loss: 0.5104811
	speed: 0.0961s/iter; left time: 562.2815s
Epoch: 14 cost time: 93.97159624099731
Epoch: 14, Steps: 964 | Train Loss: 0.5171375 Vali Loss: 0.8121656 Test Loss: 4.2487326
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.220703125e-08
Parameters: 4.15008
	iters: 100, epoch: 15 | loss: 0.4511681
	speed: 0.6314s/iter; left time: 3589.3942s
	iters: 200, epoch: 15 | loss: 0.5539320
	speed: 0.1183s/iter; left time: 660.8905s
	iters: 300, epoch: 15 | loss: 0.4786490
	speed: 0.1089s/iter; left time: 597.0786s
	iters: 400, epoch: 15 | loss: 0.6534622
	speed: 0.1070s/iter; left time: 576.4315s
	iters: 500, epoch: 15 | loss: 0.4006553
	speed: 0.1053s/iter; left time: 556.4753s
	iters: 600, epoch: 15 | loss: 0.4921908
	speed: 0.0956s/iter; left time: 495.5848s
	iters: 700, epoch: 15 | loss: 0.4341114
	speed: 0.0969s/iter; left time: 492.7201s
	iters: 800, epoch: 15 | loss: 0.4177175
	speed: 0.0985s/iter; left time: 491.0769s
	iters: 900, epoch: 15 | loss: 0.4580509
	speed: 0.0989s/iter; left time: 483.3448s
Epoch: 15 cost time: 100.30825781822205
Epoch: 15, Steps: 964 | Train Loss: 0.5170804 Vali Loss: 0.8114894 Test Loss: 4.2487807
EarlyStopping counter: 5 out of 5
Updating learning rate to 6.103515625e-09
Early stopping
>>>>>>>testing : long_term_forecast_DiscoveryPassage_and_others_720_360_96_tn_DLinear_custom_ftM_sl1440_ll48_pl1440_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Chlorophyll (ug/l) Chlorophyll (ug/l)
test 8198
test shape: (8198, 1, 1440, 8) (8198, 1, 1440, 8)
test shape: (8198, 1440, 8) (8198, 1440, 8)
mse:4.24737548828125, mae:1.099176287651062







bash ./scripts/DiscoveryPassage_and_others_Script/DLinear.sh
MODEL IMPLEMENTED= DLinear
PREDICTION LENGTH= 720
SEQUENCE LENGTH= 720
LEARNING RATE ADJUSTMENT= type1
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=8, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='DiscoveryPassage_and_others_merged.csv', dec_in=8, des='Exp', devices='0,1,2,3', distil=True, dropout=0.1, e_layers=2, embed='timeF', enc_in=8, factor=3, features='M', freq='h', gpu=0, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='DLinear', model_id='DiscoveryPassage_and_others_720_360_96_tn', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=720, root_path='./dataset/', seasonal_patterns='Monthly', seq_len=720, target='Chlorophyll (ug/l)', task_name='long_term_forecast', top_k=5, train_epochs=20, use_amp=False, use_gpu=False, use_multi_gpu=False, w_lin=0.01)
Use CPU
>>>>>>>start training : long_term_forecast_DiscoveryPassage_and_others_720_360_96_tn_DLinear_custom_ftM_sl720_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
Chlorophyll (ug/l) Chlorophyll (ug/l)
train 32291
Chlorophyll (ug/l) Chlorophyll (ug/l)
val 4101
Chlorophyll (ug/l) Chlorophyll (ug/l)
test 8918
Parameters: 1.03824
	iters: 100, epoch: 1 | loss: 0.4412165
	speed: 0.0242s/iter; left time: 486.5784s
	iters: 200, epoch: 1 | loss: 0.4321432
	speed: 0.0216s/iter; left time: 432.0307s
	iters: 300, epoch: 1 | loss: 0.4639703
	speed: 0.0206s/iter; left time: 409.5787s
	iters: 400, epoch: 1 | loss: 0.4283464
	speed: 0.0200s/iter; left time: 395.9601s
	iters: 500, epoch: 1 | loss: 0.3893406
	speed: 0.0200s/iter; left time: 392.6366s
	iters: 600, epoch: 1 | loss: 0.4642994
	speed: 0.0198s/iter; left time: 388.4517s
	iters: 700, epoch: 1 | loss: 0.3614746
	speed: 0.0194s/iter; left time: 377.3632s
	iters: 800, epoch: 1 | loss: 0.3348998
	speed: 0.0204s/iter; left time: 396.2474s
	iters: 900, epoch: 1 | loss: 0.3636765
	speed: 0.0201s/iter; left time: 388.3071s
	iters: 1000, epoch: 1 | loss: 0.3131016
	speed: 0.0202s/iter; left time: 386.7719s
Epoch: 1 cost time: 20.846002101898193
Epoch: 1, Steps: 1009 | Train Loss: 0.4340243 Vali Loss: 0.5754632 Test Loss: 3.0958495
Validation loss decreased (inf --> 0.575463).  Saving model ...
Updating learning rate to 0.0001
Parameters: 1.03824
	iters: 100, epoch: 2 | loss: 0.4131080
	speed: 0.1663s/iter; left time: 3171.7645s
	iters: 200, epoch: 2 | loss: 0.5648346
	speed: 0.0191s/iter; left time: 362.8540s
	iters: 300, epoch: 2 | loss: 0.4970687
	speed: 0.0196s/iter; left time: 370.3058s
	iters: 400, epoch: 2 | loss: 0.5684500
	speed: 0.0198s/iter; left time: 371.4737s
	iters: 500, epoch: 2 | loss: 0.3597293
	speed: 0.0198s/iter; left time: 370.0732s
	iters: 600, epoch: 2 | loss: 0.3339137
	speed: 0.0195s/iter; left time: 361.5879s
	iters: 700, epoch: 2 | loss: 0.5230390
	speed: 0.0196s/iter; left time: 361.4459s
	iters: 800, epoch: 2 | loss: 0.5934324
	speed: 0.0196s/iter; left time: 359.4769s
	iters: 900, epoch: 2 | loss: 0.2881178
	speed: 0.0198s/iter; left time: 362.6121s
	iters: 1000, epoch: 2 | loss: 0.4312043
	speed: 0.0198s/iter; left time: 359.8569s
Epoch: 2 cost time: 19.978872776031494
Epoch: 2, Steps: 1009 | Train Loss: 0.4232639 Vali Loss: 0.5689403 Test Loss: 3.1444554
Validation loss decreased (0.575463 --> 0.568940).  Saving model ...
Updating learning rate to 5e-05
Parameters: 1.03824
	iters: 100, epoch: 3 | loss: 0.4062545
	speed: 0.1663s/iter; left time: 3003.0503s
	iters: 200, epoch: 3 | loss: 0.6465854
	speed: 0.0204s/iter; left time: 366.7395s
	iters: 300, epoch: 3 | loss: 0.2574045
	speed: 0.0203s/iter; left time: 363.0577s
	iters: 400, epoch: 3 | loss: 0.4210831
	speed: 0.0192s/iter; left time: 341.2484s
	iters: 500, epoch: 3 | loss: 0.4405020
	speed: 0.0184s/iter; left time: 324.5211s
	iters: 600, epoch: 3 | loss: 0.4569615
	speed: 0.0196s/iter; left time: 344.2670s
	iters: 700, epoch: 3 | loss: 0.4472745
	speed: 0.0203s/iter; left time: 353.8865s
	iters: 800, epoch: 3 | loss: 0.3708567
	speed: 0.0201s/iter; left time: 349.1651s
	iters: 900, epoch: 3 | loss: 0.4076126
	speed: 0.0199s/iter; left time: 343.4248s
	iters: 1000, epoch: 3 | loss: 0.3839605
	speed: 0.0193s/iter; left time: 330.6011s
Epoch: 3 cost time: 19.989407300949097
Epoch: 3, Steps: 1009 | Train Loss: 0.4203363 Vali Loss: 0.5657243 Test Loss: 3.1348717
Validation loss decreased (0.568940 --> 0.565724).  Saving model ...
Updating learning rate to 2.5e-05
Parameters: 1.03824
	iters: 100, epoch: 4 | loss: 0.4217029
	speed: 0.1681s/iter; left time: 2866.4741s
	iters: 200, epoch: 4 | loss: 0.5032313
	speed: 0.0201s/iter; left time: 340.9767s
	iters: 300, epoch: 4 | loss: 0.3485395
	speed: 0.0194s/iter; left time: 327.3532s
	iters: 400, epoch: 4 | loss: 0.4387706
	speed: 0.0198s/iter; left time: 332.1225s
	iters: 500, epoch: 4 | loss: 0.2299964
	speed: 0.0212s/iter; left time: 352.5295s
	iters: 600, epoch: 4 | loss: 0.6003447
	speed: 0.0203s/iter; left time: 335.5843s
	iters: 700, epoch: 4 | loss: 0.2973149
	speed: 0.0204s/iter; left time: 334.9577s
	iters: 800, epoch: 4 | loss: 0.5309653
	speed: 0.0202s/iter; left time: 330.2242s
	iters: 900, epoch: 4 | loss: 0.5173782
	speed: 0.0199s/iter; left time: 323.1766s
	iters: 1000, epoch: 4 | loss: 0.4951279
	speed: 0.0206s/iter; left time: 332.4424s
Epoch: 4 cost time: 20.547221899032593
Epoch: 4, Steps: 1009 | Train Loss: 0.4189353 Vali Loss: 0.5673498 Test Loss: 3.1298535
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.25e-05
Parameters: 1.03824
	iters: 100, epoch: 5 | loss: 0.6070867
	speed: 0.1673s/iter; left time: 2684.0996s
	iters: 200, epoch: 5 | loss: 0.5221661
	speed: 0.0209s/iter; left time: 333.5351s
	iters: 300, epoch: 5 | loss: 0.4064248
	speed: 0.0204s/iter; left time: 322.6140s
	iters: 400, epoch: 5 | loss: 0.4345463
	speed: 0.0202s/iter; left time: 318.3782s
	iters: 500, epoch: 5 | loss: 0.3898571
	speed: 0.0191s/iter; left time: 298.2465s
	iters: 600, epoch: 5 | loss: 0.4930373
	speed: 0.0199s/iter; left time: 308.5803s
	iters: 700, epoch: 5 | loss: 0.2834571
	speed: 0.0202s/iter; left time: 312.5217s
	iters: 800, epoch: 5 | loss: 0.7020218
	speed: 0.0206s/iter; left time: 316.5805s
	iters: 900, epoch: 5 | loss: 0.5707753
	speed: 0.0194s/iter; left time: 295.2692s
	iters: 1000, epoch: 5 | loss: 0.4192382
	speed: 0.0186s/iter; left time: 281.9663s
Epoch: 5 cost time: 20.252146244049072
Epoch: 5, Steps: 1009 | Train Loss: 0.4181536 Vali Loss: 0.5701838 Test Loss: 3.1128800
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.25e-06
Parameters: 1.03824
	iters: 100, epoch: 6 | loss: 0.2560641
	speed: 0.1725s/iter; left time: 2594.4601s
	iters: 200, epoch: 6 | loss: 0.3334929
	speed: 0.0209s/iter; left time: 311.6812s
	iters: 300, epoch: 6 | loss: 0.4620281
	speed: 0.0207s/iter; left time: 306.8307s
	iters: 400, epoch: 6 | loss: 0.4135651
	speed: 0.0202s/iter; left time: 297.5068s
	iters: 500, epoch: 6 | loss: 0.3009093
	speed: 0.0207s/iter; left time: 303.3464s
	iters: 600, epoch: 6 | loss: 0.3787678
	speed: 0.0208s/iter; left time: 302.9617s
	iters: 700, epoch: 6 | loss: 0.5412173
	speed: 0.0211s/iter; left time: 304.9382s
	iters: 800, epoch: 6 | loss: 0.3320065
	speed: 0.0220s/iter; left time: 315.4015s
	iters: 900, epoch: 6 | loss: 0.4331014
	speed: 0.0201s/iter; left time: 285.5720s
	iters: 1000, epoch: 6 | loss: 0.4708143
	speed: 0.0213s/iter; left time: 301.5008s
Epoch: 6 cost time: 21.216354370117188
Epoch: 6, Steps: 1009 | Train Loss: 0.4178235 Vali Loss: 0.5684328 Test Loss: 3.1219695
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.125e-06
Parameters: 1.03824
	iters: 100, epoch: 7 | loss: 0.5914410
	speed: 0.1837s/iter; left time: 2577.3015s
	iters: 200, epoch: 7 | loss: 0.2576490
	speed: 0.0235s/iter; left time: 326.9387s
	iters: 300, epoch: 7 | loss: 0.3457520
	speed: 0.0215s/iter; left time: 297.3310s
	iters: 400, epoch: 7 | loss: 0.3618022
	speed: 0.0215s/iter; left time: 294.6368s
	iters: 500, epoch: 7 | loss: 0.3250545
	speed: 0.0203s/iter; left time: 276.7843s
	iters: 600, epoch: 7 | loss: 0.4452140
	speed: 0.0213s/iter; left time: 287.9558s
	iters: 700, epoch: 7 | loss: 0.3011414
	speed: 0.0220s/iter; left time: 295.0795s
	iters: 800, epoch: 7 | loss: 0.4621719
	speed: 0.0211s/iter; left time: 281.7841s
	iters: 900, epoch: 7 | loss: 0.2104117
	speed: 0.0226s/iter; left time: 298.7338s
	iters: 1000, epoch: 7 | loss: 0.5734856
	speed: 0.0220s/iter; left time: 288.9385s
Epoch: 7 cost time: 22.028178215026855
Epoch: 7, Steps: 1009 | Train Loss: 0.4176075 Vali Loss: 0.5684800 Test Loss: 3.1201520
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.5625e-06
Parameters: 1.03824
	iters: 100, epoch: 8 | loss: 0.3389207
	speed: 0.1861s/iter; left time: 2422.0798s
	iters: 200, epoch: 8 | loss: 0.7143763
	speed: 0.0224s/iter; left time: 289.1285s
	iters: 300, epoch: 8 | loss: 0.4142866
	speed: 0.0217s/iter; left time: 277.6645s
	iters: 400, epoch: 8 | loss: 0.4852643
	speed: 0.0218s/iter; left time: 277.0950s
	iters: 500, epoch: 8 | loss: 0.3683166
	speed: 0.0232s/iter; left time: 293.0229s
	iters: 600, epoch: 8 | loss: 0.3099951
	speed: 0.0226s/iter; left time: 282.6686s
	iters: 700, epoch: 8 | loss: 0.2810011
	speed: 0.0217s/iter; left time: 270.0650s
	iters: 800, epoch: 8 | loss: 0.5402705
	speed: 0.0209s/iter; left time: 257.9673s
	iters: 900, epoch: 8 | loss: 0.4707504
	speed: 0.0210s/iter; left time: 256.5564s
	iters: 1000, epoch: 8 | loss: 0.5486189
	speed: 0.0214s/iter; left time: 259.5166s
Epoch: 8 cost time: 22.26177978515625
Epoch: 8, Steps: 1009 | Train Loss: 0.4174800 Vali Loss: 0.5677399 Test Loss: 3.1211026
EarlyStopping counter: 5 out of 5
Updating learning rate to 7.8125e-07
Early stopping
>>>>>>>testing : long_term_forecast_DiscoveryPassage_and_others_720_360_96_tn_DLinear_custom_ftM_sl720_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Chlorophyll (ug/l) Chlorophyll (ug/l)
test 8918
test shape: (8918, 1, 720, 8) (8918, 1, 720, 8)
test shape: (8918, 720, 8) (8918, 720, 8)
mse:3.1348679065704346, mae:0.8354629874229431

























/usr/local/bin/python3
MODEL IMPLEMENTED= DLinear
PREDICTION LENGTH= 360
SEQUENCE LENGTH= 360
LEARNING RATE ADJUSTMENT= type1
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=8, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='DiscoveryPassage_and_others_merged.csv', dec_in=8, des='Exp', devices='0,1,2,3', distil=True, dropout=0.1, e_layers=2, embed='timeF', enc_in=8, factor=3, features='M', freq='h', gpu=0, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='DLinear', model_id='DiscoveryPassage_and_others_720_360_96_tn', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=360, root_path='./dataset/', seasonal_patterns='Monthly', seq_len=360, target='Chlorophyll (ug/l)', task_name='long_term_forecast', top_k=5, train_epochs=20, use_amp=False, use_gpu=False, use_multi_gpu=False, w_lin=0.01)
Use CPU
>>>>>>>start training : long_term_forecast_DiscoveryPassage_and_others_720_360_96_tn_DLinear_custom_ftM_sl360_ll48_pl360_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
Chlorophyll (ug/l) Chlorophyll (ug/l)
train 33011
Chlorophyll (ug/l) Chlorophyll (ug/l)
val 4461
Chlorophyll (ug/l) Chlorophyll (ug/l)
test 9278
Parameters: 0.25992
	iters: 100, epoch: 1 | loss: 0.4045343
	speed: 0.0105s/iter; left time: 216.2229s
	iters: 200, epoch: 1 | loss: 0.3863550
	speed: 0.0075s/iter; left time: 152.3800s
	iters: 300, epoch: 1 | loss: 0.3520814
	speed: 0.0077s/iter; left time: 156.5677s
	iters: 400, epoch: 1 | loss: 0.5589414
	speed: 0.0077s/iter; left time: 156.3667s
	iters: 500, epoch: 1 | loss: 0.3392421
	speed: 0.0075s/iter; left time: 150.4172s
	iters: 600, epoch: 1 | loss: 0.2202213
	speed: 0.0071s/iter; left time: 141.9402s
	iters: 700, epoch: 1 | loss: 0.3783899
	speed: 0.0076s/iter; left time: 150.5473s
	iters: 800, epoch: 1 | loss: 0.4852789
	speed: 0.0075s/iter; left time: 149.5588s
	iters: 900, epoch: 1 | loss: 0.4679153
	speed: 0.0075s/iter; left time: 147.1766s
	iters: 1000, epoch: 1 | loss: 0.2342732
	speed: 0.0075s/iter; left time: 146.8922s
Epoch: 1 cost time: 8.04853367805481
Epoch: 1, Steps: 1031 | Train Loss: 0.3955862 Vali Loss: 0.4144574 Test Loss: 2.1938758
Validation loss decreased (inf --> 0.414457).  Saving model ...
Updating learning rate to 0.0001
Parameters: 0.25992
	iters: 100, epoch: 2 | loss: 0.4048910
	speed: 0.1164s/iter; left time: 2269.5158s
	iters: 200, epoch: 2 | loss: 0.2963309
	speed: 0.0083s/iter; left time: 161.5400s
	iters: 300, epoch: 2 | loss: 0.4043772
	speed: 0.0080s/iter; left time: 154.5815s
	iters: 400, epoch: 2 | loss: 0.5532544
	speed: 0.0077s/iter; left time: 147.1561s
	iters: 500, epoch: 2 | loss: 0.3199508
	speed: 0.0079s/iter; left time: 150.6950s
	iters: 600, epoch: 2 | loss: 0.4895270
	speed: 0.0080s/iter; left time: 152.4339s
	iters: 700, epoch: 2 | loss: 0.5011769
	speed: 0.0083s/iter; left time: 155.9427s
	iters: 800, epoch: 2 | loss: 0.4263158
	speed: 0.0080s/iter; left time: 149.7790s
	iters: 900, epoch: 2 | loss: 0.3786672
	speed: 0.0078s/iter; left time: 145.3090s
	iters: 1000, epoch: 2 | loss: 0.2903525
	speed: 0.0079s/iter; left time: 147.1075s
Epoch: 2 cost time: 8.3093900680542
Epoch: 2, Steps: 1031 | Train Loss: 0.3849374 Vali Loss: 0.4101669 Test Loss: 2.1913786
Validation loss decreased (0.414457 --> 0.410167).  Saving model ...
Updating learning rate to 5e-05
Parameters: 0.25992
	iters: 100, epoch: 3 | loss: 0.3642186
	speed: 0.1168s/iter; left time: 2155.4050s
	iters: 200, epoch: 3 | loss: 0.3737884
	speed: 0.0075s/iter; left time: 138.5078s
	iters: 300, epoch: 3 | loss: 0.4857275
	speed: 0.0075s/iter; left time: 137.3315s
	iters: 400, epoch: 3 | loss: 0.4020127
	speed: 0.0074s/iter; left time: 134.9537s
	iters: 500, epoch: 3 | loss: 0.4433075
	speed: 0.0077s/iter; left time: 139.2322s
	iters: 600, epoch: 3 | loss: 0.4494540
	speed: 0.0076s/iter; left time: 136.9046s
	iters: 700, epoch: 3 | loss: 0.4382730
	speed: 0.0075s/iter; left time: 134.6598s
	iters: 800, epoch: 3 | loss: 0.5018294
	speed: 0.0075s/iter; left time: 133.8910s
	iters: 900, epoch: 3 | loss: 0.4187752
	speed: 0.0076s/iter; left time: 134.8455s
	iters: 1000, epoch: 3 | loss: 0.4024105
	speed: 0.0075s/iter; left time: 131.6617s
Epoch: 3 cost time: 7.887959957122803
Epoch: 3, Steps: 1031 | Train Loss: 0.3832235 Vali Loss: 0.4094434 Test Loss: 2.1889164
Validation loss decreased (0.410167 --> 0.409443).  Saving model ...
Updating learning rate to 2.5e-05
Parameters: 0.25992
	iters: 100, epoch: 4 | loss: 0.4689813
	speed: 0.1181s/iter; left time: 2058.3718s
	iters: 200, epoch: 4 | loss: 0.3490294
	speed: 0.0079s/iter; left time: 136.3637s
	iters: 300, epoch: 4 | loss: 0.3966170
	speed: 0.0079s/iter; left time: 136.2851s
	iters: 400, epoch: 4 | loss: 0.3526271
	speed: 0.0078s/iter; left time: 134.2313s
	iters: 500, epoch: 4 | loss: 0.5595388
	speed: 0.0080s/iter; left time: 135.4491s
	iters: 600, epoch: 4 | loss: 0.3371363
	speed: 0.0079s/iter; left time: 134.5648s
	iters: 700, epoch: 4 | loss: 0.3444332
	speed: 0.0080s/iter; left time: 134.4075s
	iters: 800, epoch: 4 | loss: 0.4005368
	speed: 0.0080s/iter; left time: 134.4066s
	iters: 900, epoch: 4 | loss: 0.3934543
	speed: 0.0080s/iter; left time: 133.5133s
	iters: 1000, epoch: 4 | loss: 0.4582691
	speed: 0.0081s/iter; left time: 133.1633s
Epoch: 4 cost time: 8.279850959777832
Epoch: 4, Steps: 1031 | Train Loss: 0.3823581 Vali Loss: 0.4079419 Test Loss: 2.1944840
Validation loss decreased (0.409443 --> 0.407942).  Saving model ...
Updating learning rate to 1.25e-05
Parameters: 0.25992
	iters: 100, epoch: 5 | loss: 0.4718348
	speed: 0.1206s/iter; left time: 1978.0840s
	iters: 200, epoch: 5 | loss: 0.4589248
	speed: 0.0082s/iter; left time: 134.1133s
	iters: 300, epoch: 5 | loss: 0.2933043
	speed: 0.0082s/iter; left time: 133.0695s
	iters: 400, epoch: 5 | loss: 0.3745275
	speed: 0.0083s/iter; left time: 134.1229s
	iters: 500, epoch: 5 | loss: 0.3865540
	speed: 0.0083s/iter; left time: 132.9170s
	iters: 600, epoch: 5 | loss: 0.4719492
	speed: 0.0083s/iter; left time: 131.2883s
	iters: 700, epoch: 5 | loss: 0.4453549
	speed: 0.0084s/iter; left time: 132.6170s
	iters: 800, epoch: 5 | loss: 0.3749619
	speed: 0.0084s/iter; left time: 131.2828s
	iters: 900, epoch: 5 | loss: 0.1434284
	speed: 0.0085s/iter; left time: 132.3729s
	iters: 1000, epoch: 5 | loss: 0.3090873
	speed: 0.0083s/iter; left time: 129.3831s
Epoch: 5 cost time: 8.653891563415527
Epoch: 5, Steps: 1031 | Train Loss: 0.3819523 Vali Loss: 0.4081954 Test Loss: 2.1888354
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.25e-06
Parameters: 0.25992
	iters: 100, epoch: 6 | loss: 0.3336249
	speed: 0.1259s/iter; left time: 1933.9712s
	iters: 200, epoch: 6 | loss: 0.4345214
	speed: 0.0085s/iter; left time: 129.0767s
	iters: 300, epoch: 6 | loss: 0.3240911
	speed: 0.0084s/iter; left time: 127.0150s
	iters: 400, epoch: 6 | loss: 0.3577083
	speed: 0.0084s/iter; left time: 126.3618s
	iters: 500, epoch: 6 | loss: 0.4875685
	speed: 0.0084s/iter; left time: 125.5665s
	iters: 600, epoch: 6 | loss: 0.4373583
	speed: 0.0084s/iter; left time: 125.4654s
	iters: 700, epoch: 6 | loss: 0.2991907
	speed: 0.0084s/iter; left time: 124.4842s
	iters: 800, epoch: 6 | loss: 0.3074571
	speed: 0.0084s/iter; left time: 123.6086s
	iters: 900, epoch: 6 | loss: 0.2993945
	speed: 0.0085s/iter; left time: 123.3881s
	iters: 1000, epoch: 6 | loss: 0.4455962
	speed: 0.0088s/iter; left time: 126.8739s
Epoch: 6 cost time: 8.846641063690186
Epoch: 6, Steps: 1031 | Train Loss: 0.3817234 Vali Loss: 0.4078240 Test Loss: 2.1913719
Validation loss decreased (0.407942 --> 0.407824).  Saving model ...
Updating learning rate to 3.125e-06
Parameters: 0.25992
	iters: 100, epoch: 7 | loss: 0.5256947
	speed: 0.1305s/iter; left time: 1870.8601s
	iters: 200, epoch: 7 | loss: 0.4821374
	speed: 0.0092s/iter; left time: 130.9725s
	iters: 300, epoch: 7 | loss: 0.3414401
	speed: 0.0090s/iter; left time: 127.0167s
	iters: 400, epoch: 7 | loss: 0.4890208
	speed: 0.0084s/iter; left time: 118.3665s
	iters: 500, epoch: 7 | loss: 0.5818436
	speed: 0.0086s/iter; left time: 119.5746s
	iters: 600, epoch: 7 | loss: 0.4115681
	speed: 0.0087s/iter; left time: 119.8554s
	iters: 700, epoch: 7 | loss: 0.3575954
	speed: 0.0086s/iter; left time: 118.0434s
	iters: 800, epoch: 7 | loss: 0.3131892
	speed: 0.0086s/iter; left time: 117.4731s
	iters: 900, epoch: 7 | loss: 0.4199309
	speed: 0.0087s/iter; left time: 117.8176s
	iters: 1000, epoch: 7 | loss: 0.3458925
	speed: 0.0087s/iter; left time: 116.6693s
Epoch: 7 cost time: 9.071868181228638
Epoch: 7, Steps: 1031 | Train Loss: 0.3816782 Vali Loss: 0.4078913 Test Loss: 2.1893990
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.5625e-06
Parameters: 0.25992
	iters: 100, epoch: 8 | loss: 0.2692165
	speed: 0.1304s/iter; left time: 1734.6345s
	iters: 200, epoch: 8 | loss: 0.5537443
	speed: 0.0086s/iter; left time: 113.0567s
	iters: 300, epoch: 8 | loss: 0.4250941
	speed: 0.0085s/iter; left time: 111.6223s
	iters: 400, epoch: 8 | loss: 0.2544521
	speed: 0.0086s/iter; left time: 111.4646s
	iters: 500, epoch: 8 | loss: 0.2588136
	speed: 0.0086s/iter; left time: 111.2524s
	iters: 600, epoch: 8 | loss: 0.2754377
	speed: 0.0086s/iter; left time: 110.6877s
	iters: 700, epoch: 8 | loss: 0.3738313
	speed: 0.0086s/iter; left time: 109.8633s
	iters: 800, epoch: 8 | loss: 0.1964215
	speed: 0.0084s/iter; left time: 106.2792s
	iters: 900, epoch: 8 | loss: 0.3165007
	speed: 0.0085s/iter; left time: 106.6062s
	iters: 1000, epoch: 8 | loss: 0.3970699
	speed: 0.0086s/iter; left time: 107.0375s
Epoch: 8 cost time: 8.948782205581665
Epoch: 8, Steps: 1031 | Train Loss: 0.3816846 Vali Loss: 0.4082210 Test Loss: 2.1895044
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.8125e-07
Parameters: 0.25992
	iters: 100, epoch: 9 | loss: 0.3625944
	speed: 0.1318s/iter; left time: 1616.9727s
	iters: 200, epoch: 9 | loss: 0.4910913
	speed: 0.0089s/iter; left time: 108.9426s
	iters: 300, epoch: 9 | loss: 0.3703157
	speed: 0.0088s/iter; left time: 105.6464s
	iters: 400, epoch: 9 | loss: 0.4595189
	speed: 0.0085s/iter; left time: 101.7997s
	iters: 500, epoch: 9 | loss: 0.2637033
	speed: 0.0085s/iter; left time: 101.2984s
	iters: 600, epoch: 9 | loss: 0.4961152
	speed: 0.0085s/iter; left time: 100.5550s
	iters: 700, epoch: 9 | loss: 0.3787116
	speed: 0.0085s/iter; left time: 99.4048s
	iters: 800, epoch: 9 | loss: 0.1866453
	speed: 0.0084s/iter; left time: 96.7738s
	iters: 900, epoch: 9 | loss: 0.4258050
	speed: 0.0085s/iter; left time: 97.5027s
	iters: 1000, epoch: 9 | loss: 0.3699576
	speed: 0.0085s/iter; left time: 96.6922s
Epoch: 9 cost time: 8.929444551467896
Epoch: 9, Steps: 1031 | Train Loss: 0.3815796 Vali Loss: 0.4082949 Test Loss: 2.1900673
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.90625e-07
Parameters: 0.25992
	iters: 100, epoch: 10 | loss: 0.2544138
	speed: 0.1288s/iter; left time: 1447.6972s
	iters: 200, epoch: 10 | loss: 0.4030392
	speed: 0.0087s/iter; left time: 96.6110s
	iters: 300, epoch: 10 | loss: 0.4391156
	speed: 0.0086s/iter; left time: 95.4663s
	iters: 400, epoch: 10 | loss: 0.2852498
	speed: 0.0085s/iter; left time: 93.4735s
	iters: 500, epoch: 10 | loss: 0.2658718
	speed: 0.0093s/iter; left time: 100.8409s
	iters: 600, epoch: 10 | loss: 0.4077008
	speed: 0.0086s/iter; left time: 92.4379s
	iters: 700, epoch: 10 | loss: 0.3226377
	speed: 0.0086s/iter; left time: 91.5165s
	iters: 800, epoch: 10 | loss: 0.2666786
	speed: 0.0087s/iter; left time: 91.8648s
	iters: 900, epoch: 10 | loss: 0.2733551
	speed: 0.0088s/iter; left time: 92.3185s
	iters: 1000, epoch: 10 | loss: 0.3614329
	speed: 0.0090s/iter; left time: 93.0632s
Epoch: 10 cost time: 9.126354932785034
Epoch: 10, Steps: 1031 | Train Loss: 0.3816224 Vali Loss: 0.4081765 Test Loss: 2.1898837
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.953125e-07
Parameters: 0.25992
	iters: 100, epoch: 11 | loss: 0.4136331
	speed: 0.1276s/iter; left time: 1302.9262s
	iters: 200, epoch: 11 | loss: 0.5275482
	speed: 0.0086s/iter; left time: 86.9413s
	iters: 300, epoch: 11 | loss: 0.3692183
	speed: 0.0085s/iter; left time: 85.1805s
	iters: 400, epoch: 11 | loss: 0.5616516
	speed: 0.0086s/iter; left time: 84.7873s
	iters: 500, epoch: 11 | loss: 0.5382237
	speed: 0.0085s/iter; left time: 83.5639s
	iters: 600, epoch: 11 | loss: 0.4068015
	speed: 0.0086s/iter; left time: 83.9395s
	iters: 700, epoch: 11 | loss: 0.4773647
	speed: 0.0087s/iter; left time: 83.6515s
	iters: 800, epoch: 11 | loss: 0.3273528
	speed: 0.0086s/iter; left time: 82.2700s
	iters: 900, epoch: 11 | loss: 0.2536335
	speed: 0.0086s/iter; left time: 80.4659s
	iters: 1000, epoch: 11 | loss: 0.3479182
	speed: 0.0085s/iter; left time: 78.8778s
Epoch: 11 cost time: 8.950031518936157
Epoch: 11, Steps: 1031 | Train Loss: 0.3816504 Vali Loss: 0.4072182 Test Loss: 2.1899393
Validation loss decreased (0.407824 --> 0.407218).  Saving model ...
Updating learning rate to 9.765625e-08
Parameters: 0.25992
	iters: 100, epoch: 12 | loss: 0.4709733
	speed: 0.1266s/iter; left time: 1162.2992s
	iters: 200, epoch: 12 | loss: 0.5554839
	speed: 0.0087s/iter; left time: 78.6472s
	iters: 300, epoch: 12 | loss: 0.4008529
	speed: 0.0086s/iter; left time: 77.5116s
	iters: 400, epoch: 12 | loss: 0.3551465
	speed: 0.0088s/iter; left time: 78.3095s
	iters: 500, epoch: 12 | loss: 0.4182251
	speed: 0.0087s/iter; left time: 76.0546s
	iters: 600, epoch: 12 | loss: 0.3455089
	speed: 0.0087s/iter; left time: 75.3272s
	iters: 700, epoch: 12 | loss: 0.3178708
	speed: 0.0087s/iter; left time: 74.9928s
	iters: 800, epoch: 12 | loss: 0.3512971
	speed: 0.0086s/iter; left time: 72.8023s
	iters: 900, epoch: 12 | loss: 0.4852372
	speed: 0.0085s/iter; left time: 71.4432s
	iters: 1000, epoch: 12 | loss: 0.2917811
	speed: 0.0089s/iter; left time: 73.3065s
Epoch: 12 cost time: 9.05454683303833
Epoch: 12, Steps: 1031 | Train Loss: 0.3815442 Vali Loss: 0.4079936 Test Loss: 2.1899297
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.8828125e-08
Parameters: 0.25992
	iters: 100, epoch: 13 | loss: 0.3479893
	speed: 0.1270s/iter; left time: 1034.8369s
	iters: 200, epoch: 13 | loss: 0.3164733
	speed: 0.0084s/iter; left time: 67.6437s
	iters: 300, epoch: 13 | loss: 0.3118021
	speed: 0.0086s/iter; left time: 68.1289s
	iters: 400, epoch: 13 | loss: 0.4457029
	speed: 0.0091s/iter; left time: 71.5907s
	iters: 500, epoch: 13 | loss: 0.4646876
	speed: 0.0088s/iter; left time: 68.0024s
	iters: 600, epoch: 13 | loss: 0.2299712
	speed: 0.0084s/iter; left time: 64.4533s
	iters: 700, epoch: 13 | loss: 0.3622927
	speed: 0.0088s/iter; left time: 66.1690s
	iters: 800, epoch: 13 | loss: 0.4096561
	speed: 0.0085s/iter; left time: 62.9494s
	iters: 900, epoch: 13 | loss: 0.4379199
	speed: 0.0085s/iter; left time: 62.2720s
	iters: 1000, epoch: 13 | loss: 0.3309602
	speed: 0.0089s/iter; left time: 64.6126s
Epoch: 13 cost time: 8.9800705909729
Epoch: 13, Steps: 1031 | Train Loss: 0.3815464 Vali Loss: 0.4075401 Test Loss: 2.1899197
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.44140625e-08
Parameters: 0.25992
	iters: 100, epoch: 14 | loss: 0.3719403
	speed: 0.1268s/iter; left time: 902.2686s
	iters: 200, epoch: 14 | loss: 0.3478902
	speed: 0.0086s/iter; left time: 60.4278s
	iters: 300, epoch: 14 | loss: 0.3867006
	speed: 0.0086s/iter; left time: 59.7527s
	iters: 400, epoch: 14 | loss: 0.2462068
	speed: 0.0085s/iter; left time: 57.9397s
	iters: 500, epoch: 14 | loss: 0.4098640
	speed: 0.0087s/iter; left time: 58.3804s
	iters: 600, epoch: 14 | loss: 0.5186264
	speed: 0.0087s/iter; left time: 57.6425s
	iters: 700, epoch: 14 | loss: 0.5259167
	speed: 0.0087s/iter; left time: 56.4085s
	iters: 800, epoch: 14 | loss: 0.5278425
	speed: 0.0086s/iter; left time: 55.2450s
	iters: 900, epoch: 14 | loss: 0.2823672
	speed: 0.0086s/iter; left time: 54.3213s
	iters: 1000, epoch: 14 | loss: 0.4631484
	speed: 0.0086s/iter; left time: 53.5143s
Epoch: 14 cost time: 8.973135709762573
Epoch: 14, Steps: 1031 | Train Loss: 0.3816648 Vali Loss: 0.4081253 Test Loss: 2.1899164
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.220703125e-08
Parameters: 0.25992
	iters: 100, epoch: 15 | loss: 0.5089288
	speed: 0.1275s/iter; left time: 776.0017s
	iters: 200, epoch: 15 | loss: 0.4585328
	speed: 0.0087s/iter; left time: 52.1751s
	iters: 300, epoch: 15 | loss: 0.6300048
	speed: 0.0086s/iter; left time: 50.7072s
	iters: 400, epoch: 15 | loss: 0.4374986
	speed: 0.0088s/iter; left time: 50.8176s
	iters: 500, epoch: 15 | loss: 0.6009024
	speed: 0.0087s/iter; left time: 49.5063s
	iters: 600, epoch: 15 | loss: 0.1943961
	speed: 0.0087s/iter; left time: 48.5993s
	iters: 700, epoch: 15 | loss: 0.3483685
	speed: 0.0085s/iter; left time: 46.8848s
	iters: 800, epoch: 15 | loss: 0.4382428
	speed: 0.0087s/iter; left time: 46.8779s
	iters: 900, epoch: 15 | loss: 0.4524968
	speed: 0.0088s/iter; left time: 46.2702s
	iters: 1000, epoch: 15 | loss: 0.3499029
	speed: 0.0087s/iter; left time: 44.9448s
Epoch: 15 cost time: 9.05118203163147
Epoch: 15, Steps: 1031 | Train Loss: 0.3816046 Vali Loss: 0.4081906 Test Loss: 2.1899147
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.103515625e-09
Parameters: 0.25992
	iters: 100, epoch: 16 | loss: 0.2772909
	speed: 0.1274s/iter; left time: 644.1709s
	iters: 200, epoch: 16 | loss: 0.5172798
	speed: 0.0088s/iter; left time: 43.7443s
	iters: 300, epoch: 16 | loss: 0.3487391
	speed: 0.0088s/iter; left time: 42.7605s
	iters: 400, epoch: 16 | loss: 0.3049587
	speed: 0.0087s/iter; left time: 41.1947s
	iters: 500, epoch: 16 | loss: 0.3157886
	speed: 0.0077s/iter; left time: 35.9113s
	iters: 600, epoch: 16 | loss: 0.2574247
	speed: 0.0078s/iter; left time: 35.6857s
	iters: 700, epoch: 16 | loss: 0.4812288
	speed: 0.0079s/iter; left time: 35.2707s
	iters: 800, epoch: 16 | loss: 0.5073242
	speed: 0.0080s/iter; left time: 34.8153s
	iters: 900, epoch: 16 | loss: 0.3120193
	speed: 0.0084s/iter; left time: 35.6025s
	iters: 1000, epoch: 16 | loss: 0.5327020
	speed: 0.0088s/iter; left time: 36.6972s
Epoch: 16 cost time: 8.707107782363892
Epoch: 16, Steps: 1031 | Train Loss: 0.3814913 Vali Loss: 0.4082270 Test Loss: 2.1899142
EarlyStopping counter: 5 out of 5
Updating learning rate to 3.0517578125e-09
Early stopping
>>>>>>>testing : long_term_forecast_DiscoveryPassage_and_others_720_360_96_tn_DLinear_custom_ftM_sl360_ll48_pl360_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Chlorophyll (ug/l) Chlorophyll (ug/l)
test 9278
test shape: (9278, 1, 360, 8) (9278, 1, 360, 8)
test shape: (9278, 360, 8) (9278, 360, 8)
mse:2.189939498901367, mae:0.6377171277999878










bash ./scripts/DiscoveryPassage_and_others_Script/DLinear.sh
MODEL IMPLEMENTED= DLinear
PREDICTION LENGTH= 336
SEQUENCE LENGTH= 336
LEARNING RATE ADJUSTMENT= type1
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=8, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='DiscoveryPassage_and_others_merged.csv', dec_in=8, des='Exp', devices='0,1,2,3', distil=True, dropout=0.1, e_layers=2, embed='timeF', enc_in=8, factor=3, features='M', freq='h', gpu=0, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='DLinear', model_id='DiscoveryPassage_and_others_720_360_96_tn', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=336, root_path='./dataset/', seasonal_patterns='Monthly', seq_len=336, target='Chlorophyll (ug/l)', task_name='long_term_forecast', top_k=5, train_epochs=20, use_amp=False, use_gpu=False, use_multi_gpu=False, w_lin=0.01)
Use CPU
>>>>>>>start training : long_term_forecast_DiscoveryPassage_and_others_720_360_96_tn_DLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
Chlorophyll (ug/l) Chlorophyll (ug/l)
train 33059
Chlorophyll (ug/l) Chlorophyll (ug/l)
val 4485
Chlorophyll (ug/l) Chlorophyll (ug/l)
test 9302
Parameters: 0.226464
	iters: 100, epoch: 1 | loss: 0.4145130
	speed: 0.0103s/iter; left time: 210.8660s
	iters: 200, epoch: 1 | loss: 0.3491964
	speed: 0.0079s/iter; left time: 162.2468s
	iters: 300, epoch: 1 | loss: 0.3415484
	speed: 0.0076s/iter; left time: 155.0049s
	iters: 400, epoch: 1 | loss: 0.2876318
	speed: 0.0077s/iter; left time: 155.7398s
	iters: 500, epoch: 1 | loss: 0.3858539
	speed: 0.0077s/iter; left time: 156.2438s
	iters: 600, epoch: 1 | loss: 0.4850763
	speed: 0.0076s/iter; left time: 151.9977s
	iters: 700, epoch: 1 | loss: 0.3431110
	speed: 0.0074s/iter; left time: 147.7927s
	iters: 800, epoch: 1 | loss: 0.5366706
	speed: 0.0076s/iter; left time: 151.5883s
	iters: 900, epoch: 1 | loss: 0.3588418
	speed: 0.0074s/iter; left time: 146.1882s
	iters: 1000, epoch: 1 | loss: 0.3677703
	speed: 0.0075s/iter; left time: 147.5618s
Epoch: 1 cost time: 8.116344690322876
Epoch: 1, Steps: 1033 | Train Loss: 0.3924597 Vali Loss: 0.4010167 Test Loss: 2.1587453
Validation loss decreased (inf --> 0.401017).  Saving model ...
Updating learning rate to 0.0001
Parameters: 0.226464
	iters: 100, epoch: 2 | loss: 0.4077165
	speed: 0.1142s/iter; left time: 2229.8019s
	iters: 200, epoch: 2 | loss: 0.3140421
	speed: 0.0069s/iter; left time: 134.1081s
	iters: 300, epoch: 2 | loss: 0.2918937
	speed: 0.0072s/iter; left time: 139.2173s
	iters: 400, epoch: 2 | loss: 0.3768626
	speed: 0.0071s/iter; left time: 135.8735s
	iters: 500, epoch: 2 | loss: 0.2434720
	speed: 0.0074s/iter; left time: 140.8105s
	iters: 600, epoch: 2 | loss: 0.3442364
	speed: 0.0074s/iter; left time: 141.3813s
	iters: 700, epoch: 2 | loss: 0.4679024
	speed: 0.0074s/iter; left time: 140.4181s
	iters: 800, epoch: 2 | loss: 0.3235652
	speed: 0.0074s/iter; left time: 140.0959s
	iters: 900, epoch: 2 | loss: 0.3258086
	speed: 0.0077s/iter; left time: 143.9489s
	iters: 1000, epoch: 2 | loss: 0.3910469
	speed: 0.0077s/iter; left time: 143.0333s
Epoch: 2 cost time: 7.73293924331665
Epoch: 2, Steps: 1033 | Train Loss: 0.3816469 Vali Loss: 0.3989540 Test Loss: 2.1566350
Validation loss decreased (0.401017 --> 0.398954).  Saving model ...
Updating learning rate to 5e-05
Parameters: 0.226464
	iters: 100, epoch: 3 | loss: 0.4626834
	speed: 0.1213s/iter; left time: 2242.8619s
	iters: 200, epoch: 3 | loss: 0.3750513
	speed: 0.0075s/iter; left time: 137.4592s
	iters: 300, epoch: 3 | loss: 0.4953365
	speed: 0.0073s/iter; left time: 133.6520s
	iters: 400, epoch: 3 | loss: 0.4959425
	speed: 0.0072s/iter; left time: 130.2911s
	iters: 500, epoch: 3 | loss: 0.4048317
	speed: 0.0070s/iter; left time: 126.9428s
	iters: 600, epoch: 3 | loss: 0.2053056
	speed: 0.0073s/iter; left time: 130.5566s
	iters: 700, epoch: 3 | loss: 0.2260427
	speed: 0.0074s/iter; left time: 132.5408s
	iters: 800, epoch: 3 | loss: 0.4892349
	speed: 0.0070s/iter; left time: 123.9185s
	iters: 900, epoch: 3 | loss: 0.4421346
	speed: 0.0080s/iter; left time: 141.1943s
	iters: 1000, epoch: 3 | loss: 0.3709259
	speed: 0.0077s/iter; left time: 135.1256s
Epoch: 3 cost time: 7.718198776245117
Epoch: 3, Steps: 1033 | Train Loss: 0.3799128 Vali Loss: 0.3974607 Test Loss: 2.1521506
Validation loss decreased (0.398954 --> 0.397461).  Saving model ...
Updating learning rate to 2.5e-05
Parameters: 0.226464
	iters: 100, epoch: 4 | loss: 0.2784373
	speed: 0.1162s/iter; left time: 2029.3358s
	iters: 200, epoch: 4 | loss: 0.4435440
	speed: 0.0073s/iter; left time: 127.1920s
	iters: 300, epoch: 4 | loss: 0.3959407
	speed: 0.0074s/iter; left time: 127.3928s
	iters: 400, epoch: 4 | loss: 0.4062978
	speed: 0.0074s/iter; left time: 127.4288s
	iters: 500, epoch: 4 | loss: 0.2722633
	speed: 0.0071s/iter; left time: 121.2121s
	iters: 600, epoch: 4 | loss: 0.3424454
	speed: 0.0070s/iter; left time: 117.9771s
	iters: 700, epoch: 4 | loss: 0.3904221
	speed: 0.0074s/iter; left time: 124.6953s
	iters: 800, epoch: 4 | loss: 0.1906662
	speed: 0.0073s/iter; left time: 121.5847s
	iters: 900, epoch: 4 | loss: 0.2728086
	speed: 0.0075s/iter; left time: 124.7073s
	iters: 1000, epoch: 4 | loss: 0.4323034
	speed: 0.0074s/iter; left time: 122.0946s
Epoch: 4 cost time: 7.651608228683472
Epoch: 4, Steps: 1033 | Train Loss: 0.3791652 Vali Loss: 0.3969633 Test Loss: 2.1484051
Validation loss decreased (0.397461 --> 0.396963).  Saving model ...
Updating learning rate to 1.25e-05
Parameters: 0.226464
	iters: 100, epoch: 5 | loss: 0.2689348
	speed: 0.1167s/iter; left time: 1917.0692s
	iters: 200, epoch: 5 | loss: 0.3135849
	speed: 0.0072s/iter; left time: 118.3027s
	iters: 300, epoch: 5 | loss: 0.4025857
	speed: 0.0077s/iter; left time: 125.5590s
	iters: 400, epoch: 5 | loss: 0.5745111
	speed: 0.0081s/iter; left time: 130.1771s
	iters: 500, epoch: 5 | loss: 0.6484935
	speed: 0.0078s/iter; left time: 124.7058s
	iters: 600, epoch: 5 | loss: 0.3800427
	speed: 0.0076s/iter; left time: 121.4712s
	iters: 700, epoch: 5 | loss: 0.3325159
	speed: 0.0079s/iter; left time: 125.5699s
	iters: 800, epoch: 5 | loss: 0.3553309
	speed: 0.0078s/iter; left time: 122.1087s
	iters: 900, epoch: 5 | loss: 0.3128251
	speed: 0.0077s/iter; left time: 120.1228s
	iters: 1000, epoch: 5 | loss: 0.5352752
	speed: 0.0079s/iter; left time: 122.7157s
Epoch: 5 cost time: 8.0670645236969
Epoch: 5, Steps: 1033 | Train Loss: 0.3788086 Vali Loss: 0.3965884 Test Loss: 2.1483963
Validation loss decreased (0.396963 --> 0.396588).  Saving model ...
Updating learning rate to 6.25e-06
Parameters: 0.226464
	iters: 100, epoch: 6 | loss: 0.2132460
	speed: 0.1247s/iter; left time: 1919.3075s
	iters: 200, epoch: 6 | loss: 0.4310459
	speed: 0.0079s/iter; left time: 121.1955s
	iters: 300, epoch: 6 | loss: 0.3020543
	speed: 0.0081s/iter; left time: 122.6810s
	iters: 400, epoch: 6 | loss: 0.4477505
	speed: 0.0085s/iter; left time: 127.6429s
	iters: 500, epoch: 6 | loss: 0.3973481
	speed: 0.0079s/iter; left time: 119.0100s
	iters: 600, epoch: 6 | loss: 0.4655203
	speed: 0.0084s/iter; left time: 124.9442s
	iters: 700, epoch: 6 | loss: 0.3752292
	speed: 0.0079s/iter; left time: 116.9030s
	iters: 800, epoch: 6 | loss: 0.3807321
	speed: 0.0080s/iter; left time: 117.5206s
	iters: 900, epoch: 6 | loss: 0.4181283
	speed: 0.0079s/iter; left time: 115.2564s
	iters: 1000, epoch: 6 | loss: 0.3645698
	speed: 0.0080s/iter; left time: 115.9911s
Epoch: 6 cost time: 8.514641284942627
Epoch: 6, Steps: 1033 | Train Loss: 0.3786061 Vali Loss: 0.3963600 Test Loss: 2.1462097
Validation loss decreased (0.396588 --> 0.396360).  Saving model ...
Updating learning rate to 3.125e-06
Parameters: 0.226464
	iters: 100, epoch: 7 | loss: 0.3410083
	speed: 0.1302s/iter; left time: 1869.9220s
	iters: 200, epoch: 7 | loss: 0.2727647
	speed: 0.0082s/iter; left time: 116.8712s
	iters: 300, epoch: 7 | loss: 0.4015916
	speed: 0.0077s/iter; left time: 109.0520s
	iters: 400, epoch: 7 | loss: 0.2808436
	speed: 0.0082s/iter; left time: 115.6643s
	iters: 500, epoch: 7 | loss: 0.5498519
	speed: 0.0083s/iter; left time: 115.4168s
	iters: 600, epoch: 7 | loss: 0.3855565
	speed: 0.0082s/iter; left time: 113.9459s
	iters: 700, epoch: 7 | loss: 0.3763858
	speed: 0.0082s/iter; left time: 112.5478s
	iters: 800, epoch: 7 | loss: 0.4874606
	speed: 0.0080s/iter; left time: 108.8019s
	iters: 900, epoch: 7 | loss: 0.3365359
	speed: 0.0081s/iter; left time: 109.1960s
	iters: 1000, epoch: 7 | loss: 0.2888795
	speed: 0.0083s/iter; left time: 111.0741s
Epoch: 7 cost time: 8.493326902389526
Epoch: 7, Steps: 1033 | Train Loss: 0.3785005 Vali Loss: 0.3964171 Test Loss: 2.1475718
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.5625e-06
Parameters: 0.226464
	iters: 100, epoch: 8 | loss: 0.4161956
	speed: 0.1285s/iter; left time: 1712.6029s
	iters: 200, epoch: 8 | loss: 0.3101159
	speed: 0.0083s/iter; left time: 109.4256s
	iters: 300, epoch: 8 | loss: 0.4286235
	speed: 0.0084s/iter; left time: 110.8559s
	iters: 400, epoch: 8 | loss: 0.3365508
	speed: 0.0088s/iter; left time: 114.7676s
	iters: 500, epoch: 8 | loss: 0.5255458
	speed: 0.0083s/iter; left time: 107.2641s
	iters: 600, epoch: 8 | loss: 0.3062257
	speed: 0.0077s/iter; left time: 98.9247s
	iters: 700, epoch: 8 | loss: 0.6127836
	speed: 0.0077s/iter; left time: 98.4926s
	iters: 800, epoch: 8 | loss: 0.4141093
	speed: 0.0081s/iter; left time: 102.1940s
	iters: 900, epoch: 8 | loss: 0.3152663
	speed: 0.0084s/iter; left time: 104.6692s
	iters: 1000, epoch: 8 | loss: 0.3078850
	speed: 0.0083s/iter; left time: 103.2445s
Epoch: 8 cost time: 8.626890182495117
Epoch: 8, Steps: 1033 | Train Loss: 0.3784562 Vali Loss: 0.3963924 Test Loss: 2.1467855
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.8125e-07
Parameters: 0.226464
	iters: 100, epoch: 9 | loss: 0.3470927
	speed: 0.1328s/iter; left time: 1632.7987s
	iters: 200, epoch: 9 | loss: 0.3330209
	speed: 0.0083s/iter; left time: 101.1026s
	iters: 300, epoch: 9 | loss: 0.3273253
	speed: 0.0081s/iter; left time: 97.6806s
	iters: 400, epoch: 9 | loss: 0.3973504
	speed: 0.0079s/iter; left time: 94.8809s
	iters: 500, epoch: 9 | loss: 0.3170443
	speed: 0.0078s/iter; left time: 93.1067s
	iters: 600, epoch: 9 | loss: 0.3814158
	speed: 0.0079s/iter; left time: 93.5923s
	iters: 700, epoch: 9 | loss: 0.5524331
	speed: 0.0079s/iter; left time: 92.5806s
	iters: 800, epoch: 9 | loss: 0.4096666
	speed: 0.0082s/iter; left time: 95.1180s
	iters: 900, epoch: 9 | loss: 0.4608020
	speed: 0.0081s/iter; left time: 92.7148s
	iters: 1000, epoch: 9 | loss: 0.4411080
	speed: 0.0081s/iter; left time: 91.8537s
Epoch: 9 cost time: 8.446510314941406
Epoch: 9, Steps: 1033 | Train Loss: 0.3784092 Vali Loss: 0.3963288 Test Loss: 2.1455719
Validation loss decreased (0.396360 --> 0.396329).  Saving model ...
Updating learning rate to 3.90625e-07
Parameters: 0.226464
	iters: 100, epoch: 10 | loss: 0.2939560
	speed: 0.1354s/iter; left time: 1525.2373s
	iters: 200, epoch: 10 | loss: 0.5199835
	speed: 0.0088s/iter; left time: 98.2756s
	iters: 300, epoch: 10 | loss: 0.4868482
	speed: 0.0085s/iter; left time: 94.2908s
	iters: 400, epoch: 10 | loss: 0.3499665
	speed: 0.0086s/iter; left time: 94.6392s
	iters: 500, epoch: 10 | loss: 0.2155909
	speed: 0.0083s/iter; left time: 90.5121s
	iters: 600, epoch: 10 | loss: 0.3243443
	speed: 0.0082s/iter; left time: 88.6017s
	iters: 700, epoch: 10 | loss: 0.5327542
	speed: 0.0083s/iter; left time: 88.5081s
	iters: 800, epoch: 10 | loss: 0.3827576
	speed: 0.0086s/iter; left time: 91.3281s
	iters: 900, epoch: 10 | loss: 0.4087309
	speed: 0.0086s/iter; left time: 89.4879s
	iters: 1000, epoch: 10 | loss: 0.2994809
	speed: 0.0086s/iter; left time: 89.3797s
Epoch: 10 cost time: 8.877402782440186
Epoch: 10, Steps: 1033 | Train Loss: 0.3784367 Vali Loss: 0.3964401 Test Loss: 2.1455998
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.953125e-07
Parameters: 0.226464
	iters: 100, epoch: 11 | loss: 0.3524637
	speed: 0.1332s/iter; left time: 1362.4509s
	iters: 200, epoch: 11 | loss: 0.4408345
	speed: 0.0078s/iter; left time: 78.5415s
	iters: 300, epoch: 11 | loss: 0.2852198
	speed: 0.0081s/iter; left time: 80.7563s
	iters: 400, epoch: 11 | loss: 0.5647961
	speed: 0.0077s/iter; left time: 76.0634s
	iters: 500, epoch: 11 | loss: 0.3307712
	speed: 0.0080s/iter; left time: 78.7354s
	iters: 600, epoch: 11 | loss: 0.3798957
	speed: 0.0080s/iter; left time: 77.8023s
	iters: 700, epoch: 11 | loss: 0.4592429
	speed: 0.0081s/iter; left time: 78.0207s
	iters: 800, epoch: 11 | loss: 0.3441022
	speed: 0.0086s/iter; left time: 81.9576s
	iters: 900, epoch: 11 | loss: 0.3243873
	speed: 0.0086s/iter; left time: 80.7245s
	iters: 1000, epoch: 11 | loss: 0.2252051
	speed: 0.0077s/iter; left time: 72.0252s
Epoch: 11 cost time: 8.511077165603638
Epoch: 11, Steps: 1033 | Train Loss: 0.3783528 Vali Loss: 0.3963042 Test Loss: 2.1456659
Validation loss decreased (0.396329 --> 0.396304).  Saving model ...
Updating learning rate to 9.765625e-08
Parameters: 0.226464
	iters: 100, epoch: 12 | loss: 0.1988937
	speed: 0.1331s/iter; left time: 1224.1601s
	iters: 200, epoch: 12 | loss: 0.2276085
	speed: 0.0083s/iter; left time: 75.4915s
	iters: 300, epoch: 12 | loss: 0.3503516
	speed: 0.0082s/iter; left time: 73.6992s
	iters: 400, epoch: 12 | loss: 0.2060733
	speed: 0.0083s/iter; left time: 73.8640s
	iters: 500, epoch: 12 | loss: 0.3025694
	speed: 0.0084s/iter; left time: 73.7064s
	iters: 600, epoch: 12 | loss: 0.3215964
	speed: 0.0082s/iter; left time: 71.6614s
	iters: 700, epoch: 12 | loss: 0.2234061
	speed: 0.0079s/iter; left time: 68.1886s
	iters: 800, epoch: 12 | loss: 0.4283899
	speed: 0.0084s/iter; left time: 71.6642s
	iters: 900, epoch: 12 | loss: 0.4155545
	speed: 0.0085s/iter; left time: 71.1923s
	iters: 1000, epoch: 12 | loss: 0.3965590
	speed: 0.0086s/iter; left time: 71.1861s
Epoch: 12 cost time: 8.67093801498413
Epoch: 12, Steps: 1033 | Train Loss: 0.3784310 Vali Loss: 0.3964592 Test Loss: 2.1457136
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.8828125e-08
Parameters: 0.226464
	iters: 100, epoch: 13 | loss: 0.2175377
	speed: 0.1343s/iter; left time: 1096.4732s
	iters: 200, epoch: 13 | loss: 0.2731284
	speed: 0.0081s/iter; left time: 65.4945s
	iters: 300, epoch: 13 | loss: 0.3182753
	speed: 0.0082s/iter; left time: 65.6802s
	iters: 400, epoch: 13 | loss: 0.5024845
	speed: 0.0084s/iter; left time: 65.9786s
	iters: 500, epoch: 13 | loss: 0.5154763
	speed: 0.0085s/iter; left time: 66.1721s
	iters: 600, epoch: 13 | loss: 0.3987798
	speed: 0.0084s/iter; left time: 64.4878s
	iters: 700, epoch: 13 | loss: 0.4536973
	speed: 0.0081s/iter; left time: 61.2891s
	iters: 800, epoch: 13 | loss: 0.3979724
	speed: 0.0085s/iter; left time: 63.4121s
	iters: 900, epoch: 13 | loss: 0.3883393
	speed: 0.0085s/iter; left time: 62.4505s
	iters: 1000, epoch: 13 | loss: 0.2596678
	speed: 0.0080s/iter; left time: 57.8632s
Epoch: 13 cost time: 8.662482023239136
Epoch: 13, Steps: 1033 | Train Loss: 0.3784148 Vali Loss: 0.3962575 Test Loss: 2.1457250
Validation loss decreased (0.396304 --> 0.396258).  Saving model ...
Updating learning rate to 2.44140625e-08
Parameters: 0.226464
	iters: 100, epoch: 14 | loss: 0.3642760
	speed: 0.1343s/iter; left time: 957.7005s
	iters: 200, epoch: 14 | loss: 0.4161315
	speed: 0.0080s/iter; left time: 55.9473s
	iters: 300, epoch: 14 | loss: 0.3164899
	speed: 0.0080s/iter; left time: 55.6772s
	iters: 400, epoch: 14 | loss: 0.3519699
	speed: 0.0083s/iter; left time: 56.4803s
	iters: 500, epoch: 14 | loss: 0.3746909
	speed: 0.0080s/iter; left time: 53.7489s
	iters: 600, epoch: 14 | loss: 0.2542537
	speed: 0.0085s/iter; left time: 56.0897s
	iters: 700, epoch: 14 | loss: 0.6161586
	speed: 0.0086s/iter; left time: 55.9132s
	iters: 800, epoch: 14 | loss: 0.2511621
	speed: 0.0084s/iter; left time: 53.8620s
	iters: 900, epoch: 14 | loss: 0.3685452
	speed: 0.0082s/iter; left time: 52.0878s
	iters: 1000, epoch: 14 | loss: 0.4079140
	speed: 0.0076s/iter; left time: 47.6030s
Epoch: 14 cost time: 8.512363195419312
Epoch: 14, Steps: 1033 | Train Loss: 0.3783970 Vali Loss: 0.3964777 Test Loss: 2.1457264
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.220703125e-08
Parameters: 0.226464
	iters: 100, epoch: 15 | loss: 0.3232672
	speed: 0.1304s/iter; left time: 795.0316s
	iters: 200, epoch: 15 | loss: 0.4169534
	speed: 0.0080s/iter; left time: 47.9297s
	iters: 300, epoch: 15 | loss: 0.3725626
	speed: 0.0082s/iter; left time: 48.6178s
	iters: 400, epoch: 15 | loss: 0.2213120
	speed: 0.0077s/iter; left time: 44.9146s
	iters: 500, epoch: 15 | loss: 0.3317117
	speed: 0.0082s/iter; left time: 46.8998s
	iters: 600, epoch: 15 | loss: 0.3438629
	speed: 0.0083s/iter; left time: 46.6592s
	iters: 700, epoch: 15 | loss: 0.4321355
	speed: 0.0086s/iter; left time: 47.1497s
	iters: 800, epoch: 15 | loss: 0.3993803
	speed: 0.0085s/iter; left time: 45.6582s
	iters: 900, epoch: 15 | loss: 0.3683804
	speed: 0.0086s/iter; left time: 45.7757s
	iters: 1000, epoch: 15 | loss: 0.4057058
	speed: 0.0088s/iter; left time: 45.9564s
Epoch: 15 cost time: 8.67725396156311
Epoch: 15, Steps: 1033 | Train Loss: 0.3784054 Vali Loss: 0.3964716 Test Loss: 2.1457300
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.103515625e-09
Parameters: 0.226464
	iters: 100, epoch: 16 | loss: 0.5218187
	speed: 0.1282s/iter; left time: 649.2478s
	iters: 200, epoch: 16 | loss: 0.4190017
	speed: 0.0080s/iter; left time: 39.8232s
	iters: 300, epoch: 16 | loss: 0.4013572
	speed: 0.0081s/iter; left time: 39.2002s
	iters: 400, epoch: 16 | loss: 0.4069533
	speed: 0.0084s/iter; left time: 40.1903s
	iters: 500, epoch: 16 | loss: 0.5113295
	speed: 0.0076s/iter; left time: 35.5852s
	iters: 600, epoch: 16 | loss: 0.2630815
	speed: 0.0077s/iter; left time: 35.1541s
	iters: 700, epoch: 16 | loss: 0.4430510
	speed: 0.0075s/iter; left time: 33.5012s
	iters: 800, epoch: 16 | loss: 0.3730834
	speed: 0.0078s/iter; left time: 34.1127s
	iters: 900, epoch: 16 | loss: 0.3383588
	speed: 0.0079s/iter; left time: 33.7036s
	iters: 1000, epoch: 16 | loss: 0.4066950
	speed: 0.0081s/iter; left time: 33.6521s
Epoch: 16 cost time: 8.309985876083374
Epoch: 16, Steps: 1033 | Train Loss: 0.3784103 Vali Loss: 0.3963866 Test Loss: 2.1457312
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.0517578125e-09
Parameters: 0.226464
	iters: 100, epoch: 17 | loss: 0.4613183
	speed: 0.1269s/iter; left time: 511.9606s
	iters: 200, epoch: 17 | loss: 0.4432000
	speed: 0.0082s/iter; left time: 32.1058s
	iters: 300, epoch: 17 | loss: 0.4218962
	speed: 0.0082s/iter; left time: 31.3377s
	iters: 400, epoch: 17 | loss: 0.3366444
	speed: 0.0080s/iter; left time: 29.7111s
	iters: 500, epoch: 17 | loss: 0.2321510
	speed: 0.0082s/iter; left time: 29.6501s
	iters: 600, epoch: 17 | loss: 0.3624472
	speed: 0.0078s/iter; left time: 27.5818s
	iters: 700, epoch: 17 | loss: 0.2834376
	speed: 0.0081s/iter; left time: 27.7940s
	iters: 800, epoch: 17 | loss: 0.4592705
	speed: 0.0083s/iter; left time: 27.6258s
	iters: 900, epoch: 17 | loss: 0.3491273
	speed: 0.0083s/iter; left time: 26.7500s
	iters: 1000, epoch: 17 | loss: 0.2554915
	speed: 0.0078s/iter; left time: 24.3554s
Epoch: 17 cost time: 8.437774658203125
Epoch: 17, Steps: 1033 | Train Loss: 0.3784292 Vali Loss: 0.3961525 Test Loss: 2.1457324
Validation loss decreased (0.396258 --> 0.396152).  Saving model ...
Updating learning rate to 1.52587890625e-09
Parameters: 0.226464
	iters: 100, epoch: 18 | loss: 0.4388239
	speed: 0.1330s/iter; left time: 398.8564s
	iters: 200, epoch: 18 | loss: 0.3611581
	speed: 0.0081s/iter; left time: 23.4708s
	iters: 300, epoch: 18 | loss: 0.3331015
	speed: 0.0082s/iter; left time: 23.0013s
	iters: 400, epoch: 18 | loss: 0.4812807
	speed: 0.0080s/iter; left time: 21.6383s
	iters: 500, epoch: 18 | loss: 0.2866158
	speed: 0.0081s/iter; left time: 20.9495s
	iters: 600, epoch: 18 | loss: 0.4612158
	speed: 0.0081s/iter; left time: 20.3106s
	iters: 700, epoch: 18 | loss: 0.3496238
	speed: 0.0080s/iter; left time: 19.1242s
	iters: 800, epoch: 18 | loss: 0.4346696
	speed: 0.0083s/iter; left time: 18.9954s
	iters: 900, epoch: 18 | loss: 0.3849409
	speed: 0.0086s/iter; left time: 18.8384s
	iters: 1000, epoch: 18 | loss: 0.2765937
	speed: 0.0076s/iter; left time: 15.8648s
Epoch: 18 cost time: 8.451526880264282
Epoch: 18, Steps: 1033 | Train Loss: 0.3784206 Vali Loss: 0.3965559 Test Loss: 2.1457331
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.62939453125e-10
Parameters: 0.226464
	iters: 100, epoch: 19 | loss: 0.3340126
	speed: 0.1281s/iter; left time: 251.9736s
	iters: 200, epoch: 19 | loss: 0.3217508
	speed: 0.0087s/iter; left time: 16.2672s
	iters: 300, epoch: 19 | loss: 0.2940872
	speed: 0.0085s/iter; left time: 15.0273s
	iters: 400, epoch: 19 | loss: 0.2512266
	speed: 0.0084s/iter; left time: 13.9662s
	iters: 500, epoch: 19 | loss: 0.3819272
	speed: 0.0080s/iter; left time: 12.4908s
	iters: 600, epoch: 19 | loss: 0.2629415
	speed: 0.0079s/iter; left time: 11.6262s
	iters: 700, epoch: 19 | loss: 0.6636699
	speed: 0.0079s/iter; left time: 10.8327s
	iters: 800, epoch: 19 | loss: 0.3370467
	speed: 0.0082s/iter; left time: 10.3470s
	iters: 900, epoch: 19 | loss: 0.4310494
	speed: 0.0083s/iter; left time: 9.7236s
	iters: 1000, epoch: 19 | loss: 0.3627576
	speed: 0.0082s/iter; left time: 8.7992s
Epoch: 19 cost time: 8.577481031417847
Epoch: 19, Steps: 1033 | Train Loss: 0.3783931 Vali Loss: 0.3963901 Test Loss: 2.1457331
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.814697265625e-10
Parameters: 0.226464
	iters: 100, epoch: 20 | loss: 0.2549862
	speed: 0.1302s/iter; left time: 121.5869s
	iters: 200, epoch: 20 | loss: 0.2807748
	speed: 0.0081s/iter; left time: 6.7602s
	iters: 300, epoch: 20 | loss: 0.3671351
	speed: 0.0079s/iter; left time: 5.8216s
	iters: 400, epoch: 20 | loss: 0.4468411
	speed: 0.0077s/iter; left time: 4.8986s
	iters: 500, epoch: 20 | loss: 0.3609712
	speed: 0.0082s/iter; left time: 4.3733s
	iters: 600, epoch: 20 | loss: 0.2443332
	speed: 0.0077s/iter; left time: 3.3468s
	iters: 700, epoch: 20 | loss: 0.4595811
	speed: 0.0077s/iter; left time: 2.5633s
	iters: 800, epoch: 20 | loss: 0.4051348
	speed: 0.0082s/iter; left time: 1.9126s
	iters: 900, epoch: 20 | loss: 0.5616714
	speed: 0.0080s/iter; left time: 1.0670s
	iters: 1000, epoch: 20 | loss: 0.4345829
	speed: 0.0080s/iter; left time: 0.2711s
Epoch: 20 cost time: 8.329456567764282
Epoch: 20, Steps: 1033 | Train Loss: 0.3784156 Vali Loss: 0.3964213 Test Loss: 2.1457331
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.9073486328125e-10
>>>>>>>testing : long_term_forecast_DiscoveryPassage_and_others_720_360_96_tn_DLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Chlorophyll (ug/l) Chlorophyll (ug/l)
test 9302
test shape: (9302, 1, 336, 8) (9302, 1, 336, 8)
test shape: (9302, 336, 8) (9302, 336, 8)
mse:2.145732879638672, mae:0.627136766910553


bash ./scripts/DiscoveryPassage_and_others_Script/DLinear.sh
MODEL IMPLEMENTED= DLinear
PREDICTION LENGTH= 192
SEQUENCE LENGTH= 192
LEARNING RATE ADJUSTMENT= type1
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=8, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='DiscoveryPassage_and_others_merged.csv', dec_in=8, des='Exp', devices='0,1,2,3', distil=True, dropout=0.1, e_layers=2, embed='timeF', enc_in=8, factor=3, features='M', freq='h', gpu=0, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='DLinear', model_id='DiscoveryPassage_and_others_720_360_96_tn', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=192, root_path='./dataset/', seasonal_patterns='Monthly', seq_len=192, target='Chlorophyll (ug/l)', task_name='long_term_forecast', top_k=5, train_epochs=20, use_amp=False, use_gpu=False, use_multi_gpu=False, w_lin=0.01)
Use CPU
>>>>>>>start training : long_term_forecast_DiscoveryPassage_and_others_720_360_96_tn_DLinear_custom_ftM_sl192_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
Chlorophyll (ug/l) Chlorophyll (ug/l)
train 33347
Chlorophyll (ug/l) Chlorophyll (ug/l)
val 4629
Chlorophyll (ug/l) Chlorophyll (ug/l)
test 9446
Parameters: 0.074112
	iters: 100, epoch: 1 | loss: 0.4005627
	speed: 0.0072s/iter; left time: 149.7307s
	iters: 200, epoch: 1 | loss: 0.4190607
	speed: 0.0048s/iter; left time: 99.4690s
	iters: 300, epoch: 1 | loss: 0.7100559
	speed: 0.0047s/iter; left time: 95.6220s
	iters: 400, epoch: 1 | loss: 0.4134229
	speed: 0.0046s/iter; left time: 94.4506s
	iters: 500, epoch: 1 | loss: 0.3206118
	speed: 0.0047s/iter; left time: 95.4513s
	iters: 600, epoch: 1 | loss: 0.4071526
	speed: 0.0046s/iter; left time: 93.2539s
	iters: 700, epoch: 1 | loss: 0.3153574
	speed: 0.0047s/iter; left time: 95.0941s
	iters: 800, epoch: 1 | loss: 0.2788278
	speed: 0.0046s/iter; left time: 92.6318s
	iters: 900, epoch: 1 | loss: 0.3970631
	speed: 0.0046s/iter; left time: 92.1662s
	iters: 1000, epoch: 1 | loss: 0.5441267
	speed: 0.0047s/iter; left time: 93.2980s
Epoch: 1 cost time: 5.146284580230713
Epoch: 1, Steps: 1042 | Train Loss: 0.3829765 Vali Loss: 0.3474702 Test Loss: 1.9219524
Validation loss decreased (inf --> 0.347470).  Saving model ...
Updating learning rate to 0.0001
Parameters: 0.074112
	iters: 100, epoch: 2 | loss: 0.4120806
	speed: 0.0981s/iter; left time: 1931.8891s
	iters: 200, epoch: 2 | loss: 0.3234826
	speed: 0.0046s/iter; left time: 89.6211s
	iters: 300, epoch: 2 | loss: 0.3186304
	speed: 0.0046s/iter; left time: 88.7990s
	iters: 400, epoch: 2 | loss: 0.4082022
	speed: 0.0044s/iter; left time: 84.4831s
	iters: 500, epoch: 2 | loss: 0.3363360
	speed: 0.0043s/iter; left time: 82.2133s
	iters: 600, epoch: 2 | loss: 0.2808948
	speed: 0.0044s/iter; left time: 83.7369s
	iters: 700, epoch: 2 | loss: 0.3022520
	speed: 0.0045s/iter; left time: 86.5194s
	iters: 800, epoch: 2 | loss: 0.4405057
	speed: 0.0046s/iter; left time: 87.9073s
	iters: 900, epoch: 2 | loss: 0.3546027
	speed: 0.0044s/iter; left time: 83.7084s
	iters: 1000, epoch: 2 | loss: 0.2145734
	speed: 0.0046s/iter; left time: 85.8213s
Epoch: 2 cost time: 4.7662904262542725
Epoch: 2, Steps: 1042 | Train Loss: 0.3676378 Vali Loss: 0.3401463 Test Loss: 1.9116933
Validation loss decreased (0.347470 --> 0.340146).  Saving model ...
Updating learning rate to 5e-05
Parameters: 0.074112
	iters: 100, epoch: 3 | loss: 0.2795702
	speed: 0.1080s/iter; left time: 2015.2646s
	iters: 200, epoch: 3 | loss: 0.4371555
	speed: 0.0047s/iter; left time: 86.6788s
	iters: 300, epoch: 3 | loss: 0.4771476
	speed: 0.0047s/iter; left time: 86.0726s
	iters: 400, epoch: 3 | loss: 0.2425202
	speed: 0.0047s/iter; left time: 85.9639s
	iters: 500, epoch: 3 | loss: 0.3932502
	speed: 0.0047s/iter; left time: 85.5983s
	iters: 600, epoch: 3 | loss: 0.3124652
	speed: 0.0048s/iter; left time: 86.6351s
	iters: 700, epoch: 3 | loss: 0.3477511
	speed: 0.0046s/iter; left time: 82.3617s
	iters: 800, epoch: 3 | loss: 0.2590599
	speed: 0.0048s/iter; left time: 86.0432s
	iters: 900, epoch: 3 | loss: 0.2682733
	speed: 0.0046s/iter; left time: 82.8308s
	iters: 1000, epoch: 3 | loss: 0.3155265
	speed: 0.0046s/iter; left time: 82.2111s
Epoch: 3 cost time: 4.980254173278809
Epoch: 3, Steps: 1042 | Train Loss: 0.3661542 Vali Loss: 0.3383099 Test Loss: 1.9230025
Validation loss decreased (0.340146 --> 0.338310).  Saving model ...
Updating learning rate to 2.5e-05
Parameters: 0.074112
	iters: 100, epoch: 4 | loss: 0.3671115
	speed: 0.0988s/iter; left time: 1740.4395s
	iters: 200, epoch: 4 | loss: 0.3504958
	speed: 0.0046s/iter; left time: 80.1512s
	iters: 300, epoch: 4 | loss: 0.3412642
	speed: 0.0046s/iter; left time: 79.7713s
	iters: 400, epoch: 4 | loss: 0.2831599
	speed: 0.0046s/iter; left time: 79.8695s
	iters: 500, epoch: 4 | loss: 0.2961048
	speed: 0.0045s/iter; left time: 77.7637s
	iters: 600, epoch: 4 | loss: 0.3380983
	speed: 0.0046s/iter; left time: 78.6791s
	iters: 700, epoch: 4 | loss: 0.5944676
	speed: 0.0046s/iter; left time: 77.6094s
	iters: 800, epoch: 4 | loss: 0.1962653
	speed: 0.0047s/iter; left time: 80.1497s
	iters: 900, epoch: 4 | loss: 0.3579430
	speed: 0.0047s/iter; left time: 78.5093s
	iters: 1000, epoch: 4 | loss: 0.3160677
	speed: 0.0046s/iter; left time: 76.5181s
Epoch: 4 cost time: 4.881329536437988
Epoch: 4, Steps: 1042 | Train Loss: 0.3655100 Vali Loss: 0.3380842 Test Loss: 1.9139974
Validation loss decreased (0.338310 --> 0.338084).  Saving model ...
Updating learning rate to 1.25e-05
Parameters: 0.074112
	iters: 100, epoch: 5 | loss: 0.3472869
	speed: 0.1085s/iter; left time: 1797.4033s
	iters: 200, epoch: 5 | loss: 0.2681520
	speed: 0.0046s/iter; left time: 75.4074s
	iters: 300, epoch: 5 | loss: 0.3462853
	speed: 0.0046s/iter; left time: 74.7955s
	iters: 400, epoch: 5 | loss: 0.4782127
	speed: 0.0045s/iter; left time: 72.7913s
	iters: 500, epoch: 5 | loss: 0.3036749
	speed: 0.0044s/iter; left time: 70.6648s
	iters: 600, epoch: 5 | loss: 0.4728583
	speed: 0.0046s/iter; left time: 73.9052s
	iters: 700, epoch: 5 | loss: 0.2282133
	speed: 0.0045s/iter; left time: 71.8897s
	iters: 800, epoch: 5 | loss: 0.2147811
	speed: 0.0047s/iter; left time: 74.0835s
	iters: 900, epoch: 5 | loss: 0.2227527
	speed: 0.0046s/iter; left time: 72.3437s
	iters: 1000, epoch: 5 | loss: 0.3332877
	speed: 0.0046s/iter; left time: 72.4152s
Epoch: 5 cost time: 4.835127353668213
Epoch: 5, Steps: 1042 | Train Loss: 0.3653711 Vali Loss: 0.3376084 Test Loss: 1.9137883
Validation loss decreased (0.338084 --> 0.337608).  Saving model ...
Updating learning rate to 6.25e-06
Parameters: 0.074112
	iters: 100, epoch: 6 | loss: 0.3957473
	speed: 0.1055s/iter; left time: 1637.9924s
	iters: 200, epoch: 6 | loss: 0.3226553
	speed: 0.0046s/iter; left time: 71.2897s
	iters: 300, epoch: 6 | loss: 0.3903427
	speed: 0.0045s/iter; left time: 69.1158s
	iters: 400, epoch: 6 | loss: 0.4980322
	speed: 0.0046s/iter; left time: 70.2707s
	iters: 500, epoch: 6 | loss: 0.4688142
	speed: 0.0046s/iter; left time: 69.8084s
	iters: 600, epoch: 6 | loss: 0.3073299
	speed: 0.0045s/iter; left time: 67.2385s
	iters: 700, epoch: 6 | loss: 0.3421653
	speed: 0.0046s/iter; left time: 68.0085s
	iters: 800, epoch: 6 | loss: 0.3890533
	speed: 0.0045s/iter; left time: 66.2788s
	iters: 900, epoch: 6 | loss: 0.2211593
	speed: 0.0045s/iter; left time: 65.8193s
	iters: 1000, epoch: 6 | loss: 0.4307293
	speed: 0.0048s/iter; left time: 70.2985s
Epoch: 6 cost time: 4.874234437942505
Epoch: 6, Steps: 1042 | Train Loss: 0.3652045 Vali Loss: 0.3378000 Test Loss: 1.9113586
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.125e-06
Parameters: 0.074112
	iters: 100, epoch: 7 | loss: 0.4709351
	speed: 0.0967s/iter; left time: 1401.5774s
	iters: 200, epoch: 7 | loss: 0.3661756
	speed: 0.0046s/iter; left time: 66.1502s
	iters: 300, epoch: 7 | loss: 0.5456588
	speed: 0.0044s/iter; left time: 62.5743s
	iters: 400, epoch: 7 | loss: 0.3547387
	speed: 0.0048s/iter; left time: 67.6617s
	iters: 500, epoch: 7 | loss: 0.3725077
	speed: 0.0049s/iter; left time: 68.6675s
	iters: 600, epoch: 7 | loss: 0.3019837
	speed: 0.0046s/iter; left time: 64.9756s
	iters: 700, epoch: 7 | loss: 0.3922413
	speed: 0.0045s/iter; left time: 62.5596s
	iters: 800, epoch: 7 | loss: 0.7039394
	speed: 0.0046s/iter; left time: 63.0033s
	iters: 900, epoch: 7 | loss: 0.2825855
	speed: 0.0048s/iter; left time: 65.5766s
	iters: 1000, epoch: 7 | loss: 0.4972027
	speed: 0.0046s/iter; left time: 63.1195s
Epoch: 7 cost time: 4.954698085784912
Epoch: 7, Steps: 1042 | Train Loss: 0.3651519 Vali Loss: 0.3373995 Test Loss: 1.9112412
Validation loss decreased (0.337608 --> 0.337400).  Saving model ...
Updating learning rate to 1.5625e-06
Parameters: 0.074112
	iters: 100, epoch: 8 | loss: 0.3126823
	speed: 0.0998s/iter; left time: 1341.8113s
	iters: 200, epoch: 8 | loss: 0.3228055
	speed: 0.0048s/iter; left time: 63.7995s
	iters: 300, epoch: 8 | loss: 0.2385813
	speed: 0.0048s/iter; left time: 64.0939s
	iters: 400, epoch: 8 | loss: 0.3971643
	speed: 0.0046s/iter; left time: 60.1108s
	iters: 500, epoch: 8 | loss: 0.3529951
	speed: 0.0047s/iter; left time: 61.5138s
	iters: 600, epoch: 8 | loss: 0.4799360
	speed: 0.0047s/iter; left time: 61.3583s
	iters: 700, epoch: 8 | loss: 0.4894412
	speed: 0.0048s/iter; left time: 62.2411s
	iters: 800, epoch: 8 | loss: 0.3953493
	speed: 0.0046s/iter; left time: 58.1741s
	iters: 900, epoch: 8 | loss: 0.5275404
	speed: 0.0045s/iter; left time: 56.3936s
	iters: 1000, epoch: 8 | loss: 0.2705638
	speed: 0.0045s/iter; left time: 55.8780s
Epoch: 8 cost time: 4.980116605758667
Epoch: 8, Steps: 1042 | Train Loss: 0.3650286 Vali Loss: 0.3371709 Test Loss: 1.9135574
Validation loss decreased (0.337400 --> 0.337171).  Saving model ...
Updating learning rate to 7.8125e-07
Parameters: 0.074112
	iters: 100, epoch: 9 | loss: 0.4632865
	speed: 0.1022s/iter; left time: 1268.3852s
	iters: 200, epoch: 9 | loss: 0.3527441
	speed: 0.0045s/iter; left time: 55.8452s
	iters: 300, epoch: 9 | loss: 0.3398510
	speed: 0.0047s/iter; left time: 57.0828s
	iters: 400, epoch: 9 | loss: 0.3698618
	speed: 0.0050s/iter; left time: 60.0747s
	iters: 500, epoch: 9 | loss: 0.2886834
	speed: 0.0047s/iter; left time: 56.6037s
	iters: 600, epoch: 9 | loss: 0.3736145
	speed: 0.0046s/iter; left time: 55.1113s
	iters: 700, epoch: 9 | loss: 0.2317916
	speed: 0.0046s/iter; left time: 54.1858s
	iters: 800, epoch: 9 | loss: 0.6237341
	speed: 0.0048s/iter; left time: 56.0247s
	iters: 900, epoch: 9 | loss: 0.4093197
	speed: 0.0045s/iter; left time: 52.4406s
	iters: 1000, epoch: 9 | loss: 0.4845771
	speed: 0.0046s/iter; left time: 52.3973s
Epoch: 9 cost time: 4.9413230419158936
Epoch: 9, Steps: 1042 | Train Loss: 0.3650924 Vali Loss: 0.3371799 Test Loss: 1.9122943
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.90625e-07
Parameters: 0.074112
	iters: 100, epoch: 10 | loss: 0.3128461
	speed: 0.1056s/iter; left time: 1200.0037s
	iters: 200, epoch: 10 | loss: 0.3449694
	speed: 0.0046s/iter; left time: 51.5021s
	iters: 300, epoch: 10 | loss: 0.2765065
	speed: 0.0045s/iter; left time: 50.3742s
	iters: 400, epoch: 10 | loss: 0.3955059
	speed: 0.0048s/iter; left time: 53.1571s
	iters: 500, epoch: 10 | loss: 0.2130467
	speed: 0.0047s/iter; left time: 51.5259s
	iters: 600, epoch: 10 | loss: 0.3245123
	speed: 0.0045s/iter; left time: 49.2838s
	iters: 700, epoch: 10 | loss: 0.3454722
	speed: 0.0048s/iter; left time: 51.6877s
	iters: 800, epoch: 10 | loss: 0.4065344
	speed: 0.0047s/iter; left time: 50.1403s
	iters: 900, epoch: 10 | loss: 0.3013891
	speed: 0.0046s/iter; left time: 48.2198s
	iters: 1000, epoch: 10 | loss: 0.5252035
	speed: 0.0047s/iter; left time: 48.8771s
Epoch: 10 cost time: 4.943715333938599
Epoch: 10, Steps: 1042 | Train Loss: 0.3650754 Vali Loss: 0.3377382 Test Loss: 1.9123683
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.953125e-07
Parameters: 0.074112
	iters: 100, epoch: 11 | loss: 0.4687975
	speed: 0.0999s/iter; left time: 1031.2065s
	iters: 200, epoch: 11 | loss: 0.4826140
	speed: 0.0045s/iter; left time: 46.2969s
	iters: 300, epoch: 11 | loss: 0.3657191
	speed: 0.0043s/iter; left time: 43.7948s
	iters: 400, epoch: 11 | loss: 0.3610028
	speed: 0.0044s/iter; left time: 43.6295s
	iters: 500, epoch: 11 | loss: 0.2789945
	speed: 0.0043s/iter; left time: 43.1510s
	iters: 600, epoch: 11 | loss: 0.3801005
	speed: 0.0048s/iter; left time: 46.7149s
	iters: 700, epoch: 11 | loss: 0.2547207
	speed: 0.0047s/iter; left time: 46.0171s
	iters: 800, epoch: 11 | loss: 0.5850231
	speed: 0.0047s/iter; left time: 44.7819s
	iters: 900, epoch: 11 | loss: 0.5305765
	speed: 0.0046s/iter; left time: 43.8557s
	iters: 1000, epoch: 11 | loss: 0.4886246
	speed: 0.0045s/iter; left time: 42.5291s
Epoch: 11 cost time: 4.822285890579224
Epoch: 11, Steps: 1042 | Train Loss: 0.3650456 Vali Loss: 0.3376750 Test Loss: 1.9123076
EarlyStopping counter: 3 out of 5
Updating learning rate to 9.765625e-08
Parameters: 0.074112
	iters: 100, epoch: 12 | loss: 0.3889525
	speed: 0.1038s/iter; left time: 963.5445s
	iters: 200, epoch: 12 | loss: 0.3743193
	speed: 0.0047s/iter; left time: 43.3367s
	iters: 300, epoch: 12 | loss: 0.3961642
	speed: 0.0046s/iter; left time: 41.8382s
	iters: 400, epoch: 12 | loss: 0.2484091
	speed: 0.0046s/iter; left time: 41.7146s
	iters: 500, epoch: 12 | loss: 0.3871678
	speed: 0.0048s/iter; left time: 42.7469s
	iters: 600, epoch: 12 | loss: 0.3764680
	speed: 0.0050s/iter; left time: 43.5680s
	iters: 700, epoch: 12 | loss: 0.4635262
	speed: 0.0048s/iter; left time: 41.9810s
	iters: 800, epoch: 12 | loss: 0.3773007
	speed: 0.0048s/iter; left time: 41.1735s
	iters: 900, epoch: 12 | loss: 0.3053697
	speed: 0.0048s/iter; left time: 40.6507s
	iters: 1000, epoch: 12 | loss: 0.2833624
	speed: 0.0046s/iter; left time: 38.7408s
Epoch: 12 cost time: 5.067142009735107
Epoch: 12, Steps: 1042 | Train Loss: 0.3650767 Vali Loss: 0.3377708 Test Loss: 1.9122686
EarlyStopping counter: 4 out of 5
Updating learning rate to 4.8828125e-08
Parameters: 0.074112
	iters: 100, epoch: 13 | loss: 0.5077652
	speed: 0.1109s/iter; left time: 913.2784s
	iters: 200, epoch: 13 | loss: 0.4622320
	speed: 0.0047s/iter; left time: 37.8397s
	iters: 300, epoch: 13 | loss: 0.3145318
	speed: 0.0046s/iter; left time: 37.0924s
	iters: 400, epoch: 13 | loss: 0.3362300
	speed: 0.0046s/iter; left time: 36.6026s
	iters: 500, epoch: 13 | loss: 0.2636546
	speed: 0.0047s/iter; left time: 37.1600s
	iters: 600, epoch: 13 | loss: 0.4815140
	speed: 0.0048s/iter; left time: 37.2570s
	iters: 700, epoch: 13 | loss: 0.3792761
	speed: 0.0051s/iter; left time: 39.1004s
	iters: 800, epoch: 13 | loss: 0.4901418
	speed: 0.0048s/iter; left time: 36.2529s
	iters: 900, epoch: 13 | loss: 0.4137489
	speed: 0.0048s/iter; left time: 35.8642s
	iters: 1000, epoch: 13 | loss: 0.4432618
	speed: 0.0050s/iter; left time: 36.8031s
Epoch: 13 cost time: 5.1083879470825195
Epoch: 13, Steps: 1042 | Train Loss: 0.3650082 Vali Loss: 0.3376935 Test Loss: 1.9122492
EarlyStopping counter: 5 out of 5
Updating learning rate to 2.44140625e-08
Early stopping
>>>>>>>testing : long_term_forecast_DiscoveryPassage_and_others_720_360_96_tn_DLinear_custom_ftM_sl192_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Chlorophyll (ug/l) Chlorophyll (ug/l)
test 9446
test shape: (9446, 1, 192, 8) (9446, 1, 192, 8)
test shape: (9446, 192, 8) (9446, 192, 8)
mse:1.9135582447052002, mae:0.5749268531799316
bash ./scripts/DiscoveryPassage_and_others_Script/DLinear.sh
MODEL IMPLEMENTED= DLinear
PREDICTION LENGTH= 96
SEQUENCE LENGTH= 96
LEARNING RATE ADJUSTMENT= type1
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=8, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='DiscoveryPassage_and_others_merged.csv', dec_in=8, des='Exp', devices='0,1,2,3', distil=True, dropout=0.1, e_layers=2, embed='timeF', enc_in=8, factor=3, features='M', freq='h', gpu=0, is_training=1, itr=1, label_len=48, learning_rate=0.0001, loss='MSE', lradj='type1', mask_rate=0.25, model='DLinear', model_id='DiscoveryPassage_and_others_720_360_96_tn', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=96, root_path='./dataset/', seasonal_patterns='Monthly', seq_len=96, target='Chlorophyll (ug/l)', task_name='long_term_forecast', top_k=5, train_epochs=20, use_amp=False, use_gpu=False, use_multi_gpu=False, w_lin=0.01)
Use CPU
>>>>>>>start training : long_term_forecast_DiscoveryPassage_and_others_720_360_96_tn_DLinear_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
Chlorophyll (ug/l) Chlorophyll (ug/l)
train 33539
Chlorophyll (ug/l) Chlorophyll (ug/l)
val 4725
Chlorophyll (ug/l) Chlorophyll (ug/l)
test 9542
Parameters: 0.018624
	iters: 100, epoch: 1 | loss: 0.3830619
	speed: 0.0055s/iter; left time: 114.5466s
	iters: 200, epoch: 1 | loss: 0.2445883
	speed: 0.0031s/iter; left time: 65.2985s
	iters: 300, epoch: 1 | loss: 0.4064031
	speed: 0.0033s/iter; left time: 67.9790s
	iters: 400, epoch: 1 | loss: 0.4263870
	speed: 0.0030s/iter; left time: 62.6481s
	iters: 500, epoch: 1 | loss: 0.5376345
	speed: 0.0032s/iter; left time: 64.9104s
	iters: 600, epoch: 1 | loss: 0.2923261
	speed: 0.0032s/iter; left time: 65.4792s
	iters: 700, epoch: 1 | loss: 0.3372027
	speed: 0.0034s/iter; left time: 68.6349s
	iters: 800, epoch: 1 | loss: 0.2981565
	speed: 0.0032s/iter; left time: 63.8201s
	iters: 900, epoch: 1 | loss: 0.2976180
	speed: 0.0033s/iter; left time: 66.2179s
	iters: 1000, epoch: 1 | loss: 0.1794122
	speed: 0.0032s/iter; left time: 64.4496s
Epoch: 1 cost time: 3.6043498516082764
Epoch: 1, Steps: 1048 | Train Loss: 0.3676910 Vali Loss: 0.2797633 Test Loss: 1.7412181
Validation loss decreased (inf --> 0.279763).  Saving model ...
Updating learning rate to 0.0001
Parameters: 0.018624
	iters: 100, epoch: 2 | loss: 0.3021339
	speed: 0.0951s/iter; left time: 1884.4733s
	iters: 200, epoch: 2 | loss: 0.1822903
	speed: 0.0031s/iter; left time: 61.2378s
	iters: 300, epoch: 2 | loss: 0.4718637
	speed: 0.0031s/iter; left time: 60.2769s
	iters: 400, epoch: 2 | loss: 0.3744144
	speed: 0.0033s/iter; left time: 64.5172s
	iters: 500, epoch: 2 | loss: 0.4590190
	speed: 0.0032s/iter; left time: 62.0007s
	iters: 600, epoch: 2 | loss: 0.3454185
	speed: 0.0033s/iter; left time: 63.9800s
	iters: 700, epoch: 2 | loss: 0.3116445
	speed: 0.0031s/iter; left time: 59.5312s
	iters: 800, epoch: 2 | loss: 0.4235596
	speed: 0.0032s/iter; left time: 60.2652s
	iters: 900, epoch: 2 | loss: 0.2204852
	speed: 0.0029s/iter; left time: 55.8650s
	iters: 1000, epoch: 2 | loss: 0.6519461
	speed: 0.0030s/iter; left time: 56.6507s
Epoch: 2 cost time: 3.3722426891326904
Epoch: 2, Steps: 1048 | Train Loss: 0.3483679 Vali Loss: 0.2710670 Test Loss: 1.7388237
Validation loss decreased (0.279763 --> 0.271067).  Saving model ...
Updating learning rate to 5e-05
Parameters: 0.018624
	iters: 100, epoch: 3 | loss: 0.1834189
	speed: 0.0967s/iter; left time: 1815.4221s
	iters: 200, epoch: 3 | loss: 0.5092862
	speed: 0.0033s/iter; left time: 60.8457s
	iters: 300, epoch: 3 | loss: 0.2788164
	speed: 0.0032s/iter; left time: 59.1438s
	iters: 400, epoch: 3 | loss: 0.4815382
	speed: 0.0033s/iter; left time: 60.6588s
	iters: 500, epoch: 3 | loss: 0.3231114
	speed: 0.0033s/iter; left time: 60.4756s
	iters: 600, epoch: 3 | loss: 0.3450204
	speed: 0.0029s/iter; left time: 53.8597s
	iters: 700, epoch: 3 | loss: 0.5043578
	speed: 0.0030s/iter; left time: 55.2859s
	iters: 800, epoch: 3 | loss: 0.1784749
	speed: 0.0032s/iter; left time: 57.1751s
	iters: 900, epoch: 3 | loss: 0.5939372
	speed: 0.0028s/iter; left time: 50.4736s
	iters: 1000, epoch: 3 | loss: 0.3232321
	speed: 0.0030s/iter; left time: 54.0013s
Epoch: 3 cost time: 3.3255069255828857
Epoch: 3, Steps: 1048 | Train Loss: 0.3466194 Vali Loss: 0.2697541 Test Loss: 1.7434191
Validation loss decreased (0.271067 --> 0.269754).  Saving model ...
Updating learning rate to 2.5e-05
Parameters: 0.018624
	iters: 100, epoch: 4 | loss: 0.2264495
	speed: 0.0908s/iter; left time: 1608.4106s
	iters: 200, epoch: 4 | loss: 0.1939897
	speed: 0.0031s/iter; left time: 54.0704s
	iters: 300, epoch: 4 | loss: 0.2690209
	speed: 0.0030s/iter; left time: 52.7596s
	iters: 400, epoch: 4 | loss: 0.2689607
	speed: 0.0033s/iter; left time: 57.2461s
	iters: 500, epoch: 4 | loss: 0.3406790
	speed: 0.0030s/iter; left time: 51.5343s
	iters: 600, epoch: 4 | loss: 0.2456677
	speed: 0.0029s/iter; left time: 49.7706s
	iters: 700, epoch: 4 | loss: 0.1910267
	speed: 0.0032s/iter; left time: 55.1139s
	iters: 800, epoch: 4 | loss: 0.4006481
	speed: 0.0030s/iter; left time: 50.3410s
	iters: 900, epoch: 4 | loss: 0.4853457
	speed: 0.0032s/iter; left time: 53.3853s
	iters: 1000, epoch: 4 | loss: 0.3510039
	speed: 0.0031s/iter; left time: 52.3693s
Epoch: 4 cost time: 3.2985105514526367
Epoch: 4, Steps: 1048 | Train Loss: 0.3461325 Vali Loss: 0.2685960 Test Loss: 1.7406569
Validation loss decreased (0.269754 --> 0.268596).  Saving model ...
Updating learning rate to 1.25e-05
Parameters: 0.018624
	iters: 100, epoch: 5 | loss: 0.3108050
	speed: 0.0979s/iter; left time: 1632.1823s
	iters: 200, epoch: 5 | loss: 0.4913739
	speed: 0.0033s/iter; left time: 54.6838s
	iters: 300, epoch: 5 | loss: 0.3491367
	speed: 0.0031s/iter; left time: 51.2739s
	iters: 400, epoch: 5 | loss: 0.1927211
	speed: 0.0033s/iter; left time: 53.2934s
	iters: 500, epoch: 5 | loss: 0.5120458
	speed: 0.0031s/iter; left time: 50.8933s
	iters: 600, epoch: 5 | loss: 0.4817785
	speed: 0.0031s/iter; left time: 49.8798s
	iters: 700, epoch: 5 | loss: 0.4775437
	speed: 0.0030s/iter; left time: 48.3199s
	iters: 800, epoch: 5 | loss: 0.4228117
	speed: 0.0034s/iter; left time: 54.9105s
	iters: 900, epoch: 5 | loss: 0.2590705
	speed: 0.0031s/iter; left time: 49.8369s
	iters: 1000, epoch: 5 | loss: 0.4351568
	speed: 0.0031s/iter; left time: 48.7620s
Epoch: 5 cost time: 3.414146900177002
Epoch: 5, Steps: 1048 | Train Loss: 0.3459414 Vali Loss: 0.2680647 Test Loss: 1.7410486
Validation loss decreased (0.268596 --> 0.268065).  Saving model ...
Updating learning rate to 6.25e-06
Parameters: 0.018624
	iters: 100, epoch: 6 | loss: 0.2905448
	speed: 0.0971s/iter; left time: 1516.0253s
	iters: 200, epoch: 6 | loss: 0.2875294
	speed: 0.0032s/iter; left time: 48.9710s
	iters: 300, epoch: 6 | loss: 0.3407063
	speed: 0.0031s/iter; left time: 47.3096s
	iters: 400, epoch: 6 | loss: 0.4096668
	speed: 0.0031s/iter; left time: 47.8388s
	iters: 500, epoch: 6 | loss: 0.2973046
	speed: 0.0033s/iter; left time: 50.0932s
	iters: 600, epoch: 6 | loss: 0.2266656
	speed: 0.0030s/iter; left time: 44.6527s
	iters: 700, epoch: 6 | loss: 0.4611388
	speed: 0.0033s/iter; left time: 49.1862s
	iters: 800, epoch: 6 | loss: 0.3420736
	speed: 0.0031s/iter; left time: 46.1997s
	iters: 900, epoch: 6 | loss: 0.4783464
	speed: 0.0031s/iter; left time: 45.6889s
	iters: 1000, epoch: 6 | loss: 0.6790908
	speed: 0.0033s/iter; left time: 47.9797s
Epoch: 6 cost time: 3.3658859729766846
Epoch: 6, Steps: 1048 | Train Loss: 0.3458184 Vali Loss: 0.2676756 Test Loss: 1.7409438
Validation loss decreased (0.268065 --> 0.267676).  Saving model ...
Updating learning rate to 3.125e-06
Parameters: 0.018624
	iters: 100, epoch: 7 | loss: 0.4864595
	speed: 0.0965s/iter; left time: 1406.0955s
	iters: 200, epoch: 7 | loss: 0.3777746
	speed: 0.0029s/iter; left time: 42.2706s
	iters: 300, epoch: 7 | loss: 0.1437279
	speed: 0.0029s/iter; left time: 41.3787s
	iters: 400, epoch: 7 | loss: 0.3828024
	speed: 0.0030s/iter; left time: 42.3635s
	iters: 500, epoch: 7 | loss: 0.3392067
	speed: 0.0031s/iter; left time: 43.9307s
	iters: 600, epoch: 7 | loss: 0.0840991
	speed: 0.0030s/iter; left time: 42.5584s
	iters: 700, epoch: 7 | loss: 0.4183305
	speed: 0.0030s/iter; left time: 42.0320s
	iters: 800, epoch: 7 | loss: 0.3393212
	speed: 0.0030s/iter; left time: 41.4971s
	iters: 900, epoch: 7 | loss: 0.3679620
	speed: 0.0030s/iter; left time: 41.6664s
	iters: 1000, epoch: 7 | loss: 0.1429879
	speed: 0.0029s/iter; left time: 39.4827s
Epoch: 7 cost time: 3.2214057445526123
Epoch: 7, Steps: 1048 | Train Loss: 0.3457880 Vali Loss: 0.2670121 Test Loss: 1.7403679
Validation loss decreased (0.267676 --> 0.267012).  Saving model ...
Updating learning rate to 1.5625e-06
Parameters: 0.018624
	iters: 100, epoch: 8 | loss: 0.2086364
	speed: 0.0889s/iter; left time: 1202.3951s
	iters: 200, epoch: 8 | loss: 0.2431461
	speed: 0.0030s/iter; left time: 39.7029s
	iters: 300, epoch: 8 | loss: 0.3802900
	speed: 0.0029s/iter; left time: 38.7542s
	iters: 400, epoch: 8 | loss: 0.2499333
	speed: 0.0030s/iter; left time: 39.6194s
	iters: 500, epoch: 8 | loss: 0.3211143
	speed: 0.0030s/iter; left time: 39.7624s
	iters: 600, epoch: 8 | loss: 0.2911837
	speed: 0.0030s/iter; left time: 39.2005s
	iters: 700, epoch: 8 | loss: 0.2798518
	speed: 0.0033s/iter; left time: 42.0207s
	iters: 800, epoch: 8 | loss: 0.4676131
	speed: 0.0032s/iter; left time: 40.4690s
	iters: 900, epoch: 8 | loss: 0.1670401
	speed: 0.0033s/iter; left time: 41.5676s
	iters: 1000, epoch: 8 | loss: 0.5802622
	speed: 0.0033s/iter; left time: 41.9806s
Epoch: 8 cost time: 3.372581720352173
Epoch: 8, Steps: 1048 | Train Loss: 0.3457582 Vali Loss: 0.2677384 Test Loss: 1.7407637
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.8125e-07
Parameters: 0.018624
	iters: 100, epoch: 9 | loss: 0.3244520
	speed: 0.0986s/iter; left time: 1230.6139s
	iters: 200, epoch: 9 | loss: 0.2489365
	speed: 0.0032s/iter; left time: 39.4759s
	iters: 300, epoch: 9 | loss: 0.5323231
	speed: 0.0033s/iter; left time: 41.0834s
	iters: 400, epoch: 9 | loss: 0.3597098
	speed: 0.0034s/iter; left time: 41.3305s
	iters: 500, epoch: 9 | loss: 0.2557202
	speed: 0.0031s/iter; left time: 37.9861s
	iters: 600, epoch: 9 | loss: 0.3669402
	speed: 0.0033s/iter; left time: 39.3117s
	iters: 700, epoch: 9 | loss: 0.1912536
	speed: 0.0032s/iter; left time: 37.4430s
	iters: 800, epoch: 9 | loss: 0.3781046
	speed: 0.0034s/iter; left time: 39.6286s
	iters: 900, epoch: 9 | loss: 0.4696364
	speed: 0.0033s/iter; left time: 38.6531s
	iters: 1000, epoch: 9 | loss: 0.2010422
	speed: 0.0033s/iter; left time: 38.1885s
Epoch: 9 cost time: 3.5165956020355225
Epoch: 9, Steps: 1048 | Train Loss: 0.3457453 Vali Loss: 0.2673681 Test Loss: 1.7407643
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.90625e-07
Parameters: 0.018624
	iters: 100, epoch: 10 | loss: 0.2080514
	speed: 0.1087s/iter; left time: 1242.4051s
	iters: 200, epoch: 10 | loss: 0.4821241
	speed: 0.0033s/iter; left time: 37.2876s
	iters: 300, epoch: 10 | loss: 0.4343018
	speed: 0.0031s/iter; left time: 35.0301s
	iters: 400, epoch: 10 | loss: 0.2927184
	speed: 0.0033s/iter; left time: 36.8247s
	iters: 500, epoch: 10 | loss: 0.3240279
	speed: 0.0032s/iter; left time: 35.2091s
	iters: 600, epoch: 10 | loss: 0.5619246
	speed: 0.0031s/iter; left time: 34.4079s
	iters: 700, epoch: 10 | loss: 0.1688453
	speed: 0.0032s/iter; left time: 34.3424s
	iters: 800, epoch: 10 | loss: 0.2600906
	speed: 0.0031s/iter; left time: 33.7814s
	iters: 900, epoch: 10 | loss: 0.4693589
	speed: 0.0032s/iter; left time: 33.5856s
	iters: 1000, epoch: 10 | loss: 0.1785079
	speed: 0.0031s/iter; left time: 32.7282s
Epoch: 10 cost time: 3.4415128231048584
Epoch: 10, Steps: 1048 | Train Loss: 0.3457284 Vali Loss: 0.2676557 Test Loss: 1.7407137
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.953125e-07
Parameters: 0.018624
	iters: 100, epoch: 11 | loss: 0.3099280
	speed: 0.1027s/iter; left time: 1065.6421s
	iters: 200, epoch: 11 | loss: 0.2375108
	speed: 0.0035s/iter; left time: 35.4861s
	iters: 300, epoch: 11 | loss: 0.4575920
	speed: 0.0032s/iter; left time: 32.9401s
	iters: 400, epoch: 11 | loss: 0.3473087
	speed: 0.0033s/iter; left time: 33.2874s
	iters: 500, epoch: 11 | loss: 0.3672188
	speed: 0.0033s/iter; left time: 32.9884s
	iters: 600, epoch: 11 | loss: 0.1881611
	speed: 0.0034s/iter; left time: 33.9209s
	iters: 700, epoch: 11 | loss: 0.2557826
	speed: 0.0034s/iter; left time: 33.3490s
	iters: 800, epoch: 11 | loss: 0.3922041
	speed: 0.0034s/iter; left time: 32.6891s
	iters: 900, epoch: 11 | loss: 0.2353204
	speed: 0.0034s/iter; left time: 32.2875s
	iters: 1000, epoch: 11 | loss: 0.1849259
	speed: 0.0033s/iter; left time: 31.4264s
Epoch: 11 cost time: 3.612506628036499
Epoch: 11, Steps: 1048 | Train Loss: 0.3457004 Vali Loss: 0.2677663 Test Loss: 1.7406937
EarlyStopping counter: 4 out of 5
Updating learning rate to 9.765625e-08
Parameters: 0.018624
	iters: 100, epoch: 12 | loss: 0.2395209
	speed: 0.1087s/iter; left time: 1014.6504s
	iters: 200, epoch: 12 | loss: 0.3354459
	speed: 0.0033s/iter; left time: 30.4647s
	iters: 300, epoch: 12 | loss: 0.2186927
	speed: 0.0033s/iter; left time: 30.2634s
	iters: 400, epoch: 12 | loss: 0.4316905
	speed: 0.0034s/iter; left time: 30.7320s
	iters: 500, epoch: 12 | loss: 0.2805160
	speed: 0.0034s/iter; left time: 29.9338s
	iters: 600, epoch: 12 | loss: 0.2623303
	speed: 0.0033s/iter; left time: 29.4140s
	iters: 700, epoch: 12 | loss: 0.3415940
	speed: 0.0032s/iter; left time: 27.7747s
	iters: 800, epoch: 12 | loss: 0.4009613
	speed: 0.0035s/iter; left time: 29.8293s
	iters: 900, epoch: 12 | loss: 0.2772010
	speed: 0.0034s/iter; left time: 28.9743s
	iters: 1000, epoch: 12 | loss: 0.3353409
	speed: 0.0035s/iter; left time: 29.3075s
Epoch: 12 cost time: 3.6276233196258545
Epoch: 12, Steps: 1048 | Train Loss: 0.3457391 Vali Loss: 0.2675869 Test Loss: 1.7407023
EarlyStopping counter: 5 out of 5
Updating learning rate to 4.8828125e-08
Early stopping
>>>>>>>testing : long_term_forecast_DiscoveryPassage_and_others_720_360_96_tn_DLinear_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Chlorophyll (ug/l) Chlorophyll (ug/l)
test 9542
test shape: (9542, 1, 96, 8) (9542, 1, 96, 8)
test shape: (9542, 96, 8) (9542, 96, 8)
mse:1.740369200706482, mae:0.5240353941917419



























